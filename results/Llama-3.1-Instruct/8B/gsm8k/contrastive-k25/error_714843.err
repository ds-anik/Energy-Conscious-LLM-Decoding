2025-03-20:13:35:51,356 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:13:36:03,341 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:13:36:03,342 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:13:36:03,349 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:13:36:03,350 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:13:36:03,350 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:13:36:03,623 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:13:36:03,834 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:13:36:04,295 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:01,  1.01it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.08it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.47it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]
2025-03-20:13:36:14,728 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:13:36:14,730 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 339.26it/s] 69%|██████▉   | 69/100 [00:00<00:00, 342.59it/s]100%|██████████| 100/100 [00:00<00:00, 341.27it/s]
2025-03-20:13:36:15,031 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:09<16:04,  9.74s/it]Running generate_until requests:   2%|▏         | 2/100 [00:29<25:09, 15.40s/it]Running generate_until requests:   3%|▎         | 3/100 [00:39<21:11, 13.11s/it]Running generate_until requests:   4%|▍         | 4/100 [00:56<23:34, 14.74s/it]Running generate_until requests:   5%|▌         | 5/100 [01:08<21:27, 13.55s/it]Running generate_until requests:   6%|▌         | 6/100 [01:40<31:10, 19.90s/it]Running generate_until requests:   7%|▋         | 7/100 [01:50<26:08, 16.86s/it]Running generate_until requests:   8%|▊         | 8/100 [02:02<23:23, 15.26s/it]Running generate_until requests:   9%|▉         | 9/100 [02:10<19:26, 12.82s/it]Running generate_until requests:  10%|█         | 10/100 [02:44<28:55, 19.28s/it]Running generate_until requests:  11%|█         | 11/100 [02:50<22:38, 15.27s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:56<18:24, 12.55s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:05<16:37, 11.46s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:13<14:50, 10.36s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:35<19:46, 13.96s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:44<17:34, 12.55s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:54<16:19, 11.80s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:12<18:27, 13.51s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:20<15:52, 11.76s/it]Running generate_until requests:  20%|██        | 20/100 [04:33<16:21, 12.26s/it]Running generate_until requests:  21%|██        | 21/100 [04:47<16:59, 12.90s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:59<16:08, 12.42s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:07<14:24, 11.23s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:14<12:23,  9.79s/it]Running generate_until requests:  25%|██▌       | 25/100 [05:26<13:18, 10.65s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:34<12:12,  9.90s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:47<12:54, 10.60s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:54<11:22,  9.48s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:59<09:49,  8.30s/it]Running generate_until requests:  30%|███       | 30/100 [06:16<12:49, 10.99s/it]Running generate_until requests:  31%|███       | 31/100 [06:34<14:53, 12.96s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:46<14:26, 12.75s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:54<12:40, 11.34s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:04<11:58, 10.89s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:10<10:02,  9.27s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:21<10:32,  9.88s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:39<13:06, 12.49s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:48<11:33, 11.18s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:59<11:19, 11.14s/it]Running generate_until requests:  40%|████      | 40/100 [08:24<15:29, 15.49s/it]Running generate_until requests:  41%|████      | 41/100 [08:31<12:42, 12.92s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:38<10:39, 11.02s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:45<09:20,  9.83s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:51<08:05,  8.67s/it]Running generate_until requests:  45%|████▌     | 45/100 [09:00<08:05,  8.83s/it]Running generate_until requests:  46%|████▌     | 46/100 [09:07<07:25,  8.25s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:14<07:00,  7.94s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:22<06:58,  8.04s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:37<08:25,  9.91s/it]Running generate_until requests:  50%|█████     | 50/100 [09:42<07:10,  8.61s/it]Running generate_until requests:  51%|█████     | 51/100 [09:50<06:48,  8.33s/it]Running generate_until requests:  52%|█████▏    | 52/100 [10:01<07:14,  9.05s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:15<08:23, 10.70s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:34<10:08, 13.23s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:41<08:29, 11.32s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:48<07:19,  9.98s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:58<07:11, 10.04s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:13<08:03, 11.51s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:22<07:25, 10.86s/it]Running generate_until requests:  60%|██████    | 60/100 [11:27<05:58,  8.95s/it]Running generate_until requests:  61%|██████    | 61/100 [11:35<05:34,  8.57s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:43<05:25,  8.56s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:49<04:51,  7.87s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:02<05:30,  9.17s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:11<05:21,  9.17s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:22<05:28,  9.67s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:32<05:21,  9.75s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:35<04:15,  7.98s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:48<04:48,  9.29s/it]Running generate_until requests:  70%|███████   | 70/100 [12:57<04:38,  9.28s/it]Running generate_until requests:  71%|███████   | 71/100 [13:13<05:23, 11.16s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:20<04:44, 10.15s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:29<04:24,  9.80s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:40<04:24, 10.16s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:47<03:45,  9.03s/it]Running generate_until requests:  76%|███████▌  | 76/100 [13:58<03:52,  9.70s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:08<03:43,  9.72s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:13<03:05,  8.43s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:20<02:47,  7.96s/it]Running generate_until requests:  80%|████████  | 80/100 [14:26<02:24,  7.25s/it]Running generate_until requests:  81%|████████  | 81/100 [14:35<02:27,  7.75s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:50<03:03, 10.18s/it]Running generate_until requests:  83%|████████▎ | 83/100 [14:58<02:38,  9.30s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:05<02:18,  8.67s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:32<03:33, 14.25s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:40<02:54, 12.46s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:54<02:47, 12.85s/it]Running generate_until requests:  88%|████████▊ | 88/100 [16:00<02:08, 10.71s/it]Running generate_until requests:  89%|████████▉ | 89/100 [16:07<01:44,  9.50s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:17<01:37,  9.78s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:22<01:15,  8.42s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:31<01:07,  8.47s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:37<00:53,  7.64s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:48<00:52,  8.75s/it]Running generate_until requests:  95%|█████████▌| 95/100 [17:00<00:49,  9.82s/it]Running generate_until requests:  96%|█████████▌| 96/100 [17:08<00:36,  9.08s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:15<00:26,  8.73s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:25<00:17,  8.91s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:36<00:09,  9.61s/it]Running generate_until requests: 100%|██████████| 100/100 [17:51<00:00, 11.11s/it]Running generate_until requests: 100%|██████████| 100/100 [17:51<00:00, 10.71s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:13:54:11,551 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:13:54:11,585 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:13:54:51,681 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:13:55:03,704 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:13:55:03,706 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:13:55:03,714 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:13:55:03,714 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:13:55:03,715 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:13:55:03,980 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:13:55:04,164 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:13:55:04,626 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.17s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:01,  1.01it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.06it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.45it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s]
2025-03-20:13:55:13,402 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:13:55:13,411 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 342.21it/s] 71%|███████   | 71/100 [00:00<00:00, 347.06it/s]100%|██████████| 100/100 [00:00<00:00, 347.12it/s]
2025-03-20:13:55:13,703 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:09<15:59,  9.69s/it]Running generate_until requests:   2%|▏         | 2/100 [00:29<25:06, 15.38s/it]Running generate_until requests:   3%|▎         | 3/100 [00:39<21:11, 13.11s/it]Running generate_until requests:   4%|▍         | 4/100 [00:56<23:33, 14.73s/it]Running generate_until requests:   5%|▌         | 5/100 [01:08<21:26, 13.54s/it]Running generate_until requests:   6%|▌         | 6/100 [01:40<31:07, 19.87s/it]Running generate_until requests:   7%|▋         | 7/100 [01:50<26:05, 16.84s/it]Running generate_until requests:   8%|▊         | 8/100 [02:02<23:21, 15.24s/it]Running generate_until requests:   9%|▉         | 9/100 [02:10<19:24, 12.80s/it]Running generate_until requests:  10%|█         | 10/100 [02:43<28:54, 19.27s/it]Running generate_until requests:  11%|█         | 11/100 [02:50<22:37, 15.25s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:56<18:23, 12.54s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:05<16:35, 11.45s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:13<14:49, 10.35s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:35<19:44, 13.93s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:44<17:32, 12.53s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:54<16:17, 11.78s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:12<18:25, 13.48s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:19<15:51, 11.74s/it]Running generate_until requests:  20%|██        | 20/100 [04:33<16:19, 12.24s/it]Running generate_until requests:  21%|██        | 21/100 [04:47<16:57, 12.88s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:58<16:07, 12.40s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:07<14:23, 11.21s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:13<12:22,  9.77s/it]Running generate_until requests:  25%|██▌       | 25/100 [05:26<13:17, 10.63s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:34<12:11,  9.88s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:46<12:52, 10.58s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:53<11:21,  9.46s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:59<09:48,  8.29s/it]Running generate_until requests:  30%|███       | 30/100 [06:16<12:47, 10.97s/it]Running generate_until requests:  31%|███       | 31/100 [06:33<14:52, 12.93s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:46<14:25, 12.72s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:54<12:38, 11.32s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:03<11:56, 10.86s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:09<10:01,  9.25s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:20<10:31,  9.86s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:39<13:05, 12.47s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:47<11:31, 11.16s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:58<11:18, 11.12s/it]Running generate_until requests:  40%|████      | 40/100 [08:23<15:27, 15.46s/it]Running generate_until requests:  41%|████      | 41/100 [08:30<12:41, 12.90s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:37<10:38, 11.00s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:44<09:18,  9.81s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:50<08:04,  8.66s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:59<08:04,  8.82s/it]Running generate_until requests:  46%|████▌     | 46/100 [09:06<07:24,  8.23s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:13<07:00,  7.93s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:21<06:56,  8.02s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:36<08:23,  9.88s/it]Running generate_until requests:  50%|█████     | 50/100 [09:41<07:09,  8.58s/it]Running generate_until requests:  51%|█████     | 51/100 [09:49<06:46,  8.30s/it]Running generate_until requests:  52%|█████▏    | 52/100 [10:00<07:13,  9.02s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:14<08:21, 10.67s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:33<10:06, 13.19s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:40<08:27, 11.29s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:47<07:18,  9.96s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:57<07:10, 10.02s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:12<08:02, 11.49s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:21<07:24, 10.84s/it]Running generate_until requests:  60%|██████    | 60/100 [11:26<05:57,  8.93s/it]Running generate_until requests:  61%|██████    | 61/100 [11:33<05:33,  8.55s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:42<05:24,  8.54s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:48<04:50,  7.85s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:00<05:29,  9.15s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:09<05:20,  9.15s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:20<05:28,  9.65s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:30<05:21,  9.73s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:34<04:14,  7.96s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:46<04:47,  9.27s/it]Running generate_until requests:  70%|███████   | 70/100 [12:56<04:37,  9.26s/it]Running generate_until requests:  71%|███████   | 71/100 [13:11<05:23, 11.14s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:19<04:43, 10.13s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:28<04:24,  9.78s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:39<04:23, 10.14s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:45<03:45,  9.01s/it]Running generate_until requests:  76%|███████▌  | 76/100 [13:56<03:52,  9.68s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:06<03:43,  9.70s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:12<03:05,  8.41s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:18<02:46,  7.95s/it]Running generate_until requests:  80%|████████  | 80/100 [14:24<02:24,  7.24s/it]Running generate_until requests:  81%|████████  | 81/100 [14:33<02:27,  7.74s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:49<03:02, 10.16s/it]Running generate_until requests:  83%|████████▎ | 83/100 [14:56<02:37,  9.29s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:03<02:18,  8.65s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:30<03:33, 14.22s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:39<02:54, 12.43s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:52<02:46, 12.82s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:58<02:08, 10.69s/it]Running generate_until requests:  89%|████████▉ | 89/100 [16:05<01:44,  9.48s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:15<01:37,  9.75s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:20<01:15,  8.41s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:29<01:07,  8.44s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:35<00:53,  7.62s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:46<00:52,  8.72s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:58<00:49,  9.80s/it]Running generate_until requests:  96%|█████████▌| 96/100 [17:06<00:36,  9.05s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:13<00:26,  8.71s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:23<00:17,  8.89s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:34<00:09,  9.59s/it]Running generate_until requests: 100%|██████████| 100/100 [17:49<00:00, 11.09s/it]Running generate_until requests: 100%|██████████| 100/100 [17:49<00:00, 10.69s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:14:13:08,173 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:14:13:08,178 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:14:13:48,690 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:14:14:00,809 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:14:14:00,811 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:14:14:00,820 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:14:14:00,821 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:14:14:00,822 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:14:14:01,117 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:14:14:01,289 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:14:14:01,776 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.04s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.42it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:14:14:13,629 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:14:14:13,631 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 33%|███▎      | 33/100 [00:00<00:00, 322.69it/s] 68%|██████▊   | 68/100 [00:00<00:00, 337.02it/s]100%|██████████| 100/100 [00:00<00:00, 339.39it/s]
2025-03-20:14:14:13,929 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:09<15:59,  9.69s/it]Running generate_until requests:   2%|▏         | 2/100 [00:29<25:05, 15.37s/it]Running generate_until requests:   3%|▎         | 3/100 [00:39<21:10, 13.10s/it]Running generate_until requests:   4%|▍         | 4/100 [00:56<23:32, 14.71s/it]Running generate_until requests:   5%|▌         | 5/100 [01:08<21:24, 13.52s/it]Running generate_until requests:   6%|▌         | 6/100 [01:40<31:05, 19.85s/it]Running generate_until requests:   7%|▋         | 7/100 [01:50<26:04, 16.82s/it]Running generate_until requests:   8%|▊         | 8/100 [02:02<23:20, 15.22s/it]Running generate_until requests:   9%|▉         | 9/100 [02:09<19:23, 12.78s/it]Running generate_until requests:  10%|█         | 10/100 [02:43<28:50, 19.23s/it]Running generate_until requests:  11%|█         | 11/100 [02:49<22:34, 15.22s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:56<18:21, 12.52s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:05<16:34, 11.43s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:12<14:48, 10.33s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:35<19:42, 13.91s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:44<17:31, 12.51s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:54<16:16, 11.77s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:11<18:24, 13.46s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:19<15:49, 11.73s/it]Running generate_until requests:  20%|██        | 20/100 [04:32<16:18, 12.23s/it]Running generate_until requests:  21%|██        | 21/100 [04:47<16:56, 12.86s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:58<16:05, 12.38s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:06<14:22, 11.20s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:13<12:21,  9.76s/it]Running generate_until requests:  25%|██▌       | 25/100 [05:25<13:16, 10.62s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:33<12:10,  9.87s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:46<12:51, 10.57s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:53<11:20,  9.45s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:58<09:47,  8.28s/it]Running generate_until requests:  30%|███       | 30/100 [06:15<12:46, 10.95s/it]Running generate_until requests:  31%|███       | 31/100 [06:33<14:51, 12.92s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:45<14:24, 12.71s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:53<12:37, 11.31s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:03<11:56, 10.85s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:08<10:00,  9.24s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:20<10:30,  9.85s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:38<13:04, 12.45s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:46<11:31, 11.15s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:57<11:17, 11.11s/it]Running generate_until requests:  40%|████      | 40/100 [08:23<15:26, 15.45s/it]Running generate_until requests:  41%|████      | 41/100 [08:30<12:40, 12.89s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:36<10:37, 10.99s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:43<09:18,  9.80s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:49<08:04,  8.65s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:58<08:04,  8.81s/it]Running generate_until requests:  46%|████▌     | 46/100 [09:05<07:24,  8.22s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:12<06:59,  7.92s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:21<06:56,  8.01s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:35<08:23,  9.87s/it]Running generate_until requests:  50%|█████     | 50/100 [09:40<07:08,  8.57s/it]Running generate_until requests:  51%|█████     | 51/100 [09:48<06:46,  8.29s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:59<07:12,  9.01s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:13<08:20, 10.65s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:32<10:05, 13.17s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:39<08:27, 11.27s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:46<07:17,  9.94s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:56<07:10, 10.00s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:11<08:01, 11.47s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:20<07:23, 10.82s/it]Running generate_until requests:  60%|██████    | 60/100 [11:25<05:56,  8.92s/it]Running generate_until requests:  61%|██████    | 61/100 [11:32<05:32,  8.54s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:41<05:23,  8.52s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:47<04:50,  7.84s/it]Running generate_until requests:  64%|██████▍   | 64/100 [11:59<05:28,  9.13s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:09<05:19,  9.14s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:19<05:27,  9.64s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:29<05:20,  9.71s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:33<04:14,  7.95s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:45<04:47,  9.26s/it]Running generate_until requests:  70%|███████   | 70/100 [12:55<04:37,  9.25s/it]Running generate_until requests:  71%|███████   | 71/100 [13:10<05:22, 11.12s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:18<04:43, 10.12s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:27<04:23,  9.77s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:38<04:23, 10.12s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:44<03:44,  8.99s/it]Running generate_until requests:  76%|███████▌  | 76/100 [13:55<03:51,  9.67s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:05<03:42,  9.68s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:10<03:04,  8.40s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:17<02:46,  7.93s/it]Running generate_until requests:  80%|████████  | 80/100 [14:23<02:24,  7.22s/it]Running generate_until requests:  81%|████████  | 81/100 [14:32<02:26,  7.72s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:48<03:02, 10.14s/it]Running generate_until requests:  83%|████████▎ | 83/100 [14:55<02:37,  9.27s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:02<02:18,  8.64s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:29<03:32, 14.20s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:37<02:53, 12.41s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:51<02:46, 12.80s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:57<02:08, 10.67s/it]Running generate_until requests:  89%|████████▉ | 89/100 [16:03<01:44,  9.47s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:14<01:37,  9.74s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:19<01:15,  8.39s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:28<01:07,  8.43s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:33<00:53,  7.61s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:45<00:52,  8.71s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:57<00:48,  9.79s/it]Running generate_until requests:  96%|█████████▌| 96/100 [17:04<00:36,  9.04s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:12<00:26,  8.69s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:21<00:17,  8.87s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:33<00:09,  9.57s/it]Running generate_until requests: 100%|██████████| 100/100 [17:47<00:00, 11.07s/it]Running generate_until requests: 100%|██████████| 100/100 [17:47<00:00, 10.68s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:14:32:06,836 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:14:32:06,911 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:14:32:47,211 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:14:32:59,219 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:14:32:59,221 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:14:32:59,230 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:14:32:59,231 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:14:32:59,231 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:14:32:59,505 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:14:33:00,159 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:14:33:00,637 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.15s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:01,  1.02it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.08it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.43it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s]
2025-03-20:14:33:09,024 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:14:33:09,025 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 332.51it/s] 70%|███████   | 70/100 [00:00<00:00, 346.28it/s]100%|██████████| 100/100 [00:00<00:00, 348.31it/s]
2025-03-20:14:33:09,316 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:09<15:53,  9.63s/it]Running generate_until requests:   2%|▏         | 2/100 [00:28<24:58, 15.29s/it]Running generate_until requests:   3%|▎         | 3/100 [00:39<21:04, 13.04s/it]Running generate_until requests:   4%|▍         | 4/100 [00:56<23:29, 14.68s/it]Running generate_until requests:   5%|▌         | 5/100 [01:07<21:23, 13.51s/it]Running generate_until requests:   6%|▌         | 6/100 [01:40<31:05, 19.84s/it]Running generate_until requests:   7%|▋         | 7/100 [01:50<26:04, 16.82s/it]Running generate_until requests:   8%|▊         | 8/100 [02:02<23:20, 15.22s/it]Running generate_until requests:   9%|▉         | 9/100 [02:09<19:23, 12.79s/it]Running generate_until requests:  10%|█         | 10/100 [02:43<28:51, 19.24s/it]Running generate_until requests:  11%|█         | 11/100 [02:49<22:35, 15.23s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:56<18:22, 12.53s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:04<16:35, 11.44s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:12<14:49, 10.34s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:34<19:43, 13.93s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:44<17:32, 12.52s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:54<16:17, 11.78s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:11<18:25, 13.48s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:19<15:50, 11.74s/it]Running generate_until requests:  20%|██        | 20/100 [04:32<16:19, 12.24s/it]Running generate_until requests:  21%|██        | 21/100 [04:47<16:57, 12.88s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:58<16:06, 12.40s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:06<14:23, 11.21s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:13<12:22,  9.77s/it]Running generate_until requests:  25%|██▌       | 25/100 [05:25<13:16, 10.63s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:34<12:11,  9.88s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:46<12:52, 10.58s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:53<11:20,  9.46s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:58<09:48,  8.29s/it]Running generate_until requests:  30%|███       | 30/100 [06:15<12:47, 10.96s/it]Running generate_until requests:  31%|███       | 31/100 [06:33<14:51, 12.93s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:45<14:24, 12.72s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:53<12:38, 11.32s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:03<11:56, 10.86s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:08<10:00,  9.24s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:20<10:31,  9.86s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:38<13:05, 12.46s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:46<11:31, 11.15s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:57<11:17, 11.11s/it]Running generate_until requests:  40%|████      | 40/100 [08:23<15:27, 15.46s/it]Running generate_until requests:  41%|████      | 41/100 [08:30<12:40, 12.90s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:36<10:37, 11.00s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:44<09:18,  9.80s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:49<08:04,  8.65s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:59<08:04,  8.81s/it]Running generate_until requests:  46%|████▌     | 46/100 [09:06<07:24,  8.23s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:13<06:59,  7.92s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:21<06:56,  8.02s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:35<08:23,  9.88s/it]Running generate_until requests:  50%|█████     | 50/100 [09:41<07:09,  8.58s/it]Running generate_until requests:  51%|█████     | 51/100 [09:48<06:46,  8.30s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:59<07:12,  9.02s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:14<08:21, 10.67s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:33<10:06, 13.19s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:40<08:27, 11.29s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:46<07:18,  9.96s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:57<07:10, 10.02s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:11<08:02, 11.49s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:21<07:24, 10.84s/it]Running generate_until requests:  60%|██████    | 60/100 [11:25<05:57,  8.94s/it]Running generate_until requests:  61%|██████    | 61/100 [11:33<05:33,  8.55s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:41<05:24,  8.54s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:48<04:50,  7.85s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:00<05:29,  9.15s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:09<05:20,  9.15s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:20<05:28,  9.65s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:30<05:20,  9.73s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:34<04:14,  7.96s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:46<04:47,  9.27s/it]Running generate_until requests:  70%|███████   | 70/100 [12:55<04:37,  9.26s/it]Running generate_until requests:  71%|███████   | 71/100 [13:11<05:22, 11.14s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:18<04:43, 10.13s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:27<04:24,  9.78s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:38<04:23, 10.13s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:45<03:45,  9.01s/it]Running generate_until requests:  76%|███████▌  | 76/100 [13:56<03:52,  9.68s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:06<03:42,  9.69s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:11<03:04,  8.41s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:18<02:46,  7.94s/it]Running generate_until requests:  80%|████████  | 80/100 [14:24<02:24,  7.23s/it]Running generate_until requests:  81%|████████  | 81/100 [14:32<02:26,  7.73s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:48<03:02, 10.16s/it]Running generate_until requests:  83%|████████▎ | 83/100 [14:55<02:37,  9.28s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:03<02:18,  8.65s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:30<03:33, 14.21s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:38<02:54, 12.43s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:52<02:46, 12.82s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:58<02:08, 10.68s/it]Running generate_until requests:  89%|████████▉ | 89/100 [16:04<01:44,  9.48s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:15<01:37,  9.75s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:20<01:15,  8.40s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:28<01:07,  8.44s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:34<00:53,  7.62s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:45<00:52,  8.72s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:58<00:48,  9.80s/it]Running generate_until requests:  96%|█████████▌| 96/100 [17:05<00:36,  9.05s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:13<00:26,  8.70s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:22<00:17,  8.88s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:33<00:09,  9.58s/it]Running generate_until requests: 100%|██████████| 100/100 [17:48<00:00, 11.08s/it]Running generate_until requests: 100%|██████████| 100/100 [17:48<00:00, 10.68s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:14:51:03,270 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:14:51:03,301 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:14:51:43,973 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:14:51:55,985 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:14:51:55,987 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:14:51:55,997 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:14:51:55,997 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:14:51:55,998 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:14:51:56,260 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:14:51:56,432 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:14:51:56,895 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.45s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.33s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.24s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.10it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.06s/it]
2025-03-20:14:52:09,697 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:14:52:09,699 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.44it/s] 71%|███████   | 71/100 [00:00<00:00, 350.02it/s]100%|██████████| 100/100 [00:00<00:00, 350.58it/s]
2025-03-20:14:52:09,988 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:09<15:55,  9.65s/it]Running generate_until requests:   2%|▏         | 2/100 [00:28<25:02, 15.33s/it]Running generate_until requests:   3%|▎         | 3/100 [00:39<21:08, 13.07s/it]Running generate_until requests:   4%|▍         | 4/100 [00:56<23:33, 14.72s/it]Running generate_until requests:   5%|▌         | 5/100 [01:08<21:27, 13.55s/it]Running generate_until requests:   6%|▌         | 6/100 [01:40<31:10, 19.90s/it]Running generate_until requests:   7%|▋         | 7/100 [01:50<26:09, 16.87s/it]Running generate_until requests:   8%|▊         | 8/100 [02:02<23:24, 15.27s/it]Running generate_until requests:   9%|▉         | 9/100 [02:10<19:27, 12.83s/it]Running generate_until requests:  10%|█         | 10/100 [02:44<28:56, 19.30s/it]Running generate_until requests:  11%|█         | 11/100 [02:50<22:39, 15.28s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:56<18:25, 12.56s/it]Running generate_until requests:  13%|█▎        | 13/100 [03:05<16:38, 11.47s/it]Running generate_until requests:  14%|█▍        | 14/100 [03:13<14:51, 10.37s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:35<19:47, 13.97s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:44<17:35, 12.56s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:55<16:20, 11.81s/it]Running generate_until requests:  18%|█▊        | 18/100 [04:12<18:28, 13.52s/it]Running generate_until requests:  19%|█▉        | 19/100 [04:20<15:53, 11.78s/it]Running generate_until requests:  20%|██        | 20/100 [04:33<16:22, 12.28s/it]Running generate_until requests:  21%|██        | 21/100 [04:48<17:00, 12.92s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:59<16:09, 12.43s/it]Running generate_until requests:  23%|██▎       | 23/100 [05:07<14:25, 11.24s/it]Running generate_until requests:  24%|██▍       | 24/100 [05:14<12:24,  9.80s/it]Running generate_until requests:  25%|██▌       | 25/100 [05:26<13:19, 10.66s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:35<12:13,  9.91s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:47<12:54, 10.61s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:54<11:23,  9.49s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:59<09:50,  8.31s/it]Running generate_until requests:  30%|███       | 30/100 [06:17<12:50, 11.01s/it]Running generate_until requests:  31%|███       | 31/100 [06:34<14:55, 12.98s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:46<14:29, 12.78s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:55<12:41, 11.37s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:04<11:59, 10.91s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:10<10:03,  9.28s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:21<10:33,  9.90s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:40<13:07, 12.51s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:48<11:34, 11.19s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:59<11:20, 11.15s/it]Running generate_until requests:  40%|████      | 40/100 [08:25<15:30, 15.51s/it]Running generate_until requests:  41%|████      | 41/100 [08:32<12:43, 12.94s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:38<10:40, 11.03s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:45<09:20,  9.84s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:51<08:06,  8.68s/it]Running generate_until requests:  45%|████▌     | 45/100 [09:00<08:06,  8.84s/it]Running generate_until requests:  46%|████▌     | 46/100 [09:07<07:25,  8.26s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:15<07:01,  7.95s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:23<06:58,  8.04s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:37<08:25,  9.91s/it]Running generate_until requests:  50%|█████     | 50/100 [09:43<07:10,  8.61s/it]Running generate_until requests:  51%|█████     | 51/100 [09:50<06:48,  8.33s/it]Running generate_until requests:  52%|█████▏    | 52/100 [10:01<07:14,  9.05s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:16<08:23, 10.70s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:35<10:08, 13.23s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:42<08:29, 11.33s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:49<07:19,  9.99s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:59<07:12, 10.05s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:14<08:03, 11.52s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:23<07:25, 10.87s/it]Running generate_until requests:  60%|██████    | 60/100 [11:28<05:58,  8.96s/it]Running generate_until requests:  61%|██████    | 61/100 [11:35<05:34,  8.58s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:44<05:25,  8.56s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:50<04:51,  7.88s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:02<05:30,  9.18s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:11<05:21,  9.18s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:22<05:29,  9.68s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:32<05:22,  9.76s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:36<04:15,  7.99s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:48<04:48,  9.30s/it]Running generate_until requests:  70%|███████   | 70/100 [12:58<04:38,  9.29s/it]Running generate_until requests:  71%|███████   | 71/100 [13:13<05:24, 11.18s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:21<04:44, 10.17s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:30<04:24,  9.81s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:41<04:24, 10.17s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:47<03:45,  9.04s/it]Running generate_until requests:  76%|███████▌  | 76/100 [13:59<03:53,  9.72s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:09<03:43,  9.74s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:14<03:05,  8.44s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:21<02:47,  7.97s/it]Running generate_until requests:  80%|████████  | 80/100 [14:26<02:25,  7.26s/it]Running generate_until requests:  81%|████████  | 81/100 [14:35<02:27,  7.76s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:51<03:03, 10.20s/it]Running generate_until requests:  83%|████████▎ | 83/100 [14:59<02:38,  9.32s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:06<02:18,  8.68s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:33<03:33, 14.26s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:41<02:54, 12.47s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:55<02:47, 12.86s/it]Running generate_until requests:  88%|████████▊ | 88/100 [16:01<02:08, 10.72s/it]Running generate_until requests:  89%|████████▉ | 89/100 [16:08<01:44,  9.52s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:18<01:37,  9.79s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:23<01:15,  8.44s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:32<01:07,  8.48s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:38<00:53,  7.65s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:49<00:52,  8.76s/it]Running generate_until requests:  95%|█████████▌| 95/100 [17:01<00:49,  9.84s/it]Running generate_until requests:  96%|█████████▌| 96/100 [17:09<00:36,  9.09s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:17<00:26,  8.74s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:26<00:17,  8.92s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:37<00:09,  9.62s/it]Running generate_until requests: 100%|██████████| 100/100 [17:52<00:00, 11.13s/it]Running generate_until requests: 100%|██████████| 100/100 [17:52<00:00, 10.72s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:15:10:07,412 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:15:10:07,443 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:15:11:57,331 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:15:12:09,359 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:15:12:09,360 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:15:12:09,371 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:15:12:09,372 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:15:12:09,372 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:15:12:09,665 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:15:12:09,851 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:15:12:10,311 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.03s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.41it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:15:12:22,196 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:15:12:22,198 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 341.78it/s] 70%|███████   | 70/100 [00:00<00:00, 345.15it/s]100%|██████████| 100/100 [00:00<00:00, 346.09it/s]
2025-03-20:15:12:22,491 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:12<19:57, 12.09s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<27:35, 16.89s/it]Running generate_until requests:   3%|▎         | 3/100 [00:41<21:34, 13.35s/it]Running generate_until requests:   4%|▍         | 4/100 [00:58<23:47, 14.87s/it]Running generate_until requests:   5%|▌         | 5/100 [01:09<21:16, 13.43s/it]Running generate_until requests:   6%|▌         | 6/100 [01:28<23:48, 15.19s/it]Running generate_until requests:   7%|▋         | 7/100 [01:40<22:20, 14.42s/it]Running generate_until requests:   8%|▊         | 8/100 [01:52<20:49, 13.58s/it]Running generate_until requests:   9%|▉         | 9/100 [02:00<17:44, 11.70s/it]Running generate_until requests:  10%|█         | 10/100 [02:16<19:46, 13.19s/it]Running generate_until requests:  11%|█         | 11/100 [02:25<17:33, 11.83s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:31<14:53, 10.16s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:39<13:28,  9.29s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:47<12:46,  8.92s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:03<15:35, 11.00s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:09<13:34,  9.70s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:17<12:44,  9.20s/it]Running generate_until requests:  18%|█▊        | 18/100 [03:35<16:00, 11.71s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:44<14:34, 10.79s/it]Running generate_until requests:  20%|██        | 20/100 [03:57<15:25, 11.57s/it]Running generate_until requests:  21%|██        | 21/100 [04:12<16:43, 12.71s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:23<15:40, 12.05s/it]Running generate_until requests:  23%|██▎       | 23/100 [04:32<14:32, 11.33s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:45<14:42, 11.61s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:57<14:53, 11.91s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:11<15:20, 12.44s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:22<14:44, 12.11s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:32<13:31, 11.27s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:37<11:18,  9.56s/it]Running generate_until requests:  30%|███       | 30/100 [05:56<14:23, 12.33s/it]Running generate_until requests:  31%|███       | 31/100 [06:16<16:39, 14.48s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:42<20:31, 18.11s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:50<16:43, 14.98s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:00<14:45, 13.42s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:05<11:57, 11.04s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:13<10:39,  9.99s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:27<11:54, 11.34s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:39<12:01, 11.64s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:50<11:38, 11.45s/it]Running generate_until requests:  40%|████      | 40/100 [08:12<14:28, 14.48s/it]Running generate_until requests:  41%|████      | 41/100 [08:19<12:00, 12.21s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:26<10:23, 10.76s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:31<08:35,  9.05s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:37<07:31,  8.05s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:46<07:39,  8.36s/it]Running generate_until requests:  46%|████▌     | 46/100 [08:53<07:12,  8.01s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:01<06:51,  7.77s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:09<06:51,  7.91s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:23<08:21,  9.83s/it]Running generate_until requests:  50%|█████     | 50/100 [09:30<07:24,  8.88s/it]Running generate_until requests:  51%|█████     | 51/100 [09:39<07:13,  8.85s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:50<07:46,  9.72s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:05<08:53, 11.36s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:25<10:35, 13.81s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:32<08:47, 11.72s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:40<07:44, 10.56s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:51<07:46, 10.84s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:03<07:50, 11.20s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:13<07:16, 10.63s/it]Running generate_until requests:  60%|██████    | 60/100 [11:18<06:05,  9.15s/it]Running generate_until requests:  61%|██████    | 61/100 [11:26<05:40,  8.73s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:36<05:50,  9.23s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:48<06:11, 10.05s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:03<06:49, 11.39s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:13<06:30, 11.15s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:24<06:16, 11.08s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:33<05:41, 10.36s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:37<04:28,  8.40s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:43<03:56,  7.63s/it]Running generate_until requests:  70%|███████   | 70/100 [12:52<04:03,  8.11s/it]Running generate_until requests:  71%|███████   | 71/100 [13:13<05:46, 11.94s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:21<05:00, 10.72s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:30<04:42, 10.45s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:43<04:51, 11.22s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:52<04:17, 10.30s/it]Running generate_until requests:  76%|███████▌  | 76/100 [14:03<04:17, 10.71s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:14<04:04, 10.64s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:20<03:26,  9.38s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:27<03:01,  8.62s/it]Running generate_until requests:  80%|████████  | 80/100 [14:32<02:32,  7.61s/it]Running generate_until requests:  81%|████████  | 81/100 [14:41<02:31,  8.00s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:57<03:06, 10.34s/it]Running generate_until requests:  83%|████████▎ | 83/100 [15:08<02:56, 10.41s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:15<02:31,  9.44s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:20<02:04,  8.31s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:29<01:55,  8.26s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:38<01:50,  8.53s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:43<01:31,  7.65s/it]Running generate_until requests:  89%|████████▉ | 89/100 [15:50<01:20,  7.30s/it]Running generate_until requests:  90%|█████████ | 90/100 [15:58<01:16,  7.62s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:07<01:11,  7.95s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:18<01:11,  8.93s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:24<00:55,  7.96s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:34<00:51,  8.57s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:46<00:47,  9.56s/it]Running generate_until requests:  96%|█████████▌| 96/100 [16:56<00:39,  9.78s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:04<00:27,  9.21s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:14<00:18,  9.47s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:26<00:10, 10.38s/it]Running generate_until requests: 100%|██████████| 100/100 [17:43<00:00, 12.22s/it]Running generate_until requests: 100%|██████████| 100/100 [17:43<00:00, 10.63s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:15:30:11,280 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:15:30:11,299 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:15:30:51,590 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:15:31:03,739 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:15:31:03,740 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:15:31:03,751 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:15:31:03,751 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:15:31:03,752 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:15:31:04,017 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:15:31:04,193 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:15:31:04,654 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.03s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.42it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s]
2025-03-20:15:31:13,954 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:15:31:13,957 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 344.02it/s] 70%|███████   | 70/100 [00:00<00:00, 345.17it/s]100%|██████████| 100/100 [00:00<00:00, 346.18it/s]
2025-03-20:15:31:14,250 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:12<19:55, 12.08s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<27:36, 16.90s/it]Running generate_until requests:   3%|▎         | 3/100 [00:41<21:36, 13.36s/it]Running generate_until requests:   4%|▍         | 4/100 [00:58<23:49, 14.89s/it]Running generate_until requests:   5%|▌         | 5/100 [01:09<21:18, 13.46s/it]Running generate_until requests:   6%|▌         | 6/100 [01:28<23:51, 15.22s/it]Running generate_until requests:   7%|▋         | 7/100 [01:41<22:23, 14.45s/it]Running generate_until requests:   8%|▊         | 8/100 [01:52<20:52, 13.61s/it]Running generate_until requests:   9%|▉         | 9/100 [02:00<17:46, 11.72s/it]Running generate_until requests:  10%|█         | 10/100 [02:17<19:49, 13.22s/it]Running generate_until requests:  11%|█         | 11/100 [02:25<17:35, 11.86s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:32<14:56, 10.18s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:39<13:30,  9.32s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:47<12:48,  8.94s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:03<15:37, 11.03s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:10<13:36,  9.72s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:18<12:46,  9.23s/it]Running generate_until requests:  18%|█▊        | 18/100 [03:35<16:02, 11.74s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:44<14:36, 10.82s/it]Running generate_until requests:  20%|██        | 20/100 [03:57<15:28, 11.60s/it]Running generate_until requests:  21%|██        | 21/100 [04:13<16:46, 12.74s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:23<15:42, 12.09s/it]Running generate_until requests:  23%|██▎       | 23/100 [04:33<14:34, 11.36s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:45<14:44, 11.64s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:58<14:55, 11.94s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:12<15:23, 12.47s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:23<14:46, 12.15s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:32<13:33, 11.30s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:38<11:20,  9.58s/it]Running generate_until requests:  30%|███       | 30/100 [05:57<14:25, 12.37s/it]Running generate_until requests:  31%|███       | 31/100 [06:16<16:42, 14.52s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:43<20:34, 18.16s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:51<16:46, 15.03s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:01<14:48, 13.46s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:06<11:59, 11.07s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:14<10:40, 10.02s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:28<11:56, 11.37s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:41<12:03, 11.67s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:52<11:40, 11.48s/it]Running generate_until requests:  40%|████      | 40/100 [08:13<14:31, 14.52s/it]Running generate_until requests:  41%|████      | 41/100 [08:20<12:02, 12.24s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:28<10:25, 10.79s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:33<08:37,  9.08s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:38<07:32,  8.08s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:47<07:40,  8.38s/it]Running generate_until requests:  46%|████▌     | 46/100 [08:55<07:13,  8.03s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:02<06:52,  7.79s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:10<06:52,  7.93s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:25<08:22,  9.86s/it]Running generate_until requests:  50%|█████     | 50/100 [09:31<07:25,  8.91s/it]Running generate_until requests:  51%|█████     | 51/100 [09:40<07:15,  8.88s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:52<07:47,  9.74s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:07<08:55, 11.39s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:27<10:36, 13.85s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:34<08:48, 11.75s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:41<07:45, 10.59s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:53<07:47, 10.87s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:05<07:51, 11.23s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:14<07:17, 10.67s/it]Running generate_until requests:  60%|██████    | 60/100 [11:20<06:06,  9.17s/it]Running generate_until requests:  61%|██████    | 61/100 [11:28<05:41,  8.75s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:38<05:51,  9.25s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:50<06:12, 10.08s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:05<06:51, 11.42s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:15<06:31, 11.18s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:26<06:17, 11.11s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:35<05:42, 10.39s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:39<04:29,  8.43s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:45<03:57,  7.65s/it]Running generate_until requests:  70%|███████   | 70/100 [12:54<04:04,  8.14s/it]Running generate_until requests:  71%|███████   | 71/100 [13:15<05:47, 11.98s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:23<05:01, 10.76s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:33<04:42, 10.48s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:46<04:52, 11.26s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:54<04:18, 10.33s/it]Running generate_until requests:  76%|███████▌  | 76/100 [14:06<04:17, 10.75s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:16<04:05, 10.67s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:23<03:26,  9.41s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:29<03:01,  8.65s/it]Running generate_until requests:  80%|████████  | 80/100 [14:35<02:32,  7.63s/it]Running generate_until requests:  81%|████████  | 81/100 [14:44<02:32,  8.02s/it]Running generate_until requests:  82%|████████▏ | 82/100 [15:00<03:06, 10.37s/it]Running generate_until requests:  83%|████████▎ | 83/100 [15:10<02:57, 10.44s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:17<02:31,  9.47s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:23<02:05,  8.34s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:31<01:56,  8.29s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:40<01:51,  8.55s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:46<01:32,  7.67s/it]Running generate_until requests:  89%|████████▉ | 89/100 [15:52<01:20,  7.32s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:01<01:16,  7.64s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:10<01:11,  7.97s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:21<01:11,  8.96s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:27<00:55,  7.98s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:37<00:51,  8.60s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:49<00:47,  9.60s/it]Running generate_until requests:  96%|█████████▌| 96/100 [16:59<00:39,  9.81s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:07<00:27,  9.24s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:17<00:19,  9.51s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:29<00:10, 10.41s/it]Running generate_until requests: 100%|██████████| 100/100 [17:46<00:00, 12.26s/it]Running generate_until requests: 100%|██████████| 100/100 [17:46<00:00, 10.66s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:15:49:05,445 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:15:49:05,465 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:15:49:44,959 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:15:49:57,231 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:15:49:57,232 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:15:49:57,239 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:15:49:57,240 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:15:49:57,240 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:15:49:57,511 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:15:49:57,684 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:15:49:58,193 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.05s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.19it/s]
2025-03-20:15:50:07,598 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:15:50:07,600 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 346.65it/s] 70%|███████   | 70/100 [00:00<00:00, 342.71it/s]100%|██████████| 100/100 [00:00<00:00, 345.17it/s]
2025-03-20:15:50:07,893 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:12<19:53, 12.05s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<27:33, 16.87s/it]Running generate_until requests:   3%|▎         | 3/100 [00:41<21:34, 13.34s/it]Running generate_until requests:   4%|▍         | 4/100 [00:58<23:47, 14.87s/it]Running generate_until requests:   5%|▌         | 5/100 [01:09<21:16, 13.44s/it]Running generate_until requests:   6%|▌         | 6/100 [01:28<23:49, 15.20s/it]Running generate_until requests:   7%|▋         | 7/100 [01:41<22:21, 14.43s/it]Running generate_until requests:   8%|▊         | 8/100 [01:52<20:50, 13.60s/it]Running generate_until requests:   9%|▉         | 9/100 [02:00<17:45, 11.71s/it]Running generate_until requests:  10%|█         | 10/100 [02:16<19:47, 13.20s/it]Running generate_until requests:  11%|█         | 11/100 [02:25<17:34, 11.84s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:32<14:54, 10.17s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:39<13:29,  9.30s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:47<12:47,  8.93s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:03<15:36, 11.01s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:09<13:35,  9.71s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:17<12:44,  9.22s/it]Running generate_until requests:  18%|█▊        | 18/100 [03:35<16:01, 11.73s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:44<14:35, 10.80s/it]Running generate_until requests:  20%|██        | 20/100 [03:57<15:26, 11.58s/it]Running generate_until requests:  21%|██        | 21/100 [04:12<16:44, 12.72s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:23<15:41, 12.07s/it]Running generate_until requests:  23%|██▎       | 23/100 [04:33<14:33, 11.34s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:45<14:43, 11.62s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:58<14:54, 11.93s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:11<15:21, 12.46s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:23<14:45, 12.13s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:32<13:32, 11.29s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:38<11:19,  9.57s/it]Running generate_until requests:  30%|███       | 30/100 [05:56<14:24, 12.35s/it]Running generate_until requests:  31%|███       | 31/100 [06:16<16:40, 14.50s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:42<20:32, 18.13s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:50<16:45, 15.00s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:00<14:47, 13.44s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:05<11:58, 11.05s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:13<10:39, 10.00s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:28<11:55, 11.36s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:40<12:02, 11.65s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:51<11:39, 11.47s/it]Running generate_until requests:  40%|████      | 40/100 [08:12<14:29, 14.50s/it]Running generate_until requests:  41%|████      | 41/100 [08:19<12:01, 12.22s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:27<10:24, 10.77s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:32<08:36,  9.06s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:38<07:31,  8.07s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:47<07:40,  8.37s/it]Running generate_until requests:  46%|████▌     | 46/100 [08:54<07:13,  8.02s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:01<06:52,  7.78s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:09<06:51,  7.92s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:24<08:22,  9.84s/it]Running generate_until requests:  50%|█████     | 50/100 [09:30<07:24,  8.90s/it]Running generate_until requests:  51%|█████     | 51/100 [09:39<07:14,  8.86s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:51<07:46,  9.73s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:06<08:54, 11.37s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:26<10:35, 13.82s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:33<08:48, 11.73s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:40<07:45, 10.57s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:52<07:46, 10.85s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:04<07:50, 11.21s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:13<07:16, 10.65s/it]Running generate_until requests:  60%|██████    | 60/100 [11:19<06:06,  9.16s/it]Running generate_until requests:  61%|██████    | 61/100 [11:27<05:40,  8.74s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:37<05:51,  9.24s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:49<06:12, 10.06s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:04<06:50, 11.40s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:14<06:30, 11.16s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:25<06:17, 11.09s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:34<05:42, 10.37s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:38<04:29,  8.42s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:44<03:56,  7.64s/it]Running generate_until requests:  70%|███████   | 70/100 [12:53<04:03,  8.12s/it]Running generate_until requests:  71%|███████   | 71/100 [13:14<05:46, 11.96s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:22<05:00, 10.74s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:31<04:42, 10.46s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:44<04:52, 11.24s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:53<04:17, 10.32s/it]Running generate_until requests:  76%|███████▌  | 76/100 [14:04<04:17, 10.73s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:15<04:05, 10.65s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:21<03:26,  9.39s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:28<03:01,  8.63s/it]Running generate_until requests:  80%|████████  | 80/100 [14:33<02:32,  7.62s/it]Running generate_until requests:  81%|████████  | 81/100 [14:42<02:32,  8.01s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:58<03:06, 10.35s/it]Running generate_until requests:  83%|████████▎ | 83/100 [15:09<02:57, 10.42s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:16<02:31,  9.45s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:22<02:04,  8.32s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:30<01:55,  8.28s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:39<01:51,  8.54s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:44<01:31,  7.66s/it]Running generate_until requests:  89%|████████▉ | 89/100 [15:51<01:20,  7.31s/it]Running generate_until requests:  90%|█████████ | 90/100 [15:59<01:16,  7.62s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:08<01:11,  7.96s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:19<01:11,  8.94s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:25<00:55,  7.97s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:35<00:51,  8.58s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:47<00:47,  9.58s/it]Running generate_until requests:  96%|█████████▌| 96/100 [16:57<00:39,  9.79s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:05<00:27,  9.22s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:15<00:18,  9.49s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:28<00:10, 10.39s/it]Running generate_until requests: 100%|██████████| 100/100 [17:44<00:00, 12.24s/it]Running generate_until requests: 100%|██████████| 100/100 [17:44<00:00, 10.65s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:16:07:57,921 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:16:07:57,928 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:16:08:38,038 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:16:08:50,021 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:16:08:50,023 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:16:08:50,033 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:16:08:50,033 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:16:08:50,034 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:16:08:50,273 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:16:08:50,671 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:16:08:51,188 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.17s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.05s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2025-03-20:16:09:27,224 WARNING  [load.py:1442] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /home/alireza/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Tue Nov 12 16:43:50 2024).
2025-03-20:16:09:27,227 WARNING  [cache.py:94] Found the latest cached dataset configuration 'main' at /home/alireza/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Tue Nov 12 16:43:50 2024).
2025-03-20:16:09:27,401 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:16:09:27,403 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 344.94it/s] 70%|███████   | 70/100 [00:00<00:00, 341.37it/s]100%|██████████| 100/100 [00:00<00:00, 343.91it/s]
2025-03-20:16:09:27,698 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:12<19:58, 12.10s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<27:40, 16.95s/it]Running generate_until requests:   3%|▎         | 3/100 [00:41<21:37, 13.38s/it]Running generate_until requests:   4%|▍         | 4/100 [00:58<23:48, 14.88s/it]Running generate_until requests:   5%|▌         | 5/100 [01:09<21:17, 13.44s/it]Running generate_until requests:   6%|▌         | 6/100 [01:28<23:48, 15.20s/it]Running generate_until requests:   7%|▋         | 7/100 [01:41<22:21, 14.42s/it]Running generate_until requests:   8%|▊         | 8/100 [01:52<20:50, 13.59s/it]Running generate_until requests:   9%|▉         | 9/100 [02:00<17:44, 11.70s/it]Running generate_until requests:  10%|█         | 10/100 [02:16<19:47, 13.19s/it]Running generate_until requests:  11%|█         | 11/100 [02:25<17:33, 11.84s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:32<14:54, 10.16s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:39<13:28,  9.30s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:47<12:46,  8.92s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:03<15:35, 11.00s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:09<13:34,  9.70s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:17<12:44,  9.21s/it]Running generate_until requests:  18%|█▊        | 18/100 [03:35<16:00, 11.72s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:44<14:34, 10.79s/it]Running generate_until requests:  20%|██        | 20/100 [03:57<15:25, 11.57s/it]Running generate_until requests:  21%|██        | 21/100 [04:12<16:43, 12.71s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:23<15:40, 12.06s/it]Running generate_until requests:  23%|██▎       | 23/100 [04:33<14:32, 11.33s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:45<14:42, 11.61s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:57<14:53, 11.91s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:11<15:20, 12.44s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:23<14:44, 12.11s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:32<13:31, 11.27s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:37<11:18,  9.56s/it]Running generate_until requests:  30%|███       | 30/100 [05:56<14:23, 12.33s/it]Running generate_until requests:  31%|███       | 31/100 [06:16<16:39, 14.48s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:42<20:31, 18.11s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:50<16:43, 14.98s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:00<14:45, 13.42s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:05<11:57, 11.04s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:13<10:39,  9.99s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:27<11:54, 11.34s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:40<12:01, 11.64s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:51<11:38, 11.45s/it]Running generate_until requests:  40%|████      | 40/100 [08:12<14:28, 14.48s/it]Running generate_until requests:  41%|████      | 41/100 [08:19<12:00, 12.21s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:26<10:23, 10.75s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:31<08:35,  9.05s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:37<07:31,  8.05s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:46<07:39,  8.36s/it]Running generate_until requests:  46%|████▌     | 46/100 [08:53<07:12,  8.01s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:01<06:51,  7.77s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:09<06:51,  7.91s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:23<08:21,  9.83s/it]Running generate_until requests:  50%|█████     | 50/100 [09:30<07:24,  8.88s/it]Running generate_until requests:  51%|█████     | 51/100 [09:39<07:13,  8.85s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:50<07:46,  9.72s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:06<08:53, 11.36s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:25<10:35, 13.81s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:32<08:47, 11.72s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:40<07:44, 10.55s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:51<07:45, 10.84s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:03<07:50, 11.20s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:13<07:15, 10.63s/it]Running generate_until requests:  60%|██████    | 60/100 [11:18<06:05,  9.15s/it]Running generate_until requests:  61%|██████    | 61/100 [11:26<05:40,  8.73s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:36<05:50,  9.22s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:48<06:11, 10.05s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:03<06:49, 11.39s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:14<06:30, 11.15s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:24<06:16, 11.08s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:33<05:41, 10.36s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:37<04:28,  8.40s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:43<03:56,  7.63s/it]Running generate_until requests:  70%|███████   | 70/100 [12:52<04:03,  8.11s/it]Running generate_until requests:  71%|███████   | 71/100 [13:13<05:46, 11.94s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:21<05:00, 10.72s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:31<04:42, 10.45s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:44<04:51, 11.22s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:52<04:17, 10.30s/it]Running generate_until requests:  76%|███████▌  | 76/100 [14:03<04:17, 10.71s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:14<04:04, 10.64s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:20<03:26,  9.38s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:27<03:00,  8.62s/it]Running generate_until requests:  80%|████████  | 80/100 [14:32<02:32,  7.61s/it]Running generate_until requests:  81%|████████  | 81/100 [14:41<02:31,  8.00s/it]Running generate_until requests:  82%|████████▏ | 82/100 [14:57<03:06, 10.34s/it]Running generate_until requests:  83%|████████▎ | 83/100 [15:08<02:56, 10.41s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:15<02:30,  9.44s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:21<02:04,  8.31s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:29<01:55,  8.26s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:38<01:50,  8.53s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:43<01:31,  7.65s/it]Running generate_until requests:  89%|████████▉ | 89/100 [15:50<01:20,  7.30s/it]Running generate_until requests:  90%|█████████ | 90/100 [15:58<01:16,  7.61s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:07<01:11,  7.94s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:18<01:11,  8.93s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:24<00:55,  7.96s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:34<00:51,  8.57s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:46<00:47,  9.56s/it]Running generate_until requests:  96%|█████████▌| 96/100 [16:56<00:39,  9.78s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:04<00:27,  9.21s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:14<00:18,  9.47s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:27<00:10, 10.38s/it]Running generate_until requests: 100%|██████████| 100/100 [17:43<00:00, 12.22s/it]Running generate_until requests: 100%|██████████| 100/100 [17:43<00:00, 10.64s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:16:27:16,654 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:16:27:16,659 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:16:27:57,671 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:16:28:10,089 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:16:28:10,091 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:16:28:10,100 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:16:28:10,101 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:16:28:10,101 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:16:28:10,359 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:16:28:10,534 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:16:28:10,997 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.45s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.29s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.22s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.12it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.04s/it]
2025-03-20:16:28:20,433 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:16:28:20,435 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 345.88it/s] 71%|███████   | 71/100 [00:00<00:00, 349.91it/s]100%|██████████| 100/100 [00:00<00:00, 349.88it/s]
2025-03-20:16:28:20,725 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:12<20:00, 12.13s/it]Running generate_until requests:   2%|▏         | 2/100 [00:32<27:45, 17.00s/it]Running generate_until requests:   3%|▎         | 3/100 [00:41<21:42, 13.42s/it]Running generate_until requests:   4%|▍         | 4/100 [00:58<23:54, 14.94s/it]Running generate_until requests:   5%|▌         | 5/100 [01:09<21:22, 13.50s/it]Running generate_until requests:   6%|▌         | 6/100 [01:28<23:54, 15.26s/it]Running generate_until requests:   7%|▋         | 7/100 [01:41<22:26, 14.48s/it]Running generate_until requests:   8%|▊         | 8/100 [01:53<20:55, 13.64s/it]Running generate_until requests:   9%|▉         | 9/100 [02:00<17:49, 11.75s/it]Running generate_until requests:  10%|█         | 10/100 [02:17<19:52, 13.25s/it]Running generate_until requests:  11%|█         | 11/100 [02:26<17:37, 11.89s/it]Running generate_until requests:  12%|█▏        | 12/100 [02:32<14:58, 10.20s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:39<13:32,  9.34s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:48<12:50,  8.96s/it]Running generate_until requests:  15%|█▌        | 15/100 [03:03<15:39, 11.05s/it]Running generate_until requests:  16%|█▌        | 16/100 [03:10<13:38,  9.74s/it]Running generate_until requests:  17%|█▋        | 17/100 [03:18<12:47,  9.25s/it]Running generate_until requests:  18%|█▊        | 18/100 [03:36<16:04, 11.77s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:45<14:38, 10.84s/it]Running generate_until requests:  20%|██        | 20/100 [03:58<15:30, 11.63s/it]Running generate_until requests:  21%|██        | 21/100 [04:13<16:48, 12.77s/it]Running generate_until requests:  22%|██▏       | 22/100 [04:24<15:44, 12.11s/it]Running generate_until requests:  23%|██▎       | 23/100 [04:34<14:36, 11.38s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:46<14:46, 11.67s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:59<14:57, 11.97s/it]Running generate_until requests:  26%|██▌       | 26/100 [05:12<15:24, 12.50s/it]Running generate_until requests:  27%|██▋       | 27/100 [05:24<14:48, 12.17s/it]Running generate_until requests:  28%|██▊       | 28/100 [05:33<13:35, 11.33s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:39<11:21,  9.60s/it]Running generate_until requests:  30%|███       | 30/100 [05:58<14:27, 12.39s/it]Running generate_until requests:  31%|███       | 31/100 [06:17<16:44, 14.55s/it]Running generate_until requests:  32%|███▏      | 32/100 [06:44<20:37, 18.20s/it]Running generate_until requests:  33%|███▎      | 33/100 [06:52<16:48, 15.06s/it]Running generate_until requests:  34%|███▍      | 34/100 [07:02<14:50, 13.49s/it]Running generate_until requests:  35%|███▌      | 35/100 [07:07<12:00, 11.09s/it]Running generate_until requests:  36%|███▌      | 36/100 [07:15<10:42, 10.04s/it]Running generate_until requests:  37%|███▋      | 37/100 [07:29<11:58, 11.40s/it]Running generate_until requests:  38%|███▊      | 38/100 [07:42<12:05, 11.70s/it]Running generate_until requests:  39%|███▉      | 39/100 [07:53<11:41, 11.51s/it]Running generate_until requests:  40%|████      | 40/100 [08:14<14:32, 14.55s/it]Running generate_until requests:  41%|████      | 41/100 [08:21<12:03, 12.27s/it]Running generate_until requests:  42%|████▏     | 42/100 [08:29<10:26, 10.81s/it]Running generate_until requests:  43%|████▎     | 43/100 [08:34<08:38,  9.09s/it]Running generate_until requests:  44%|████▍     | 44/100 [08:40<07:33,  8.09s/it]Running generate_until requests:  45%|████▌     | 45/100 [08:49<07:41,  8.40s/it]Running generate_until requests:  46%|████▌     | 46/100 [08:56<07:14,  8.05s/it]Running generate_until requests:  47%|████▋     | 47/100 [09:03<06:53,  7.81s/it]Running generate_until requests:  48%|████▊     | 48/100 [09:11<06:53,  7.95s/it]Running generate_until requests:  49%|████▉     | 49/100 [09:26<08:23,  9.88s/it]Running generate_until requests:  50%|█████     | 50/100 [09:32<07:26,  8.93s/it]Running generate_until requests:  51%|█████     | 51/100 [09:41<07:15,  8.90s/it]Running generate_until requests:  52%|█████▏    | 52/100 [09:53<07:48,  9.76s/it]Running generate_until requests:  53%|█████▎    | 53/100 [10:08<08:56, 11.41s/it]Running generate_until requests:  54%|█████▍    | 54/100 [10:28<10:38, 13.88s/it]Running generate_until requests:  55%|█████▌    | 55/100 [10:35<08:50, 11.78s/it]Running generate_until requests:  56%|█████▌    | 56/100 [10:43<07:46, 10.61s/it]Running generate_until requests:  57%|█████▋    | 57/100 [10:54<07:48, 10.89s/it]Running generate_until requests:  58%|█████▊    | 58/100 [11:06<07:52, 11.25s/it]Running generate_until requests:  59%|█████▉    | 59/100 [11:16<07:18, 10.69s/it]Running generate_until requests:  60%|██████    | 60/100 [11:21<06:07,  9.19s/it]Running generate_until requests:  61%|██████    | 61/100 [11:29<05:42,  8.77s/it]Running generate_until requests:  62%|██████▏   | 62/100 [11:40<05:52,  9.27s/it]Running generate_until requests:  63%|██████▎   | 63/100 [11:52<06:13, 10.10s/it]Running generate_until requests:  64%|██████▍   | 64/100 [12:06<06:52, 11.45s/it]Running generate_until requests:  65%|██████▌   | 65/100 [12:17<06:32, 11.21s/it]Running generate_until requests:  66%|██████▌   | 66/100 [12:28<06:18, 11.14s/it]Running generate_until requests:  67%|██████▋   | 67/100 [12:37<05:43, 10.41s/it]Running generate_until requests:  68%|██████▊   | 68/100 [12:41<04:30,  8.45s/it]Running generate_until requests:  69%|██████▉   | 69/100 [12:46<03:57,  7.67s/it]Running generate_until requests:  70%|███████   | 70/100 [12:56<04:04,  8.15s/it]Running generate_until requests:  71%|███████   | 71/100 [13:17<05:48, 12.00s/it]Running generate_until requests:  72%|███████▏  | 72/100 [13:25<05:01, 10.78s/it]Running generate_until requests:  73%|███████▎  | 73/100 [13:34<04:43, 10.50s/it]Running generate_until requests:  74%|███████▍  | 74/100 [13:48<04:53, 11.28s/it]Running generate_until requests:  75%|███████▌  | 75/100 [13:56<04:18, 10.36s/it]Running generate_until requests:  76%|███████▌  | 76/100 [14:07<04:18, 10.77s/it]Running generate_until requests:  77%|███████▋  | 77/100 [14:18<04:06, 10.70s/it]Running generate_until requests:  78%|███████▊  | 78/100 [14:24<03:27,  9.43s/it]Running generate_until requests:  79%|███████▉  | 79/100 [14:31<03:01,  8.67s/it]Running generate_until requests:  80%|████████  | 80/100 [14:37<02:33,  7.65s/it]Running generate_until requests:  81%|████████  | 81/100 [14:46<02:32,  8.04s/it]Running generate_until requests:  82%|████████▏ | 82/100 [15:01<03:07, 10.40s/it]Running generate_until requests:  83%|████████▎ | 83/100 [15:12<02:57, 10.47s/it]Running generate_until requests:  84%|████████▍ | 84/100 [15:19<02:31,  9.49s/it]Running generate_until requests:  85%|████████▌ | 85/100 [15:25<02:05,  8.36s/it]Running generate_until requests:  86%|████████▌ | 86/100 [15:33<01:56,  8.31s/it]Running generate_until requests:  87%|████████▋ | 87/100 [15:42<01:51,  8.58s/it]Running generate_until requests:  88%|████████▊ | 88/100 [15:48<01:32,  7.69s/it]Running generate_until requests:  89%|████████▉ | 89/100 [15:55<01:20,  7.34s/it]Running generate_until requests:  90%|█████████ | 90/100 [16:03<01:16,  7.66s/it]Running generate_until requests:  91%|█████████ | 91/100 [16:12<01:11,  7.99s/it]Running generate_until requests:  92%|█████████▏| 92/100 [16:23<01:11,  8.98s/it]Running generate_until requests:  93%|█████████▎| 93/100 [16:29<00:56,  8.00s/it]Running generate_until requests:  94%|█████████▍| 94/100 [16:39<00:51,  8.62s/it]Running generate_until requests:  95%|█████████▌| 95/100 [16:51<00:48,  9.62s/it]Running generate_until requests:  96%|█████████▌| 96/100 [17:01<00:39,  9.83s/it]Running generate_until requests:  97%|█████████▋| 97/100 [17:09<00:27,  9.27s/it]Running generate_until requests:  98%|█████████▊| 98/100 [17:19<00:19,  9.53s/it]Running generate_until requests:  99%|█████████▉| 99/100 [17:32<00:10, 10.44s/it]Running generate_until requests: 100%|██████████| 100/100 [17:48<00:00, 12.29s/it]Running generate_until requests: 100%|██████████| 100/100 [17:48<00:00, 10.69s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:16:46:14,953 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:16:46:14,964 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:16:48:05,443 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:16:48:17,366 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:16:48:17,367 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:16:48:17,376 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:16:48:17,377 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:16:48:17,377 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:16:48:17,640 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:16:48:17,872 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:16:48:18,345 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.00s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.05it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.42it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s]
2025-03-20:16:48:27,573 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:16:48:27,576 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.55it/s] 70%|███████   | 70/100 [00:00<00:00, 346.79it/s]100%|██████████| 100/100 [00:00<00:00, 348.84it/s]
2025-03-20:16:48:27,867 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:12, 38.31s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:20, 36.94s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:54, 36.44s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:34, 35.98s/it]Running generate_until requests:   5%|▌         | 5/100 [02:58<55:17, 34.92s/it]Running generate_until requests:   6%|▌         | 6/100 [03:33<54:32, 34.81s/it]Running generate_until requests:   7%|▋         | 7/100 [03:44<41:57, 27.07s/it]Running generate_until requests:   8%|▊         | 8/100 [04:18<44:49, 29.24s/it]Running generate_until requests:   9%|▉         | 9/100 [04:28<35:19, 23.29s/it]Running generate_until requests:  10%|█         | 10/100 [04:41<30:07, 20.08s/it]Running generate_until requests:  11%|█         | 11/100 [05:08<32:56, 22.20s/it]Running generate_until requests:  12%|█▏        | 12/100 [05:38<36:11, 24.68s/it]Running generate_until requests:  13%|█▎        | 13/100 [06:11<39:31, 27.26s/it]Running generate_until requests:  14%|█▍        | 14/100 [06:23<32:16, 22.51s/it]Running generate_until requests:  15%|█▌        | 15/100 [06:56<36:24, 25.70s/it]Running generate_until requests:  16%|█▌        | 16/100 [07:13<32:28, 23.20s/it]Running generate_until requests:  17%|█▋        | 17/100 [07:46<36:04, 26.08s/it]Running generate_until requests:  18%|█▊        | 18/100 [08:18<38:10, 27.93s/it]Running generate_until requests:  19%|█▉        | 19/100 [08:32<32:07, 23.80s/it]Running generate_until requests:  20%|██        | 20/100 [09:00<33:19, 24.99s/it]Running generate_until requests:  21%|██        | 21/100 [09:32<35:44, 27.15s/it]Running generate_until requests:  22%|██▏       | 22/100 [09:54<33:03, 25.42s/it]Running generate_until requests:  23%|██▎       | 23/100 [10:26<35:07, 27.37s/it]Running generate_until requests:  24%|██▍       | 24/100 [10:58<36:21, 28.71s/it]Running generate_until requests:  25%|██▌       | 25/100 [11:29<37:02, 29.63s/it]Running generate_until requests:  26%|██▌       | 26/100 [11:49<32:42, 26.52s/it]Running generate_until requests:  27%|██▋       | 27/100 [11:58<26:12, 21.54s/it]Running generate_until requests:  28%|██▊       | 28/100 [12:13<23:26, 19.54s/it]Running generate_until requests:  29%|██▉       | 29/100 [12:45<27:24, 23.17s/it]Running generate_until requests:  30%|███       | 30/100 [13:17<29:59, 25.70s/it]Running generate_until requests:  31%|███       | 31/100 [13:48<31:33, 27.44s/it]Running generate_until requests:  32%|███▏      | 32/100 [14:20<32:26, 28.63s/it]Running generate_until requests:  33%|███▎      | 33/100 [14:27<24:59, 22.39s/it]Running generate_until requests:  34%|███▍      | 34/100 [14:42<22:10, 20.15s/it]Running generate_until requests:  35%|███▌      | 35/100 [14:52<18:18, 16.90s/it]Running generate_until requests:  36%|███▌      | 36/100 [15:23<22:35, 21.18s/it]Running generate_until requests:  37%|███▋      | 37/100 [15:54<25:22, 24.17s/it]Running generate_until requests:  38%|███▊      | 38/100 [16:10<22:37, 21.89s/it]Running generate_until requests:  39%|███▉      | 39/100 [16:40<24:41, 24.29s/it]Running generate_until requests:  40%|████      | 40/100 [17:11<26:18, 26.31s/it]Running generate_until requests:  41%|████      | 41/100 [17:42<27:14, 27.71s/it]Running generate_until requests:  42%|████▏     | 42/100 [18:13<27:43, 28.68s/it]Running generate_until requests:  43%|████▎     | 43/100 [18:30<23:52, 25.12s/it]Running generate_until requests:  44%|████▍     | 44/100 [18:42<19:36, 21.01s/it]Running generate_until requests:  45%|████▌     | 45/100 [19:12<21:57, 23.95s/it]Running generate_until requests:  46%|████▌     | 46/100 [19:20<17:02, 18.93s/it]Running generate_until requests:  47%|████▋     | 47/100 [19:34<15:30, 17.55s/it]Running generate_until requests:  48%|████▊     | 48/100 [19:42<12:45, 14.72s/it]Running generate_until requests:  49%|████▉     | 49/100 [20:13<16:32, 19.46s/it]Running generate_until requests:  50%|█████     | 50/100 [20:43<18:57, 22.76s/it]Running generate_until requests:  51%|█████     | 51/100 [21:13<20:25, 25.02s/it]Running generate_until requests:  52%|█████▏    | 52/100 [21:44<21:15, 26.58s/it]Running generate_until requests:  53%|█████▎    | 53/100 [22:13<21:36, 27.58s/it]Running generate_until requests:  54%|█████▍    | 54/100 [22:43<21:40, 28.27s/it]Running generate_until requests:  55%|█████▌    | 55/100 [23:01<18:43, 24.96s/it]Running generate_until requests:  56%|█████▌    | 56/100 [23:30<19:21, 26.41s/it]Running generate_until requests:  57%|█████▋    | 57/100 [23:46<16:36, 23.18s/it]Running generate_until requests:  58%|█████▊    | 58/100 [24:11<16:35, 23.69s/it]Running generate_until requests:  59%|█████▉    | 59/100 [24:40<17:23, 25.44s/it]Running generate_until requests:  60%|██████    | 60/100 [24:48<13:20, 20.01s/it]Running generate_until requests:  61%|██████    | 61/100 [25:02<11:55, 18.36s/it]Running generate_until requests:  62%|██████▏   | 62/100 [25:32<13:43, 21.67s/it]Running generate_until requests:  63%|██████▎   | 63/100 [26:01<14:44, 23.92s/it]Running generate_until requests:  64%|██████▍   | 64/100 [26:30<15:16, 25.46s/it]Running generate_until requests:  65%|██████▌   | 65/100 [26:59<15:28, 26.54s/it]Running generate_until requests:  66%|██████▌   | 66/100 [27:17<13:34, 23.95s/it]Running generate_until requests:  67%|██████▋   | 67/100 [27:46<14:00, 25.46s/it]Running generate_until requests:  68%|██████▊   | 68/100 [28:00<11:42, 21.95s/it]Running generate_until requests:  69%|██████▉   | 69/100 [28:28<12:23, 23.97s/it]Running generate_until requests:  70%|███████   | 70/100 [28:57<12:41, 25.38s/it]Running generate_until requests:  71%|███████   | 71/100 [29:26<12:44, 26.35s/it]Running generate_until requests:  72%|███████▏  | 72/100 [29:35<09:52, 21.16s/it]Running generate_until requests:  73%|███████▎  | 73/100 [30:03<10:30, 23.35s/it]Running generate_until requests:  74%|███████▍  | 74/100 [30:31<10:46, 24.85s/it]Running generate_until requests:  75%|███████▌  | 75/100 [31:00<10:47, 25.89s/it]Running generate_until requests:  76%|███████▌  | 76/100 [31:14<08:56, 22.35s/it]Running generate_until requests:  77%|███████▋  | 77/100 [31:24<07:06, 18.56s/it]Running generate_until requests:  78%|███████▊  | 78/100 [31:30<05:27, 14.88s/it]Running generate_until requests:  79%|███████▉  | 79/100 [31:43<05:04, 14.52s/it]Running generate_until requests:  80%|████████  | 80/100 [32:11<06:11, 18.56s/it]Running generate_until requests:  81%|████████  | 81/100 [32:39<06:46, 21.39s/it]Running generate_until requests:  82%|████████▏ | 82/100 [33:07<06:59, 23.31s/it]Running generate_until requests:  83%|████████▎ | 83/100 [33:23<05:57, 21.04s/it]Running generate_until requests:  84%|████████▍ | 84/100 [33:50<06:07, 22.98s/it]Running generate_until requests:  85%|████████▌ | 85/100 [34:18<06:03, 24.24s/it]Running generate_until requests:  86%|████████▌ | 86/100 [34:28<04:41, 20.12s/it]Running generate_until requests:  87%|████████▋ | 87/100 [34:37<03:35, 16.59s/it]Running generate_until requests:  88%|████████▊ | 88/100 [34:42<02:40, 13.38s/it]Running generate_until requests:  89%|████████▉ | 89/100 [34:54<02:21, 12.82s/it]Running generate_until requests:  90%|█████████ | 90/100 [35:21<02:49, 16.99s/it]Running generate_until requests:  91%|█████████ | 91/100 [35:47<02:58, 19.87s/it]Running generate_until requests:  92%|█████████▏| 92/100 [36:14<02:54, 21.81s/it]Running generate_until requests:  93%|█████████▎| 93/100 [36:18<01:55, 16.46s/it]Running generate_until requests:  94%|█████████▍| 94/100 [36:33<01:36, 16.08s/it]Running generate_until requests:  95%|█████████▌| 95/100 [36:59<01:35, 19.13s/it]Running generate_until requests:  96%|█████████▌| 96/100 [37:25<01:25, 21.26s/it]Running generate_until requests:  97%|█████████▋| 97/100 [37:51<01:08, 22.75s/it]Running generate_until requests:  98%|█████████▊| 98/100 [38:17<00:47, 23.72s/it]Running generate_until requests:  99%|█████████▉| 99/100 [38:43<00:24, 24.29s/it]Running generate_until requests: 100%|██████████| 100/100 [39:09<00:00, 24.68s/it]Running generate_until requests: 100%|██████████| 100/100 [39:09<00:00, 23.49s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:17:27:42,344 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:17:27:42,365 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:17:28:22,587 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:17:28:34,372 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:17:28:34,374 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:17:28:34,383 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:17:28:34,383 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:17:28:34,384 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:17:28:34,642 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:17:28:34,816 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:17:28:35,283 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.01s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.41it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:17:28:44,129 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:17:28:44,132 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 345.59it/s] 71%|███████   | 71/100 [00:00<00:00, 350.59it/s]100%|██████████| 100/100 [00:00<00:00, 351.76it/s]
2025-03-20:17:28:44,420 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:12, 38.30s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:19, 36.93s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:53, 36.43s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:33, 35.97s/it]Running generate_until requests:   5%|▌         | 5/100 [02:58<55:16, 34.91s/it]Running generate_until requests:   6%|▌         | 6/100 [03:33<54:31, 34.80s/it]Running generate_until requests:   7%|▋         | 7/100 [03:44<41:56, 27.06s/it]Running generate_until requests:   8%|▊         | 8/100 [04:18<44:49, 29.23s/it]Running generate_until requests:   9%|▉         | 9/100 [04:28<35:18, 23.28s/it]Running generate_until requests:  10%|█         | 10/100 [04:41<30:06, 20.07s/it]Running generate_until requests:  11%|█         | 11/100 [05:08<32:55, 22.20s/it]Running generate_until requests:  12%|█▏        | 12/100 [05:38<36:11, 24.67s/it]Running generate_until requests:  13%|█▎        | 13/100 [06:11<39:30, 27.25s/it]Running generate_until requests:  14%|█▍        | 14/100 [06:23<32:15, 22.51s/it]Running generate_until requests:  15%|█▌        | 15/100 [06:56<36:24, 25.69s/it]Running generate_until requests:  16%|█▌        | 16/100 [07:13<32:28, 23.19s/it]Running generate_until requests:  17%|█▋        | 17/100 [07:46<36:04, 26.07s/it]Running generate_until requests:  18%|█▊        | 18/100 [08:18<38:10, 27.93s/it]Running generate_until requests:  19%|█▉        | 19/100 [08:32<32:07, 23.79s/it]Running generate_until requests:  20%|██        | 20/100 [09:00<33:18, 24.98s/it]Running generate_until requests:  21%|██        | 21/100 [09:32<35:42, 27.12s/it]Running generate_until requests:  22%|██▏       | 22/100 [09:54<33:01, 25.41s/it]Running generate_until requests:  23%|██▎       | 23/100 [10:25<35:06, 27.35s/it]Running generate_until requests:  24%|██▍       | 24/100 [10:57<36:20, 28.70s/it]Running generate_until requests:  25%|██▌       | 25/100 [11:29<37:01, 29.62s/it]Running generate_until requests:  26%|██▌       | 26/100 [11:48<32:41, 26.51s/it]Running generate_until requests:  27%|██▋       | 27/100 [11:58<26:12, 21.54s/it]Running generate_until requests:  28%|██▊       | 28/100 [12:13<23:26, 19.54s/it]Running generate_until requests:  29%|██▉       | 29/100 [12:45<27:24, 23.16s/it]Running generate_until requests:  30%|███       | 30/100 [13:16<29:58, 25.70s/it]Running generate_until requests:  31%|███       | 31/100 [13:48<31:33, 27.44s/it]Running generate_until requests:  32%|███▏      | 32/100 [14:19<32:26, 28.63s/it]Running generate_until requests:  33%|███▎      | 33/100 [14:27<24:59, 22.38s/it]Running generate_until requests:  34%|███▍      | 34/100 [14:42<22:10, 20.15s/it]Running generate_until requests:  35%|███▌      | 35/100 [14:51<18:18, 16.90s/it]Running generate_until requests:  36%|███▌      | 36/100 [15:23<22:35, 21.18s/it]Running generate_until requests:  37%|███▋      | 37/100 [15:54<25:22, 24.16s/it]Running generate_until requests:  38%|███▊      | 38/100 [16:10<22:36, 21.88s/it]Running generate_until requests:  39%|███▉      | 39/100 [16:40<24:41, 24.29s/it]Running generate_until requests:  40%|████      | 40/100 [17:11<26:18, 26.30s/it]Running generate_until requests:  41%|████      | 41/100 [17:42<27:14, 27.70s/it]Running generate_until requests:  42%|████▏     | 42/100 [18:13<27:43, 28.68s/it]Running generate_until requests:  43%|████▎     | 43/100 [18:30<23:51, 25.12s/it]Running generate_until requests:  44%|████▍     | 44/100 [18:41<19:36, 21.00s/it]Running generate_until requests:  45%|████▌     | 45/100 [19:12<21:57, 23.95s/it]Running generate_until requests:  46%|████▌     | 46/100 [19:19<17:02, 18.93s/it]Running generate_until requests:  47%|████▋     | 47/100 [19:34<15:30, 17.55s/it]Running generate_until requests:  48%|████▊     | 48/100 [19:42<12:45, 14.72s/it]Running generate_until requests:  49%|████▉     | 49/100 [20:12<16:32, 19.46s/it]Running generate_until requests:  50%|█████     | 50/100 [20:43<18:57, 22.75s/it]Running generate_until requests:  51%|█████     | 51/100 [21:13<20:25, 25.01s/it]Running generate_until requests:  52%|█████▏    | 52/100 [21:43<21:15, 26.57s/it]Running generate_until requests:  53%|█████▎    | 53/100 [22:13<21:35, 27.57s/it]Running generate_until requests:  54%|█████▍    | 54/100 [22:43<21:39, 28.26s/it]Running generate_until requests:  55%|█████▌    | 55/100 [23:00<18:42, 24.95s/it]Running generate_until requests:  56%|█████▌    | 56/100 [23:30<19:21, 26.40s/it]Running generate_until requests:  57%|█████▋    | 57/100 [23:46<16:36, 23.17s/it]Running generate_until requests:  58%|█████▊    | 58/100 [24:10<16:34, 23.68s/it]Running generate_until requests:  59%|█████▉    | 59/100 [24:40<17:22, 25.44s/it]Running generate_until requests:  60%|██████    | 60/100 [24:47<13:20, 20.00s/it]Running generate_until requests:  61%|██████    | 61/100 [25:02<11:55, 18.35s/it]Running generate_until requests:  62%|██████▏   | 62/100 [25:31<13:43, 21.66s/it]Running generate_until requests:  63%|██████▎   | 63/100 [26:00<14:44, 23.91s/it]Running generate_until requests:  64%|██████▍   | 64/100 [26:29<15:16, 25.45s/it]Running generate_until requests:  65%|██████▌   | 65/100 [26:58<15:28, 26.53s/it]Running generate_until requests:  66%|██████▌   | 66/100 [27:16<13:34, 23.95s/it]Running generate_until requests:  67%|██████▋   | 67/100 [27:45<13:59, 25.45s/it]Running generate_until requests:  68%|██████▊   | 68/100 [27:59<11:42, 21.95s/it]Running generate_until requests:  69%|██████▉   | 69/100 [28:28<12:22, 23.97s/it]Running generate_until requests:  70%|███████   | 70/100 [28:56<12:41, 25.37s/it]Running generate_until requests:  71%|███████   | 71/100 [29:25<12:43, 26.34s/it]Running generate_until requests:  72%|███████▏  | 72/100 [29:34<09:52, 21.15s/it]Running generate_until requests:  73%|███████▎  | 73/100 [30:03<10:30, 23.34s/it]Running generate_until requests:  74%|███████▍  | 74/100 [30:31<10:45, 24.84s/it]Running generate_until requests:  75%|███████▌  | 75/100 [30:59<10:46, 25.87s/it]Running generate_until requests:  76%|███████▌  | 76/100 [31:13<08:56, 22.34s/it]Running generate_until requests:  77%|███████▋  | 77/100 [31:23<07:06, 18.55s/it]Running generate_until requests:  78%|███████▊  | 78/100 [31:29<05:26, 14.86s/it]Running generate_until requests:  79%|███████▉  | 79/100 [31:43<05:04, 14.51s/it]Running generate_until requests:  80%|████████  | 80/100 [32:11<06:10, 18.55s/it]Running generate_until requests:  81%|████████  | 81/100 [32:39<06:46, 21.38s/it]Running generate_until requests:  82%|████████▏ | 82/100 [33:07<06:59, 23.30s/it]Running generate_until requests:  83%|████████▎ | 83/100 [33:22<05:57, 21.03s/it]Running generate_until requests:  84%|████████▍ | 84/100 [33:50<06:07, 22.97s/it]Running generate_until requests:  85%|████████▌ | 85/100 [34:17<06:03, 24.23s/it]Running generate_until requests:  86%|████████▌ | 86/100 [34:28<04:41, 20.11s/it]Running generate_until requests:  87%|████████▋ | 87/100 [34:36<03:35, 16.58s/it]Running generate_until requests:  88%|████████▊ | 88/100 [34:42<02:40, 13.38s/it]Running generate_until requests:  89%|████████▉ | 89/100 [34:53<02:21, 12.82s/it]Running generate_until requests:  90%|█████████ | 90/100 [35:20<02:49, 16.99s/it]Running generate_until requests:  91%|█████████ | 91/100 [35:47<02:58, 19.87s/it]Running generate_until requests:  92%|█████████▏| 92/100 [36:13<02:54, 21.81s/it]Running generate_until requests:  93%|█████████▎| 93/100 [36:17<01:55, 16.46s/it]Running generate_until requests:  94%|█████████▍| 94/100 [36:32<01:36, 16.08s/it]Running generate_until requests:  95%|█████████▌| 95/100 [36:58<01:35, 19.12s/it]Running generate_until requests:  96%|█████████▌| 96/100 [37:25<01:25, 21.26s/it]Running generate_until requests:  97%|█████████▋| 97/100 [37:51<01:08, 22.74s/it]Running generate_until requests:  98%|█████████▊| 98/100 [38:17<00:47, 23.72s/it]Running generate_until requests:  99%|█████████▉| 99/100 [38:42<00:24, 24.30s/it]Running generate_until requests: 100%|██████████| 100/100 [39:08<00:00, 24.68s/it]Running generate_until requests: 100%|██████████| 100/100 [39:08<00:00, 23.48s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:18:07:58,134 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:18:07:58,179 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:18:08:38,373 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:18:08:50,024 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:18:08:50,026 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:18:08:50,036 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:18:08:50,037 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:18:08:50,037 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:18:08:50,285 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:18:08:50,475 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:18:08:50,943 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.02s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:18:08:59,424 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:18:08:59,427 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 345.79it/s] 70%|███████   | 70/100 [00:00<00:00, 342.76it/s]100%|██████████| 100/100 [00:00<00:00, 345.16it/s]
2025-03-20:18:08:59,720 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:25, 38.43s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:29, 37.03s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<59:02, 36.52s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:41, 36.06s/it]Running generate_until requests:   5%|▌         | 5/100 [02:58<55:24, 35.00s/it]Running generate_until requests:   6%|▌         | 6/100 [03:33<54:39, 34.88s/it]Running generate_until requests:   7%|▋         | 7/100 [03:44<42:02, 27.12s/it]Running generate_until requests:   8%|▊         | 8/100 [04:18<44:55, 29.30s/it]Running generate_until requests:   9%|▉         | 9/100 [04:28<35:23, 23.34s/it]Running generate_until requests:  10%|█         | 10/100 [04:41<30:10, 20.12s/it]Running generate_until requests:  11%|█         | 11/100 [05:08<33:00, 22.25s/it]Running generate_until requests:  12%|█▏        | 12/100 [05:39<36:16, 24.73s/it]Running generate_until requests:  13%|█▎        | 13/100 [06:12<39:36, 27.31s/it]Running generate_until requests:  14%|█▍        | 14/100 [06:24<32:20, 22.56s/it]Running generate_until requests:  15%|█▌        | 15/100 [06:57<36:29, 25.75s/it]Running generate_until requests:  16%|█▌        | 16/100 [07:14<32:32, 23.25s/it]Running generate_until requests:  17%|█▋        | 17/100 [07:47<36:09, 26.13s/it]Running generate_until requests:  18%|█▊        | 18/100 [08:19<38:15, 27.99s/it]Running generate_until requests:  19%|█▉        | 19/100 [08:34<32:11, 23.85s/it]Running generate_until requests:  20%|██        | 20/100 [09:01<33:23, 25.04s/it]Running generate_until requests:  21%|██        | 21/100 [09:34<35:47, 27.19s/it]Running generate_until requests:  22%|██▏       | 22/100 [09:55<33:06, 25.47s/it]Running generate_until requests:  23%|██▎       | 23/100 [10:27<35:11, 27.42s/it]Running generate_until requests:  24%|██▍       | 24/100 [10:59<36:26, 28.76s/it]Running generate_until requests:  25%|██▌       | 25/100 [11:31<37:07, 29.70s/it]Running generate_until requests:  26%|██▌       | 26/100 [11:50<32:46, 26.58s/it]Running generate_until requests:  27%|██▋       | 27/100 [12:00<26:15, 21.59s/it]Running generate_until requests:  28%|██▊       | 28/100 [12:15<23:30, 19.59s/it]Running generate_until requests:  29%|██▉       | 29/100 [12:47<27:28, 23.22s/it]Running generate_until requests:  30%|███       | 30/100 [13:18<30:03, 25.76s/it]Running generate_until requests:  31%|███       | 31/100 [13:50<31:37, 27.50s/it]Running generate_until requests:  32%|███▏      | 32/100 [14:21<32:31, 28.70s/it]Running generate_until requests:  33%|███▎      | 33/100 [14:29<25:03, 22.44s/it]Running generate_until requests:  34%|███▍      | 34/100 [14:44<22:13, 20.20s/it]Running generate_until requests:  35%|███▌      | 35/100 [14:53<18:20, 16.94s/it]Running generate_until requests:  36%|███▌      | 36/100 [15:25<22:38, 21.23s/it]Running generate_until requests:  37%|███▋      | 37/100 [15:56<25:26, 24.22s/it]Running generate_until requests:  38%|███▊      | 38/100 [16:13<22:40, 21.94s/it]Running generate_until requests:  39%|███▉      | 39/100 [16:43<24:45, 24.35s/it]Running generate_until requests:  40%|████      | 40/100 [17:14<26:22, 26.37s/it]Running generate_until requests:  41%|████      | 41/100 [17:45<27:18, 27.77s/it]Running generate_until requests:  42%|████▏     | 42/100 [18:16<27:47, 28.75s/it]Running generate_until requests:  43%|████▎     | 43/100 [18:33<23:55, 25.18s/it]Running generate_until requests:  44%|████▍     | 44/100 [18:44<19:39, 21.06s/it]Running generate_until requests:  45%|████▌     | 45/100 [19:15<22:00, 24.01s/it]Running generate_until requests:  46%|████▌     | 46/100 [19:22<17:04, 18.98s/it]Running generate_until requests:  47%|████▋     | 47/100 [19:36<15:32, 17.59s/it]Running generate_until requests:  48%|████▊     | 48/100 [19:45<12:47, 14.76s/it]Running generate_until requests:  49%|████▉     | 49/100 [20:15<16:35, 19.51s/it]Running generate_until requests:  50%|█████     | 50/100 [20:46<19:00, 22.81s/it]Running generate_until requests:  51%|█████     | 51/100 [21:16<20:28, 25.08s/it]Running generate_until requests:  52%|█████▏    | 52/100 [21:46<21:18, 26.64s/it]Running generate_until requests:  53%|█████▎    | 53/100 [22:16<21:39, 27.65s/it]Running generate_until requests:  54%|█████▍    | 54/100 [22:46<21:43, 28.33s/it]Running generate_until requests:  55%|█████▌    | 55/100 [23:04<18:45, 25.02s/it]Running generate_until requests:  56%|█████▌    | 56/100 [23:33<19:24, 26.47s/it]Running generate_until requests:  57%|█████▋    | 57/100 [23:49<16:39, 23.23s/it]Running generate_until requests:  58%|█████▊    | 58/100 [24:14<16:37, 23.75s/it]Running generate_until requests:  59%|█████▉    | 59/100 [24:44<17:25, 25.51s/it]Running generate_until requests:  60%|██████    | 60/100 [24:51<13:22, 20.06s/it]Running generate_until requests:  61%|██████    | 61/100 [25:06<11:57, 18.40s/it]Running generate_until requests:  62%|██████▏   | 62/100 [25:35<13:45, 21.72s/it]Running generate_until requests:  63%|██████▎   | 63/100 [26:04<14:47, 23.98s/it]Running generate_until requests:  64%|██████▍   | 64/100 [26:33<15:18, 25.52s/it]Running generate_until requests:  65%|██████▌   | 65/100 [27:03<15:30, 26.60s/it]Running generate_until requests:  66%|██████▌   | 66/100 [27:20<13:36, 24.01s/it]Running generate_until requests:  67%|██████▋   | 67/100 [27:50<14:02, 25.52s/it]Running generate_until requests:  68%|██████▊   | 68/100 [28:03<11:44, 22.01s/it]Running generate_until requests:  69%|██████▉   | 69/100 [28:32<12:25, 24.03s/it]Running generate_until requests:  70%|███████   | 70/100 [29:01<12:43, 25.44s/it]Running generate_until requests:  71%|███████   | 71/100 [29:30<12:45, 26.41s/it]Running generate_until requests:  72%|███████▏  | 72/100 [29:39<09:54, 21.21s/it]Running generate_until requests:  73%|███████▎  | 73/100 [30:07<10:32, 23.41s/it]Running generate_until requests:  74%|███████▍  | 74/100 [30:36<10:47, 24.91s/it]Running generate_until requests:  75%|███████▌  | 75/100 [31:04<10:48, 25.95s/it]Running generate_until requests:  76%|███████▌  | 76/100 [31:18<08:57, 22.40s/it]Running generate_until requests:  77%|███████▋  | 77/100 [31:28<07:07, 18.61s/it]Running generate_until requests:  78%|███████▊  | 78/100 [31:34<05:27, 14.90s/it]Running generate_until requests:  79%|███████▉  | 79/100 [31:48<05:05, 14.55s/it]Running generate_until requests:  80%|████████  | 80/100 [32:16<06:12, 18.60s/it]Running generate_until requests:  81%|████████  | 81/100 [32:44<06:47, 21.44s/it]Running generate_until requests:  82%|████████▏ | 82/100 [33:12<07:00, 23.37s/it]Running generate_until requests:  83%|████████▎ | 83/100 [33:28<05:58, 21.09s/it]Running generate_until requests:  84%|████████▍ | 84/100 [33:55<06:08, 23.03s/it]Running generate_until requests:  85%|████████▌ | 85/100 [34:22<06:04, 24.30s/it]Running generate_until requests:  86%|████████▌ | 86/100 [34:33<04:42, 20.17s/it]Running generate_until requests:  87%|████████▋ | 87/100 [34:41<03:36, 16.63s/it]Running generate_until requests:  88%|████████▊ | 88/100 [34:47<02:40, 13.42s/it]Running generate_until requests:  89%|████████▉ | 89/100 [34:59<02:21, 12.86s/it]Running generate_until requests:  90%|█████████ | 90/100 [35:26<02:50, 17.04s/it]Running generate_until requests:  91%|█████████ | 91/100 [35:52<02:59, 19.93s/it]Running generate_until requests:  92%|█████████▏| 92/100 [36:19<02:54, 21.87s/it]Running generate_until requests:  93%|█████████▎| 93/100 [36:23<01:55, 16.50s/it]Running generate_until requests:  94%|█████████▍| 94/100 [36:38<01:36, 16.13s/it]Running generate_until requests:  95%|█████████▌| 95/100 [37:04<01:35, 19.18s/it]Running generate_until requests:  96%|█████████▌| 96/100 [37:30<01:25, 21.32s/it]Running generate_until requests:  97%|█████████▋| 97/100 [37:57<01:08, 22.81s/it]Running generate_until requests:  98%|█████████▊| 98/100 [38:23<00:47, 23.79s/it]Running generate_until requests:  99%|█████████▉| 99/100 [38:49<00:24, 24.36s/it]Running generate_until requests: 100%|██████████| 100/100 [39:14<00:00, 24.75s/it]Running generate_until requests: 100%|██████████| 100/100 [39:14<00:00, 23.55s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:18:48:19,700 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:18:48:19,711 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:18:49:00,091 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:18:49:11,791 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:18:49:11,792 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:18:49:11,801 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:18:49:11,802 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:18:49:11,802 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:18:49:12,052 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:18:49:12,234 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:18:49:12,698 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.02s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s]
2025-03-20:18:49:21,620 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:18:49:21,623 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.17it/s] 70%|███████   | 70/100 [00:00<00:00, 345.33it/s]100%|██████████| 100/100 [00:00<00:00, 348.24it/s]
2025-03-20:18:49:21,914 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:15, 38.34s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:21, 36.96s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:55, 36.45s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:34, 35.99s/it]Running generate_until requests:   5%|▌         | 5/100 [02:58<55:18, 34.93s/it]Running generate_until requests:   6%|▌         | 6/100 [03:33<54:32, 34.82s/it]Running generate_until requests:   7%|▋         | 7/100 [03:44<41:57, 27.07s/it]Running generate_until requests:   8%|▊         | 8/100 [04:18<44:50, 29.24s/it]Running generate_until requests:   9%|▉         | 9/100 [04:28<35:19, 23.29s/it]Running generate_until requests:  10%|█         | 10/100 [04:41<30:07, 20.08s/it]Running generate_until requests:  11%|█         | 11/100 [05:08<32:56, 22.21s/it]Running generate_until requests:  12%|█▏        | 12/100 [05:38<36:12, 24.68s/it]Running generate_until requests:  13%|█▎        | 13/100 [06:11<39:31, 27.26s/it]Running generate_until requests:  14%|█▍        | 14/100 [06:23<32:16, 22.52s/it]Running generate_until requests:  15%|█▌        | 15/100 [06:56<36:24, 25.71s/it]Running generate_until requests:  16%|█▌        | 16/100 [07:13<32:28, 23.20s/it]Running generate_until requests:  17%|█▋        | 17/100 [07:46<36:04, 26.08s/it]Running generate_until requests:  18%|█▊        | 18/100 [08:18<38:10, 27.94s/it]Running generate_until requests:  19%|█▉        | 19/100 [08:33<32:07, 23.80s/it]Running generate_until requests:  20%|██        | 20/100 [09:00<33:19, 24.99s/it]Running generate_until requests:  21%|██        | 21/100 [09:32<35:43, 27.13s/it]Running generate_until requests:  22%|██▏       | 22/100 [09:54<33:02, 25.42s/it]Running generate_until requests:  23%|██▎       | 23/100 [10:26<35:06, 27.36s/it]Running generate_until requests:  24%|██▍       | 24/100 [10:58<36:21, 28.71s/it]Running generate_until requests:  25%|██▌       | 25/100 [11:29<37:02, 29.63s/it]Running generate_until requests:  26%|██▌       | 26/100 [11:49<32:42, 26.52s/it]Running generate_until requests:  27%|██▋       | 27/100 [11:59<26:12, 21.54s/it]Running generate_until requests:  28%|██▊       | 28/100 [12:13<23:27, 19.54s/it]Running generate_until requests:  29%|██▉       | 29/100 [12:45<27:25, 23.17s/it]Running generate_until requests:  30%|███       | 30/100 [13:17<29:59, 25.71s/it]Running generate_until requests:  31%|███       | 31/100 [13:48<31:33, 27.44s/it]Running generate_until requests:  32%|███▏      | 32/100 [14:20<32:27, 28.64s/it]Running generate_until requests:  33%|███▎      | 33/100 [14:27<25:00, 22.39s/it]Running generate_until requests:  34%|███▍      | 34/100 [14:42<22:10, 20.16s/it]Running generate_until requests:  35%|███▌      | 35/100 [14:52<18:18, 16.90s/it]Running generate_until requests:  36%|███▌      | 36/100 [15:23<22:36, 21.19s/it]Running generate_until requests:  37%|███▋      | 37/100 [15:54<25:23, 24.18s/it]Running generate_until requests:  38%|███▊      | 38/100 [16:11<22:37, 21.89s/it]Running generate_until requests:  39%|███▉      | 39/100 [16:41<24:42, 24.30s/it]Running generate_until requests:  40%|████      | 40/100 [17:12<26:19, 26.32s/it]Running generate_until requests:  41%|████      | 41/100 [17:43<27:15, 27.72s/it]Running generate_until requests:  42%|████▏     | 42/100 [18:13<27:44, 28.69s/it]Running generate_until requests:  43%|████▎     | 43/100 [18:30<23:52, 25.13s/it]Running generate_until requests:  44%|████▍     | 44/100 [18:42<19:36, 21.01s/it]Running generate_until requests:  45%|████▌     | 45/100 [19:13<21:57, 23.96s/it]Running generate_until requests:  46%|████▌     | 46/100 [19:20<17:02, 18.94s/it]Running generate_until requests:  47%|████▋     | 47/100 [19:34<15:30, 17.56s/it]Running generate_until requests:  48%|████▊     | 48/100 [19:42<12:45, 14.73s/it]Running generate_until requests:  49%|████▉     | 49/100 [20:13<16:33, 19.47s/it]Running generate_until requests:  50%|█████     | 50/100 [20:43<18:58, 22.77s/it]Running generate_until requests:  51%|█████     | 51/100 [21:14<20:26, 25.03s/it]Running generate_until requests:  52%|█████▏    | 52/100 [21:44<21:15, 26.58s/it]Running generate_until requests:  53%|█████▎    | 53/100 [22:14<21:36, 27.59s/it]Running generate_until requests:  54%|█████▍    | 54/100 [22:44<21:40, 28.27s/it]Running generate_until requests:  55%|█████▌    | 55/100 [23:01<18:43, 24.97s/it]Running generate_until requests:  56%|█████▌    | 56/100 [23:31<19:22, 26.41s/it]Running generate_until requests:  57%|█████▋    | 57/100 [23:46<16:36, 23.18s/it]Running generate_until requests:  58%|█████▊    | 58/100 [24:11<16:35, 23.70s/it]Running generate_until requests:  59%|█████▉    | 59/100 [24:41<17:23, 25.45s/it]Running generate_until requests:  60%|██████    | 60/100 [24:48<13:20, 20.01s/it]Running generate_until requests:  61%|██████    | 61/100 [25:02<11:56, 18.36s/it]Running generate_until requests:  62%|██████▏   | 62/100 [25:32<13:43, 21.67s/it]Running generate_until requests:  63%|██████▎   | 63/100 [26:01<14:45, 23.92s/it]Running generate_until requests:  64%|██████▍   | 64/100 [26:30<15:16, 25.47s/it]Running generate_until requests:  65%|██████▌   | 65/100 [26:59<15:28, 26.54s/it]Running generate_until requests:  66%|██████▌   | 66/100 [27:17<13:34, 23.96s/it]Running generate_until requests:  67%|██████▋   | 67/100 [27:46<14:00, 25.46s/it]Running generate_until requests:  68%|██████▊   | 68/100 [28:00<11:42, 21.96s/it]Running generate_until requests:  69%|██████▉   | 69/100 [28:29<12:23, 23.98s/it]Running generate_until requests:  70%|███████   | 70/100 [28:57<12:41, 25.38s/it]Running generate_until requests:  71%|███████   | 71/100 [29:26<12:44, 26.35s/it]Running generate_until requests:  72%|███████▏  | 72/100 [29:35<09:52, 21.17s/it]Running generate_until requests:  73%|███████▎  | 73/100 [30:03<10:30, 23.36s/it]Running generate_until requests:  74%|███████▍  | 74/100 [30:32<10:46, 24.86s/it]Running generate_until requests:  75%|███████▌  | 75/100 [31:00<10:47, 25.89s/it]Running generate_until requests:  76%|███████▌  | 76/100 [31:14<08:56, 22.35s/it]Running generate_until requests:  77%|███████▋  | 77/100 [31:24<07:07, 18.57s/it]Running generate_until requests:  78%|███████▊  | 78/100 [31:30<05:27, 14.87s/it]Running generate_until requests:  79%|███████▉  | 79/100 [31:44<05:04, 14.52s/it]Running generate_until requests:  80%|████████  | 80/100 [32:12<06:11, 18.56s/it]Running generate_until requests:  81%|████████  | 81/100 [32:40<06:46, 21.39s/it]Running generate_until requests:  82%|████████▏ | 82/100 [33:08<06:59, 23.31s/it]Running generate_until requests:  83%|████████▎ | 83/100 [33:23<05:57, 21.04s/it]Running generate_until requests:  84%|████████▍ | 84/100 [33:51<06:07, 22.98s/it]Running generate_until requests:  85%|████████▌ | 85/100 [34:18<06:03, 24.25s/it]Running generate_until requests:  86%|████████▌ | 86/100 [34:29<04:41, 20.13s/it]Running generate_until requests:  87%|████████▋ | 87/100 [34:37<03:35, 16.59s/it]Running generate_until requests:  88%|████████▊ | 88/100 [34:43<02:40, 13.38s/it]Running generate_until requests:  89%|████████▉ | 89/100 [34:54<02:21, 12.83s/it]Running generate_until requests:  90%|█████████ | 90/100 [35:21<02:50, 17.00s/it]Running generate_until requests:  91%|█████████ | 91/100 [35:48<02:58, 19.88s/it]Running generate_until requests:  92%|█████████▏| 92/100 [36:14<02:54, 21.82s/it]Running generate_until requests:  93%|█████████▎| 93/100 [36:18<01:55, 16.46s/it]Running generate_until requests:  94%|█████████▍| 94/100 [36:33<01:36, 16.09s/it]Running generate_until requests:  95%|█████████▌| 95/100 [36:59<01:35, 19.13s/it]Running generate_until requests:  96%|█████████▌| 96/100 [37:26<01:25, 21.27s/it]Running generate_until requests:  97%|█████████▋| 97/100 [37:52<01:08, 22.75s/it]Running generate_until requests:  98%|█████████▊| 98/100 [38:18<00:47, 23.73s/it]Running generate_until requests:  99%|█████████▉| 99/100 [38:44<00:24, 24.30s/it]Running generate_until requests: 100%|██████████| 100/100 [39:09<00:00, 24.68s/it]Running generate_until requests: 100%|██████████| 100/100 [39:09<00:00, 23.50s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:19:28:36,940 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:19:28:36,958 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:19:29:17,371 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:19:29:29,077 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:19:29:29,079 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:19:29:29,088 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:19:29:29,089 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:19:29:29,089 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:19:29:29,335 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:19:29:29,508 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:19:29:29,974 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.20s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.02s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.39it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s]
2025-03-20:19:29:38,977 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:19:29:38,980 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 342.58it/s] 70%|███████   | 70/100 [00:00<00:00, 345.85it/s]100%|██████████| 100/100 [00:00<00:00, 346.39it/s]
2025-03-20:19:29:39,272 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:06, 38.24s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:21, 36.95s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:57, 36.47s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:38, 36.02s/it]Running generate_until requests:   5%|▌         | 5/100 [02:58<55:22, 34.97s/it]Running generate_until requests:   6%|▌         | 6/100 [03:33<54:37, 34.87s/it]Running generate_until requests:   7%|▋         | 7/100 [03:44<42:01, 27.11s/it]Running generate_until requests:   8%|▊         | 8/100 [04:18<44:54, 29.29s/it]Running generate_until requests:   9%|▉         | 9/100 [04:28<35:22, 23.33s/it]Running generate_until requests:  10%|█         | 10/100 [04:41<30:10, 20.11s/it]Running generate_until requests:  11%|█         | 11/100 [05:08<32:59, 22.24s/it]Running generate_until requests:  12%|█▏        | 12/100 [05:38<36:15, 24.72s/it]Running generate_until requests:  13%|█▎        | 13/100 [06:12<39:35, 27.30s/it]Running generate_until requests:  14%|█▍        | 14/100 [06:23<32:19, 22.55s/it]Running generate_until requests:  15%|█▌        | 15/100 [06:56<36:28, 25.75s/it]Running generate_until requests:  16%|█▌        | 16/100 [07:14<32:32, 23.24s/it]Running generate_until requests:  17%|█▋        | 17/100 [07:47<36:08, 26.13s/it]Running generate_until requests:  18%|█▊        | 18/100 [08:19<38:14, 27.99s/it]Running generate_until requests:  19%|█▉        | 19/100 [08:33<32:11, 23.84s/it]Running generate_until requests:  20%|██        | 20/100 [09:01<33:22, 25.04s/it]Running generate_until requests:  21%|██        | 21/100 [09:33<35:47, 27.18s/it]Running generate_until requests:  22%|██▏       | 22/100 [09:55<33:06, 25.46s/it]Running generate_until requests:  23%|██▎       | 23/100 [10:27<35:10, 27.41s/it]Running generate_until requests:  24%|██▍       | 24/100 [10:59<36:25, 28.76s/it]Running generate_until requests:  25%|██▌       | 25/100 [11:30<37:06, 29.69s/it]Running generate_until requests:  26%|██▌       | 26/100 [11:50<32:46, 26.57s/it]Running generate_until requests:  27%|██▋       | 27/100 [12:00<26:15, 21.58s/it]Running generate_until requests:  28%|██▊       | 28/100 [12:15<23:29, 19.58s/it]Running generate_until requests:  29%|██▉       | 29/100 [12:46<27:28, 23.21s/it]Running generate_until requests:  30%|███       | 30/100 [13:18<30:02, 25.75s/it]Running generate_until requests:  31%|███       | 31/100 [13:49<31:36, 27.49s/it]Running generate_until requests:  32%|███▏      | 32/100 [14:21<32:30, 28.69s/it]Running generate_until requests:  33%|███▎      | 33/100 [14:29<25:02, 22.43s/it]Running generate_until requests:  34%|███▍      | 34/100 [14:44<22:12, 20.20s/it]Running generate_until requests:  35%|███▌      | 35/100 [14:53<18:20, 16.93s/it]Running generate_until requests:  36%|███▌      | 36/100 [15:24<22:38, 21.23s/it]Running generate_until requests:  37%|███▋      | 37/100 [15:56<25:25, 24.22s/it]Running generate_until requests:  38%|███▊      | 38/100 [16:12<22:39, 21.93s/it]Running generate_until requests:  39%|███▉      | 39/100 [16:42<24:44, 24.34s/it]Running generate_until requests:  40%|████      | 40/100 [17:13<26:21, 26.36s/it]Running generate_until requests:  41%|████      | 41/100 [17:44<27:18, 27.77s/it]Running generate_until requests:  42%|████▏     | 42/100 [18:15<27:47, 28.74s/it]Running generate_until requests:  43%|████▎     | 43/100 [18:32<23:55, 25.18s/it]Running generate_until requests:  44%|████▍     | 44/100 [18:44<19:38, 21.05s/it]Running generate_until requests:  45%|████▌     | 45/100 [19:14<22:00, 24.01s/it]Running generate_until requests:  46%|████▌     | 46/100 [19:22<17:04, 18.97s/it]Running generate_until requests:  47%|████▋     | 47/100 [19:36<15:32, 17.59s/it]Running generate_until requests:  48%|████▊     | 48/100 [19:44<12:47, 14.75s/it]Running generate_until requests:  49%|████▉     | 49/100 [20:15<16:34, 19.51s/it]Running generate_until requests:  50%|█████     | 50/100 [20:45<19:00, 22.81s/it]Running generate_until requests:  51%|█████     | 51/100 [21:16<20:28, 25.07s/it]Running generate_until requests:  52%|█████▏    | 52/100 [21:46<21:18, 26.63s/it]Running generate_until requests:  53%|█████▎    | 53/100 [22:16<21:39, 27.64s/it]Running generate_until requests:  54%|█████▍    | 54/100 [22:46<21:42, 28.33s/it]Running generate_until requests:  55%|█████▌    | 55/100 [23:03<18:45, 25.02s/it]Running generate_until requests:  56%|█████▌    | 56/100 [23:33<19:24, 26.46s/it]Running generate_until requests:  57%|█████▋    | 57/100 [23:49<16:38, 23.23s/it]Running generate_until requests:  58%|█████▊    | 58/100 [24:14<16:37, 23.74s/it]Running generate_until requests:  59%|█████▉    | 59/100 [24:43<17:25, 25.50s/it]Running generate_until requests:  60%|██████    | 60/100 [24:50<13:22, 20.05s/it]Running generate_until requests:  61%|██████    | 61/100 [25:05<11:57, 18.40s/it]Running generate_until requests:  62%|██████▏   | 62/100 [25:34<13:45, 21.72s/it]Running generate_until requests:  63%|██████▎   | 63/100 [26:04<14:46, 23.97s/it]Running generate_until requests:  64%|██████▍   | 64/100 [26:33<15:18, 25.52s/it]Running generate_until requests:  65%|██████▌   | 65/100 [27:02<15:30, 26.59s/it]Running generate_until requests:  66%|██████▌   | 66/100 [27:20<13:36, 24.01s/it]Running generate_until requests:  67%|██████▋   | 67/100 [27:49<14:01, 25.51s/it]Running generate_until requests:  68%|██████▊   | 68/100 [28:03<11:44, 22.00s/it]Running generate_until requests:  69%|██████▉   | 69/100 [28:32<12:24, 24.03s/it]Running generate_until requests:  70%|███████   | 70/100 [29:00<12:42, 25.43s/it]Running generate_until requests:  71%|███████   | 71/100 [29:29<12:45, 26.40s/it]Running generate_until requests:  72%|███████▏  | 72/100 [29:38<09:53, 21.21s/it]Running generate_until requests:  73%|███████▎  | 73/100 [30:07<10:31, 23.40s/it]Running generate_until requests:  74%|███████▍  | 74/100 [30:35<10:47, 24.90s/it]Running generate_until requests:  75%|███████▌  | 75/100 [31:03<10:48, 25.94s/it]Running generate_until requests:  76%|███████▌  | 76/100 [31:17<08:57, 22.40s/it]Running generate_until requests:  77%|███████▋  | 77/100 [31:27<07:07, 18.60s/it]Running generate_until requests:  78%|███████▊  | 78/100 [31:33<05:27, 14.90s/it]Running generate_until requests:  79%|███████▉  | 79/100 [31:47<05:05, 14.55s/it]Running generate_until requests:  80%|████████  | 80/100 [32:15<06:12, 18.60s/it]Running generate_until requests:  81%|████████  | 81/100 [32:43<06:47, 21.44s/it]Running generate_until requests:  82%|████████▏ | 82/100 [33:11<07:00, 23.36s/it]Running generate_until requests:  83%|████████▎ | 83/100 [33:27<05:58, 21.09s/it]Running generate_until requests:  84%|████████▍ | 84/100 [33:54<06:08, 23.03s/it]Running generate_until requests:  85%|████████▌ | 85/100 [34:22<06:04, 24.29s/it]Running generate_until requests:  86%|████████▌ | 86/100 [34:32<04:42, 20.17s/it]Running generate_until requests:  87%|████████▋ | 87/100 [34:41<03:36, 16.62s/it]Running generate_until requests:  88%|████████▊ | 88/100 [34:46<02:40, 13.41s/it]Running generate_until requests:  89%|████████▉ | 89/100 [34:58<02:21, 12.85s/it]Running generate_until requests:  90%|█████████ | 90/100 [35:25<02:50, 17.04s/it]Running generate_until requests:  91%|█████████ | 91/100 [35:51<02:59, 19.92s/it]Running generate_until requests:  92%|█████████▏| 92/100 [36:18<02:54, 21.87s/it]Running generate_until requests:  93%|█████████▎| 93/100 [36:22<01:55, 16.50s/it]Running generate_until requests:  94%|█████████▍| 94/100 [36:37<01:36, 16.12s/it]Running generate_until requests:  95%|█████████▌| 95/100 [37:03<01:35, 19.17s/it]Running generate_until requests:  96%|█████████▌| 96/100 [37:30<01:25, 21.31s/it]Running generate_until requests:  97%|█████████▋| 97/100 [37:56<01:08, 22.80s/it]Running generate_until requests:  98%|█████████▊| 98/100 [38:22<00:47, 23.78s/it]Running generate_until requests:  99%|█████████▉| 99/100 [38:48<00:24, 24.36s/it]Running generate_until requests: 100%|██████████| 100/100 [39:13<00:00, 24.74s/it]Running generate_until requests: 100%|██████████| 100/100 [39:13<00:00, 23.54s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:20:08:58,398 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:20:08:58,403 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:20:10:48,701 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:20:11:00,175 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:20:11:00,176 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:20:11:00,187 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:20:11:00,187 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:20:11:00,188 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:20:11:00,437 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:20:11:00,630 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:20:11:01,169 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.20s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.02s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.42it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:20:11:09,883 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:20:11:09,886 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 338.77it/s] 69%|██████▉   | 69/100 [00:00<00:00, 343.28it/s]100%|██████████| 100/100 [00:00<00:00, 343.16it/s]
2025-03-20:20:11:10,181 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:02:50, 38.08s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:14, 36.89s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:54, 36.44s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:36, 36.01s/it]Running generate_until requests:   5%|▌         | 5/100 [03:00<56:16, 35.54s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:12, 35.24s/it]Running generate_until requests:   7%|▋         | 7/100 [04:09<54:17, 35.02s/it]Running generate_until requests:   8%|▊         | 8/100 [04:43<53:11, 34.69s/it]Running generate_until requests:   9%|▉         | 9/100 [05:17<52:10, 34.40s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:18, 34.20s/it]Running generate_until requests:  11%|█         | 11/100 [06:24<50:27, 34.02s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:57<49:35, 33.81s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:31<48:46, 33.64s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:04<48:02, 33.52s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:37<47:20, 33.41s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:10<46:39, 33.33s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:43<45:54, 33.19s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:15<44:59, 32.92s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:48<44:11, 32.73s/it]Running generate_until requests:  20%|██        | 20/100 [11:20<43:27, 32.59s/it]Running generate_until requests:  21%|██        | 21/100 [11:52<42:45, 32.47s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:24<42:05, 32.38s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:56<41:23, 32.25s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:28<40:43, 32.15s/it]Running generate_until requests:  25%|██▌       | 25/100 [14:00<40:04, 32.06s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:32<39:25, 31.97s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:03<38:48, 31.90s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:35<38:12, 31.84s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:55<33:28, 28.29s/it]Running generate_until requests:  30%|███       | 30/100 [16:27<34:11, 29.31s/it]Running generate_until requests:  31%|███       | 31/100 [16:58<34:28, 29.98s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:30<34:29, 30.44s/it]Running generate_until requests:  33%|███▎      | 33/100 [18:01<34:18, 30.73s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:26<31:54, 29.00s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:57<32:09, 29.69s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:29<32:10, 30.16s/it]Running generate_until requests:  37%|███▋      | 37/100 [20:00<31:59, 30.47s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:31<31:42, 30.69s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:02<31:20, 30.83s/it]Running generate_until requests:  40%|████      | 40/100 [21:33<30:54, 30.90s/it]Running generate_until requests:  41%|████      | 41/100 [22:04<30:25, 30.95s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:35<29:56, 30.97s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:06<29:25, 30.97s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:37<28:53, 30.95s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:46<22:14, 24.26s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:17<23:36, 26.23s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:48<24:23, 27.62s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:18<24:45, 28.57s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:49<24:48, 29.18s/it]Running generate_until requests:  50%|█████     | 50/100 [26:20<24:39, 29.58s/it]Running generate_until requests:  51%|█████     | 51/100 [26:50<24:20, 29.82s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:20<23:57, 29.95s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:50<23:28, 29.97s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:20<22:58, 29.96s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:50<22:27, 29.94s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:20<21:56, 29.91s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:50<21:23, 29.86s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:19<20:51, 29.80s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:49<20:19, 29.74s/it]Running generate_until requests:  60%|██████    | 60/100 [31:10<18:03, 27.08s/it]Running generate_until requests:  61%|██████    | 61/100 [31:39<18:05, 27.82s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:09<17:55, 28.32s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:38<17:37, 28.59s/it]Running generate_until requests:  64%|██████▍   | 64/100 [32:59<15:45, 26.26s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:28<15:48, 27.11s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:57<15:41, 27.71s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:26<15:27, 28.10s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:55<15:06, 28.31s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:24<14:41, 28.45s/it]Running generate_until requests:  70%|███████   | 70/100 [35:52<14:15, 28.53s/it]Running generate_until requests:  71%|███████   | 71/100 [36:21<13:48, 28.58s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:50<13:19, 28.56s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:06<11:09, 24.80s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:22<09:37, 22.21s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:50<10:01, 24.06s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:18<10:08, 25.34s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:47<10:03, 26.23s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:15<09:50, 26.83s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:43<09:32, 27.24s/it]Running generate_until requests:  80%|████████  | 80/100 [40:11<09:09, 27.49s/it]Running generate_until requests:  81%|████████  | 81/100 [40:39<08:45, 27.66s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:07<08:18, 27.72s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:35<07:51, 27.73s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:02<07:22, 27.68s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:30<06:53, 27.55s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:57<06:23, 27.42s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:16<05:24, 24.97s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:23<03:53, 19.49s/it]Running generate_until requests:  89%|████████▉ | 89/100 [43:50<03:58, 21.69s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:16<03:52, 23.23s/it]Running generate_until requests:  91%|█████████ | 91/100 [44:43<03:38, 24.26s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:10<03:19, 24.90s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:36<02:57, 25.35s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:02<02:33, 25.64s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:29<02:09, 25.84s/it]Running generate_until requests:  96%|█████████▌| 96/100 [46:33<01:18, 19.56s/it]Running generate_until requests:  97%|█████████▋| 97/100 [46:42<00:48, 16.25s/it]Running generate_until requests:  98%|█████████▊| 98/100 [47:08<00:38, 19.20s/it]Running generate_until requests:  99%|█████████▉| 99/100 [47:34<00:21, 21.15s/it]Running generate_until requests: 100%|██████████| 100/100 [47:59<00:00, 22.50s/it]Running generate_until requests: 100%|██████████| 100/100 [47:59<00:00, 28.80s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:20:59:16,410 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:20:59:16,422 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:20:59:57,262 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:21:00:09,169 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:21:00:09,171 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:21:00:09,180 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:21:00:09,181 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:21:00:09,181 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:21:00:09,428 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:21:00:09,607 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:21:00:10,078 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.21s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.03s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s]
2025-03-20:21:00:18,692 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:21:00:18,695 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.19it/s] 71%|███████   | 71/100 [00:00<00:00, 353.03it/s]100%|██████████| 100/100 [00:00<00:00, 353.80it/s]
2025-03-20:21:00:18,981 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:02:58, 38.16s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:13, 36.87s/it]Running generate_until requests:   3%|▎         | 3/100 [01:49<58:50, 36.40s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:31, 35.95s/it]Running generate_until requests:   5%|▌         | 5/100 [02:59<56:10, 35.48s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:06, 35.18s/it]Running generate_until requests:   7%|▋         | 7/100 [04:08<54:10, 34.95s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<53:04, 34.61s/it]Running generate_until requests:   9%|▉         | 9/100 [05:16<52:03, 34.33s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:11, 34.13s/it]Running generate_until requests:  11%|█         | 11/100 [06:23<50:21, 33.95s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:57<49:28, 33.73s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:30<48:40, 33.57s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:03<47:56, 33.45s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:36<47:13, 33.34s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:09<46:33, 33.25s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:42<45:48, 33.11s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:14<44:53, 32.85s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:46<44:05, 32.66s/it]Running generate_until requests:  20%|██        | 20/100 [11:18<43:21, 32.51s/it]Running generate_until requests:  21%|██        | 21/100 [11:51<42:39, 32.39s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:23<41:59, 32.30s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:54<41:17, 32.18s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:26<40:37, 32.07s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:58<39:58, 31.99s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:30<39:20, 31.90s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:01<38:42, 31.82s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:33<38:06, 31.76s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:53<33:23, 28.22s/it]Running generate_until requests:  30%|███       | 30/100 [16:25<34:06, 29.24s/it]Running generate_until requests:  31%|███       | 31/100 [16:56<34:23, 29.91s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:28<34:24, 30.36s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:59<34:13, 30.65s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:24<31:49, 28.93s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:55<32:05, 29.62s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:26<32:05, 30.08s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:57<31:55, 30.40s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:28<31:38, 30.61s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:59<31:15, 30.75s/it]Running generate_until requests:  40%|████      | 40/100 [21:30<30:49, 30.83s/it]Running generate_until requests:  41%|████      | 41/100 [22:01<30:21, 30.87s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:32<29:51, 30.89s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:03<29:21, 30.90s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:34<28:49, 30.88s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:43<22:10, 24.20s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:14<23:33, 26.17s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:44<24:19, 27.55s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:15<24:41, 28.50s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:46<24:44, 29.10s/it]Running generate_until requests:  50%|█████     | 50/100 [26:16<24:35, 29.51s/it]Running generate_until requests:  51%|█████     | 51/100 [26:46<24:17, 29.74s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:16<23:54, 29.88s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:46<23:24, 29.89s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:16<22:54, 29.88s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:46<22:23, 29.86s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:16<21:52, 29.84s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:45<21:20, 29.78s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:15<20:48, 29.72s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:45<20:16, 29.66s/it]Running generate_until requests:  60%|██████    | 60/100 [31:05<18:00, 27.01s/it]Running generate_until requests:  61%|██████    | 61/100 [31:35<18:02, 27.75s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:04<17:53, 28.24s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:33<17:35, 28.52s/it]Running generate_until requests:  64%|██████▍   | 64/100 [32:54<15:42, 26.19s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:23<15:46, 27.04s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:52<15:39, 27.63s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:21<15:24, 28.03s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:50<15:03, 28.24s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:19<14:39, 28.37s/it]Running generate_until requests:  70%|███████   | 70/100 [35:47<14:13, 28.45s/it]Running generate_until requests:  71%|███████   | 71/100 [36:16<13:46, 28.50s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:44<13:17, 28.49s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:00<11:07, 24.73s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:16<09:36, 22.15s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:45<09:59, 24.00s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:13<10:06, 25.27s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:41<10:01, 26.15s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:09<09:48, 26.76s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:37<09:30, 27.17s/it]Running generate_until requests:  80%|████████  | 80/100 [40:05<09:08, 27.41s/it]Running generate_until requests:  81%|████████  | 81/100 [40:33<08:44, 27.58s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:01<08:17, 27.64s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:29<07:50, 27.65s/it]Running generate_until requests:  84%|████████▍ | 84/100 [41:56<07:21, 27.60s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:24<06:52, 27.48s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:51<06:22, 27.35s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:10<05:23, 24.90s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:17<03:53, 19.44s/it]Running generate_until requests:  89%|████████▉ | 89/100 [43:43<03:57, 21.63s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:10<03:51, 23.16s/it]Running generate_until requests:  91%|█████████ | 91/100 [44:37<03:37, 24.18s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:03<03:18, 24.83s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:29<02:56, 25.28s/it]Running generate_until requests:  94%|█████████▍| 94/100 [45:55<02:33, 25.57s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:22<02:08, 25.77s/it]Running generate_until requests:  96%|█████████▌| 96/100 [46:27<01:18, 19.51s/it]Running generate_until requests:  97%|█████████▋| 97/100 [46:35<00:48, 16.20s/it]Running generate_until requests:  98%|█████████▊| 98/100 [47:01<00:38, 19.14s/it]Running generate_until requests:  99%|█████████▉| 99/100 [47:27<00:21, 21.09s/it]Running generate_until requests: 100%|██████████| 100/100 [47:52<00:00, 22.43s/it]Running generate_until requests: 100%|██████████| 100/100 [47:52<00:00, 28.73s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:21:48:17,040 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:21:48:17,044 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:21:48:57,501 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:21:49:08,929 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:21:49:08,931 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:21:49:08,952 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:21:49:08,953 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:21:49:08,953 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:21:49:09,205 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:21:49:09,394 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:21:49:09,863 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.20s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.03s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.42it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:21:49:18,399 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:21:49:18,402 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 342.96it/s] 71%|███████   | 71/100 [00:00<00:00, 347.88it/s]100%|██████████| 100/100 [00:00<00:00, 345.24it/s]
2025-03-20:21:49:18,696 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:03, 38.22s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:22, 36.96s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:59, 36.49s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:41, 36.05s/it]Running generate_until requests:   5%|▌         | 5/100 [03:00<56:20, 35.58s/it]Running generate_until requests:   6%|▌         | 6/100 [03:35<55:16, 35.28s/it]Running generate_until requests:   7%|▋         | 7/100 [04:09<54:20, 35.06s/it]Running generate_until requests:   8%|▊         | 8/100 [04:43<53:13, 34.72s/it]Running generate_until requests:   9%|▉         | 9/100 [05:17<52:13, 34.43s/it]Running generate_until requests:  10%|█         | 10/100 [05:51<51:20, 34.23s/it]Running generate_until requests:  11%|█         | 11/100 [06:24<50:30, 34.05s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:58<49:37, 33.84s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:31<48:49, 33.67s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:04<48:05, 33.55s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:37<47:22, 33.44s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:11<46:42, 33.36s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:44<45:56, 33.22s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:16<45:02, 32.95s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:48<44:13, 32.76s/it]Running generate_until requests:  20%|██        | 20/100 [11:20<43:29, 32.62s/it]Running generate_until requests:  21%|██        | 21/100 [11:53<42:47, 32.50s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:25<42:07, 32.41s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:57<41:25, 32.28s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:29<40:45, 32.18s/it]Running generate_until requests:  25%|██▌       | 25/100 [14:01<40:07, 32.09s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:33<39:28, 32.00s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:04<38:50, 31.93s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:36<38:14, 31.87s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:56<33:30, 28.32s/it]Running generate_until requests:  30%|███       | 30/100 [16:28<34:13, 29.34s/it]Running generate_until requests:  31%|███       | 31/100 [16:59<34:30, 30.01s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:31<34:31, 30.46s/it]Running generate_until requests:  33%|███▎      | 33/100 [18:02<34:20, 30.76s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:27<31:56, 29.03s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:59<32:11, 29.72s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:30<32:12, 30.19s/it]Running generate_until requests:  37%|███▋      | 37/100 [20:01<32:01, 30.50s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:32<31:44, 30.72s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:04<31:22, 30.86s/it]Running generate_until requests:  40%|████      | 40/100 [21:35<30:56, 30.93s/it]Running generate_until requests:  41%|████      | 41/100 [22:06<30:27, 30.98s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:37<29:58, 31.00s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:08<29:27, 31.01s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:39<28:55, 30.98s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:47<22:15, 24.28s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:18<23:37, 26.26s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:49<24:25, 27.64s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:20<24:47, 28.60s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:51<24:49, 29.21s/it]Running generate_until requests:  50%|█████     | 50/100 [26:21<24:40, 29.61s/it]Running generate_until requests:  51%|█████     | 51/100 [26:52<24:22, 29.85s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:22<23:59, 29.98s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:52<23:29, 30.00s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:22<22:59, 29.99s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:52<22:28, 29.97s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:22<21:57, 29.94s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:51<21:25, 29.89s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:21<20:52, 29.83s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:51<20:20, 29.77s/it]Running generate_until requests:  60%|██████    | 60/100 [31:12<18:04, 27.11s/it]Running generate_until requests:  61%|██████    | 61/100 [31:41<18:06, 27.85s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:11<17:57, 28.34s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:40<17:39, 28.62s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:01<15:46, 26.29s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:30<15:50, 27.14s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:59<15:43, 27.74s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:28<15:28, 28.13s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:57<15:07, 28.34s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:26<14:42, 28.48s/it]Running generate_until requests:  70%|███████   | 70/100 [35:55<14:16, 28.56s/it]Running generate_until requests:  71%|███████   | 71/100 [36:23<13:49, 28.61s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:52<13:20, 28.59s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:08<11:10, 24.83s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:24<09:38, 22.24s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:52<10:02, 24.09s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:21<10:08, 25.37s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:49<10:03, 26.25s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:17<09:50, 26.86s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:46<09:32, 27.27s/it]Running generate_until requests:  80%|████████  | 80/100 [40:14<09:10, 27.52s/it]Running generate_until requests:  81%|████████  | 81/100 [40:42<08:46, 27.69s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:10<08:19, 27.75s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:37<07:51, 27.76s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:05<07:23, 27.71s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:32<06:53, 27.58s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:59<06:24, 27.45s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:19<05:24, 25.00s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:25<03:54, 19.52s/it]Running generate_until requests:  89%|████████▉ | 89/100 [43:52<03:58, 21.72s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:19<03:52, 23.25s/it]Running generate_until requests:  91%|█████████ | 91/100 [44:46<03:38, 24.28s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:12<03:19, 24.93s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:39<02:57, 25.38s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:05<02:34, 25.67s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:31<02:09, 25.87s/it]Running generate_until requests:  96%|█████████▌| 96/100 [46:36<01:18, 19.59s/it]Running generate_until requests:  97%|█████████▋| 97/100 [46:45<00:48, 16.27s/it]Running generate_until requests:  98%|█████████▊| 98/100 [47:11<00:38, 19.22s/it]Running generate_until requests:  99%|█████████▉| 99/100 [47:37<00:21, 21.17s/it]Running generate_until requests: 100%|██████████| 100/100 [48:02<00:00, 22.52s/it]Running generate_until requests: 100%|██████████| 100/100 [48:02<00:00, 28.83s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:22:37:26,800 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:22:37:26,805 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:22:38:07,392 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:22:38:19,416 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:22:38:19,418 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:22:38:19,428 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:22:38:19,428 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:22:38:19,429 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:22:38:19,666 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:22:38:19,837 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:22:38:20,299 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.03s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.05it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.39it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-20:22:38:28,717 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:22:38:28,719 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.81it/s] 71%|███████   | 71/100 [00:00<00:00, 353.22it/s]100%|██████████| 100/100 [00:00<00:00, 346.23it/s]
2025-03-20:22:38:29,011 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:09, 38.27s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:23, 36.97s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:59, 36.49s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:40, 36.04s/it]Running generate_until requests:   5%|▌         | 5/100 [03:00<56:18, 35.57s/it]Running generate_until requests:   6%|▌         | 6/100 [03:35<55:14, 35.26s/it]Running generate_until requests:   7%|▋         | 7/100 [04:09<54:18, 35.04s/it]Running generate_until requests:   8%|▊         | 8/100 [04:43<53:12, 34.70s/it]Running generate_until requests:   9%|▉         | 9/100 [05:17<52:11, 34.41s/it]Running generate_until requests:  10%|█         | 10/100 [05:51<51:19, 34.21s/it]Running generate_until requests:  11%|█         | 11/100 [06:24<50:28, 34.03s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:58<49:36, 33.82s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:31<48:47, 33.65s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:04<48:03, 33.53s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:37<47:20, 33.42s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:10<46:40, 33.34s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:43<45:55, 33.19s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:16<45:00, 32.93s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:48<44:12, 32.74s/it]Running generate_until requests:  20%|██        | 20/100 [11:20<43:27, 32.60s/it]Running generate_until requests:  21%|██        | 21/100 [11:52<42:45, 32.48s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:25<42:06, 32.39s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:56<41:24, 32.26s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:28<40:44, 32.16s/it]Running generate_until requests:  25%|██▌       | 25/100 [14:00<40:05, 32.07s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:32<39:26, 31.99s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:04<38:49, 31.91s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:35<38:13, 31.85s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:56<33:29, 28.30s/it]Running generate_until requests:  30%|███       | 30/100 [16:27<34:12, 29.32s/it]Running generate_until requests:  31%|███       | 31/100 [16:59<34:29, 29.99s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:30<34:30, 30.45s/it]Running generate_until requests:  33%|███▎      | 33/100 [18:02<34:19, 30.74s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:27<31:54, 29.01s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:58<32:10, 29.70s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:29<32:10, 30.17s/it]Running generate_until requests:  37%|███▋      | 37/100 [20:00<32:00, 30.49s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:32<31:43, 30.70s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:03<31:21, 30.84s/it]Running generate_until requests:  40%|████      | 40/100 [21:34<30:54, 30.92s/it]Running generate_until requests:  41%|████      | 41/100 [22:05<30:26, 30.96s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:36<29:56, 30.98s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:07<29:26, 30.99s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:38<28:53, 30.96s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:47<22:14, 24.26s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:17<23:36, 26.24s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:48<24:24, 27.62s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:19<24:46, 28.58s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:50<24:48, 29.19s/it]Running generate_until requests:  50%|█████     | 50/100 [26:20<24:39, 29.59s/it]Running generate_until requests:  51%|█████     | 51/100 [26:51<24:21, 29.82s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:21<23:58, 29.96s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:51<23:28, 29.98s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:21<22:58, 29.97s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:51<22:27, 29.95s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:21<21:56, 29.92s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:50<21:24, 29.87s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:20<20:52, 29.81s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:50<20:19, 29.75s/it]Running generate_until requests:  60%|██████    | 60/100 [31:11<18:03, 27.09s/it]Running generate_until requests:  61%|██████    | 61/100 [31:40<18:05, 27.83s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:10<17:56, 28.32s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:39<17:38, 28.60s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:00<15:45, 26.26s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:29<15:49, 27.12s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:58<15:42, 27.72s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:27<15:27, 28.11s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:56<15:06, 28.32s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:24<14:42, 28.46s/it]Running generate_until requests:  70%|███████   | 70/100 [35:53<14:16, 28.54s/it]Running generate_until requests:  71%|███████   | 71/100 [36:22<13:48, 28.58s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:50<13:20, 28.57s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:06<11:09, 24.81s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:23<09:37, 22.22s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:51<10:01, 24.07s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:19<10:08, 25.35s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:48<10:03, 26.23s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:16<09:50, 26.84s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:44<09:32, 27.25s/it]Running generate_until requests:  80%|████████  | 80/100 [40:12<09:09, 27.50s/it]Running generate_until requests:  81%|████████  | 81/100 [40:40<08:45, 27.67s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:08<08:19, 27.73s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:36<07:51, 27.74s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:03<07:23, 27.69s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:31<06:53, 27.56s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:58<06:24, 27.43s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:17<05:24, 24.98s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:24<03:54, 19.50s/it]Running generate_until requests:  89%|████████▉ | 89/100 [43:51<03:58, 21.70s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:17<03:52, 23.23s/it]Running generate_until requests:  91%|█████████ | 91/100 [44:44<03:38, 24.26s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:11<03:19, 24.91s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:37<02:57, 25.36s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:03<02:33, 25.65s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:30<02:09, 25.85s/it]Running generate_until requests:  96%|█████████▌| 96/100 [46:35<01:18, 19.57s/it]Running generate_until requests:  97%|█████████▋| 97/100 [46:43<00:48, 16.26s/it]Running generate_until requests:  98%|█████████▊| 98/100 [47:09<00:38, 19.20s/it]Running generate_until requests:  99%|█████████▉| 99/100 [47:35<00:21, 21.16s/it]Running generate_until requests: 100%|██████████| 100/100 [48:01<00:00, 22.50s/it]Running generate_until requests: 100%|██████████| 100/100 [48:01<00:00, 28.81s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-20:23:26:35,252 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-20:23:26:35,274 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-20:23:27:15,813 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-20:23:27:27,672 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-20:23:27:27,673 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-20:23:27:27,683 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-20:23:27:27,684 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-20:23:27:27,684 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-20:23:27:27,923 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-20:23:27:28,090 INFO     [huggingface.py:481] Using model type 'default'
2025-03-20:23:27:28,558 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.04s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s]
2025-03-20:23:27:36,898 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-20:23:27:36,901 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 345.44it/s] 71%|███████   | 71/100 [00:00<00:00, 349.32it/s]100%|██████████| 100/100 [00:00<00:00, 349.88it/s]
2025-03-20:23:27:37,191 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:02:58, 38.17s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:14, 36.89s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:52, 36.41s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:33, 35.97s/it]Running generate_until requests:   5%|▌         | 5/100 [02:59<56:12, 35.50s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:08, 35.19s/it]Running generate_until requests:   7%|▋         | 7/100 [04:09<54:12, 34.97s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<53:06, 34.63s/it]Running generate_until requests:   9%|▉         | 9/100 [05:16<52:05, 34.35s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:13, 34.15s/it]Running generate_until requests:  11%|█         | 11/100 [06:23<50:23, 33.97s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:57<49:30, 33.75s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:30<48:42, 33.59s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:03<47:58, 33.47s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:36<47:15, 33.36s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:09<46:34, 33.27s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:42<45:49, 33.13s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:14<44:54, 32.87s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:47<44:06, 32.68s/it]Running generate_until requests:  20%|██        | 20/100 [11:19<43:22, 32.53s/it]Running generate_until requests:  21%|██        | 21/100 [11:51<42:40, 32.41s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:23<42:00, 32.32s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:55<41:19, 32.20s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:27<40:38, 32.09s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:59<40:00, 32.01s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:30<39:21, 31.92s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:02<38:44, 31.84s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:34<38:08, 31.78s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:54<33:25, 28.24s/it]Running generate_until requests:  30%|███       | 30/100 [16:25<34:07, 29.26s/it]Running generate_until requests:  31%|███       | 31/100 [16:57<34:25, 29.93s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:28<34:25, 30.38s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:59<34:15, 30.68s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:24<31:50, 28.95s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:56<32:06, 29.64s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:27<32:06, 30.11s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:58<31:56, 30.42s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:29<31:39, 30.63s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:00<31:17, 30.77s/it]Running generate_until requests:  40%|████      | 40/100 [21:31<30:51, 30.85s/it]Running generate_until requests:  41%|████      | 41/100 [22:02<30:22, 30.89s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:33<29:53, 30.92s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:04<29:22, 30.92s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:35<28:50, 30.90s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:44<22:11, 24.21s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:14<23:33, 26.18s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:45<24:20, 27.57s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:16<24:43, 28.52s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:46<24:45, 29.13s/it]Running generate_until requests:  50%|█████     | 50/100 [26:17<24:36, 29.53s/it]Running generate_until requests:  51%|█████     | 51/100 [26:47<24:18, 29.76s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:17<23:55, 29.90s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:47<23:25, 29.91s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:17<22:55, 29.90s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:47<22:24, 29.88s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:17<21:53, 29.86s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:47<21:21, 29.80s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:16<20:49, 29.74s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:46<20:17, 29.69s/it]Running generate_until requests:  60%|██████    | 60/100 [31:07<18:01, 27.03s/it]Running generate_until requests:  61%|██████    | 61/100 [31:36<18:02, 27.77s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:05<17:53, 28.26s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:35<17:35, 28.54s/it]Running generate_until requests:  64%|██████▍   | 64/100 [32:55<15:43, 26.21s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:25<15:47, 27.06s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:54<15:40, 27.65s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:23<15:25, 28.05s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:51<15:04, 28.26s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:20<14:40, 28.39s/it]Running generate_until requests:  70%|███████   | 70/100 [35:49<14:14, 28.47s/it]Running generate_until requests:  71%|███████   | 71/100 [36:17<13:47, 28.52s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:46<13:18, 28.51s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:02<11:08, 24.75s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:18<09:36, 22.17s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:46<10:00, 24.01s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:14<10:07, 25.29s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:43<10:02, 26.18s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:11<09:49, 26.78s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:39<09:31, 27.19s/it]Running generate_until requests:  80%|████████  | 80/100 [40:07<09:08, 27.43s/it]Running generate_until requests:  81%|████████  | 81/100 [40:35<08:44, 27.60s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:03<08:17, 27.66s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:31<07:50, 27.67s/it]Running generate_until requests:  84%|████████▍ | 84/100 [41:58<07:22, 27.63s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:25<06:52, 27.50s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:52<06:23, 27.37s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:12<05:23, 24.92s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:18<03:53, 19.45s/it]Running generate_until requests:  89%|████████▉ | 89/100 [43:45<03:58, 21.65s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:12<03:51, 23.18s/it]Running generate_until requests:  91%|█████████ | 91/100 [44:38<03:37, 24.20s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:05<03:18, 24.85s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:31<02:57, 25.30s/it]Running generate_until requests:  94%|█████████▍| 94/100 [45:57<02:33, 25.59s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:24<02:08, 25.79s/it]Running generate_until requests:  96%|█████████▌| 96/100 [46:28<01:18, 19.52s/it]Running generate_until requests:  97%|█████████▋| 97/100 [46:37<00:48, 16.21s/it]Running generate_until requests:  98%|█████████▊| 98/100 [47:03<00:38, 19.15s/it]Running generate_until requests:  99%|█████████▉| 99/100 [47:29<00:21, 21.10s/it]Running generate_until requests: 100%|██████████| 100/100 [47:54<00:00, 22.45s/it]Running generate_until requests: 100%|██████████| 100/100 [47:54<00:00, 28.75s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-21:00:15:37,146 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-21:00:15:37,165 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-21:00:17:28,346 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-21:00:17:39,995 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-21:00:17:39,997 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-21:00:17:40,006 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-21:00:17:40,007 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-21:00:17:40,007 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-21:00:17:40,249 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-21:00:17:40,691 INFO     [huggingface.py:481] Using model type 'default'
2025-03-21:00:17:41,161 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.19s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.00s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.46it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s]
2025-03-21:00:17:49,310 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-21:00:17:49,313 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 341.18it/s] 70%|███████   | 70/100 [00:00<00:00, 343.04it/s]100%|██████████| 100/100 [00:00<00:00, 339.12it/s]
2025-03-21:00:17:49,612 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:09, 38.27s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:18, 36.93s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:53, 36.43s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:33, 35.98s/it]Running generate_until requests:   5%|▌         | 5/100 [03:00<56:12, 35.50s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:07, 35.19s/it]Running generate_until requests:   7%|▋         | 7/100 [04:09<54:11, 34.96s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<53:05, 34.62s/it]Running generate_until requests:   9%|▉         | 9/100 [05:16<52:04, 34.34s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:12, 34.13s/it]Running generate_until requests:  11%|█         | 11/100 [06:23<50:21, 33.95s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:57<49:28, 33.74s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:30<48:40, 33.57s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:03<47:56, 33.45s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:36<47:14, 33.34s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:09<46:33, 33.26s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:42<45:48, 33.11s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:14<44:53, 32.85s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:46<44:05, 32.66s/it]Running generate_until requests:  20%|██        | 20/100 [11:19<43:21, 32.52s/it]Running generate_until requests:  21%|██        | 21/100 [11:51<42:39, 32.40s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:04<34:35, 26.61s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:15<28:18, 22.06s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:47<31:39, 24.99s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:19<33:47, 27.03s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:51<35:03, 28.43s/it]Running generate_until requests:  27%|██▋       | 27/100 [14:22<35:45, 29.39s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:54<36:04, 30.06s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:26<36:07, 30.53s/it]Running generate_until requests:  30%|███       | 30/100 [15:57<35:59, 30.85s/it]Running generate_until requests:  31%|███       | 31/100 [16:29<35:42, 31.04s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:00<35:18, 31.16s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:31<34:51, 31.21s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:03<34:21, 31.24s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:34<33:49, 31.23s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:05<33:17, 31.21s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:36<32:45, 31.19s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:07<32:12, 31.17s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:38<31:39, 31.14s/it]Running generate_until requests:  40%|████      | 40/100 [21:09<31:06, 31.10s/it]Running generate_until requests:  41%|████      | 41/100 [21:40<30:32, 31.07s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:11<29:59, 31.03s/it]Running generate_until requests:  43%|████▎     | 43/100 [22:42<29:26, 31.00s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:13<28:53, 30.95s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:44<28:20, 30.92s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:15<27:47, 30.87s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:45<27:14, 30.84s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:16<26:42, 30.81s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:47<26:07, 30.73s/it]Running generate_until requests:  50%|█████     | 50/100 [26:17<25:32, 30.64s/it]Running generate_until requests:  51%|█████     | 51/100 [26:47<24:56, 30.54s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:18<24:21, 30.44s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:46<23:18, 29.76s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:16<22:50, 29.79s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:46<22:20, 29.80s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:15<21:50, 29.79s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:45<21:19, 29.75s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:15<20:47, 29.71s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:44<20:15, 29.65s/it]Running generate_until requests:  60%|██████    | 60/100 [31:14<19:44, 29.61s/it]Running generate_until requests:  61%|██████    | 61/100 [31:43<19:13, 29.57s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:12<18:41, 29.52s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:42<18:08, 29.41s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:11<17:35, 29.31s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:40<17:02, 29.23s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:09<16:31, 29.17s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:38<16:00, 29.10s/it]Running generate_until requests:  68%|██████▊   | 68/100 [35:06<15:27, 28.99s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:35<14:55, 28.90s/it]Running generate_until requests:  70%|███████   | 70/100 [36:04<14:24, 28.83s/it]Running generate_until requests:  71%|███████   | 71/100 [36:32<13:54, 28.76s/it]Running generate_until requests:  72%|███████▏  | 72/100 [37:01<13:22, 28.67s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:29<12:52, 28.61s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:58<12:21, 28.53s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:26<11:51, 28.46s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:54<11:21, 28.40s/it]Running generate_until requests:  77%|███████▋  | 77/100 [39:22<10:51, 28.34s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:51<10:22, 28.29s/it]Running generate_until requests:  79%|███████▉  | 79/100 [40:19<09:53, 28.25s/it]Running generate_until requests:  80%|████████  | 80/100 [40:47<09:23, 28.17s/it]Running generate_until requests:  81%|████████  | 81/100 [41:15<08:54, 28.12s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:43<08:24, 28.02s/it]Running generate_until requests:  83%|████████▎ | 83/100 [42:10<07:54, 27.92s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:38<07:24, 27.79s/it]Running generate_until requests:  85%|████████▌ | 85/100 [43:05<06:54, 27.61s/it]Running generate_until requests:  86%|████████▌ | 86/100 [43:32<06:24, 27.44s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:59<05:54, 27.30s/it]Running generate_until requests:  88%|████████▊ | 88/100 [44:13<04:40, 23.36s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:40<04:28, 24.38s/it]Running generate_until requests:  90%|█████████ | 90/100 [45:07<04:10, 25.09s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:33<03:49, 25.54s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:59<03:26, 25.78s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:26<03:01, 25.95s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:44<02:21, 23.54s/it]Running generate_until requests:  95%|█████████▌| 95/100 [47:10<02:01, 24.35s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:36<01:39, 24.92s/it]Running generate_until requests:  97%|█████████▋| 97/100 [48:02<01:15, 25.30s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:28<00:51, 25.51s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:54<00:25, 25.55s/it]Running generate_until requests: 100%|██████████| 100/100 [49:20<00:00, 25.55s/it]Running generate_until requests: 100%|██████████| 100/100 [49:20<00:00, 29.60s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-21:01:07:14,952 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-21:01:07:14,971 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-21:01:07:55,294 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-21:01:08:07,437 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-21:01:08:07,438 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-21:01:08:07,448 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-21:01:08:07,448 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-21:01:08:07,449 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-21:01:08:07,693 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-21:01:08:08,092 INFO     [huggingface.py:481] Using model type 'default'
2025-03-21:01:08:08,778 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.04s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s]
2025-03-21:01:08:17,054 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-21:01:08:17,057 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 346.92it/s] 71%|███████   | 71/100 [00:00<00:00, 351.02it/s]100%|██████████| 100/100 [00:00<00:00, 351.48it/s]
2025-03-21:01:08:17,346 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:02:53, 38.12s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:11, 36.85s/it]Running generate_until requests:   3%|▎         | 3/100 [01:49<58:49, 36.38s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:30, 35.94s/it]Running generate_until requests:   5%|▌         | 5/100 [02:59<56:09, 35.47s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:05, 35.17s/it]Running generate_until requests:   7%|▋         | 7/100 [04:08<54:09, 34.94s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<53:03, 34.60s/it]Running generate_until requests:   9%|▉         | 9/100 [05:16<52:03, 34.32s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:10, 34.12s/it]Running generate_until requests:  11%|█         | 11/100 [06:23<50:20, 33.94s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:56<49:27, 33.73s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:30<48:39, 33.56s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:03<47:55, 33.44s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:36<47:12, 33.33s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:09<46:32, 33.25s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:42<45:47, 33.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:14<44:52, 32.84s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:46<44:04, 32.65s/it]Running generate_until requests:  20%|██        | 20/100 [11:18<43:20, 32.51s/it]Running generate_until requests:  21%|██        | 21/100 [11:50<42:38, 32.39s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:03<34:34, 26.60s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:15<28:18, 22.05s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:47<31:38, 24.98s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:18<33:46, 27.02s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:50<35:03, 28.42s/it]Running generate_until requests:  27%|██▋       | 27/100 [14:22<35:45, 29.39s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:53<36:03, 30.05s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:25<36:07, 30.52s/it]Running generate_until requests:  30%|███       | 30/100 [15:57<35:59, 30.84s/it]Running generate_until requests:  31%|███       | 31/100 [16:28<35:41, 31.03s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:00<35:17, 31.15s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:31<34:50, 31.20s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:02<34:20, 31.22s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:33<33:49, 31.22s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:04<33:17, 31.20s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:36<32:44, 31.18s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:07<32:11, 31.16s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:38<31:38, 31.13s/it]Running generate_until requests:  40%|████      | 40/100 [21:09<31:05, 31.09s/it]Running generate_until requests:  41%|████      | 41/100 [21:40<30:32, 31.06s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:11<29:59, 31.02s/it]Running generate_until requests:  43%|████▎     | 43/100 [22:42<29:26, 30.99s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:12<28:52, 30.94s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:43<28:19, 30.90s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:14<27:46, 30.86s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:45<27:14, 30.83s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:16<26:41, 30.80s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:46<26:06, 30.71s/it]Running generate_until requests:  50%|█████     | 50/100 [26:16<25:31, 30.63s/it]Running generate_until requests:  51%|█████     | 51/100 [26:47<24:55, 30.52s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:17<24:20, 30.43s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:45<23:17, 29.74s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:15<22:49, 29.77s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:45<22:20, 29.79s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:14<21:50, 29.78s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:44<21:18, 29.74s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:14<20:47, 29.69s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:43<20:15, 29.64s/it]Running generate_until requests:  60%|██████    | 60/100 [31:13<19:43, 29.59s/it]Running generate_until requests:  61%|██████    | 61/100 [31:42<19:12, 29.55s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:12<18:41, 29.50s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:41<18:07, 29.40s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:10<17:34, 29.29s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:39<17:02, 29.21s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:08<16:31, 29.15s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:37<15:59, 29.09s/it]Running generate_until requests:  68%|██████▊   | 68/100 [35:05<15:27, 28.98s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:34<14:55, 28.89s/it]Running generate_until requests:  70%|███████   | 70/100 [36:03<14:24, 28.81s/it]Running generate_until requests:  71%|███████   | 71/100 [36:31<13:53, 28.75s/it]Running generate_until requests:  72%|███████▏  | 72/100 [37:00<13:22, 28.66s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:28<12:52, 28.60s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:57<12:21, 28.52s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:25<11:51, 28.45s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:53<11:21, 28.39s/it]Running generate_until requests:  77%|███████▋  | 77/100 [39:21<10:51, 28.33s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:50<10:22, 28.28s/it]Running generate_until requests:  79%|███████▉  | 79/100 [40:18<09:52, 28.23s/it]Running generate_until requests:  80%|████████  | 80/100 [40:46<09:23, 28.16s/it]Running generate_until requests:  81%|████████  | 81/100 [41:14<08:53, 28.10s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:41<08:24, 28.00s/it]Running generate_until requests:  83%|████████▎ | 83/100 [42:09<07:54, 27.91s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:37<07:24, 27.78s/it]Running generate_until requests:  85%|████████▌ | 85/100 [43:04<06:53, 27.60s/it]Running generate_until requests:  86%|████████▌ | 86/100 [43:31<06:23, 27.43s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:58<05:54, 27.28s/it]Running generate_until requests:  88%|████████▊ | 88/100 [44:12<04:40, 23.35s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:39<04:28, 24.37s/it]Running generate_until requests:  90%|█████████ | 90/100 [45:05<04:10, 25.07s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:32<03:49, 25.52s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:58<03:26, 25.76s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:25<03:01, 25.93s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:42<02:21, 23.53s/it]Running generate_until requests:  95%|█████████▌| 95/100 [47:09<02:01, 24.34s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:35<01:39, 24.90s/it]Running generate_until requests:  97%|█████████▋| 97/100 [48:01<01:15, 25.29s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:27<00:51, 25.50s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:53<00:25, 25.54s/it]Running generate_until requests: 100%|██████████| 100/100 [49:18<00:00, 25.54s/it]Running generate_until requests: 100%|██████████| 100/100 [49:18<00:00, 29.59s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-21:01:57:41,345 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-21:01:57:41,384 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-21:01:58:21,957 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-21:01:58:34,044 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-21:01:58:34,045 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-21:01:58:34,054 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-21:01:58:34,055 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-21:01:58:34,056 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-21:01:58:34,302 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-21:01:58:34,481 INFO     [huggingface.py:481] Using model type 'default'
2025-03-21:01:58:34,970 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.18s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.01s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.42it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s]
2025-03-21:01:58:47,557 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-21:01:58:47,559 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 36%|███▌      | 36/100 [00:00<00:00, 351.58it/s] 72%|███████▏  | 72/100 [00:00<00:00, 338.89it/s]100%|██████████| 100/100 [00:00<00:00, 343.58it/s]
2025-03-21:01:58:47,854 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:02:53, 38.12s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:11, 36.85s/it]Running generate_until requests:   3%|▎         | 3/100 [01:49<58:48, 36.38s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:30, 35.94s/it]Running generate_until requests:   5%|▌         | 5/100 [02:59<56:08, 35.46s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:05, 35.16s/it]Running generate_until requests:   7%|▋         | 7/100 [04:08<54:09, 34.94s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<53:03, 34.60s/it]Running generate_until requests:   9%|▉         | 9/100 [05:16<52:02, 34.32s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:10, 34.12s/it]Running generate_until requests:  11%|█         | 11/100 [06:23<50:20, 33.94s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:56<49:27, 33.72s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:30<48:39, 33.56s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:03<47:55, 33.43s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:36<47:12, 33.33s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:09<46:32, 33.24s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:42<45:47, 33.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:14<44:52, 32.84s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:46<44:04, 32.65s/it]Running generate_until requests:  20%|██        | 20/100 [11:18<43:20, 32.50s/it]Running generate_until requests:  21%|██        | 21/100 [11:50<42:38, 32.38s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:03<34:34, 26.60s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:15<28:17, 22.05s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:47<31:38, 24.98s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:18<33:46, 27.02s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:50<35:02, 28.42s/it]Running generate_until requests:  27%|██▋       | 27/100 [14:22<35:44, 29.38s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:53<36:03, 30.05s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:25<36:06, 30.52s/it]Running generate_until requests:  30%|███       | 30/100 [15:57<35:58, 30.84s/it]Running generate_until requests:  31%|███       | 31/100 [16:28<35:41, 31.03s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:59<35:17, 31.14s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:31<34:50, 31.20s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:02<34:20, 31.22s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:33<33:49, 31.22s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:04<33:16, 31.20s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:35<32:44, 31.18s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:07<32:11, 31.15s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:38<31:38, 31.13s/it]Running generate_until requests:  40%|████      | 40/100 [21:09<31:05, 31.09s/it]Running generate_until requests:  41%|████      | 41/100 [21:40<30:32, 31.05s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:11<29:59, 31.02s/it]Running generate_until requests:  43%|████▎     | 43/100 [22:41<29:26, 30.98s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:12<28:52, 30.93s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:43<28:19, 30.90s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:14<27:46, 30.86s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:45<27:13, 30.83s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:15<26:41, 30.79s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:46<26:06, 30.71s/it]Running generate_until requests:  50%|█████     | 50/100 [26:16<25:31, 30.63s/it]Running generate_until requests:  51%|█████     | 51/100 [26:47<24:55, 30.52s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:17<24:20, 30.42s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:45<23:17, 29.74s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:15<22:49, 29.77s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:45<22:20, 29.78s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:14<21:50, 29.78s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:44<21:18, 29.74s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:14<20:47, 29.69s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:43<20:15, 29.64s/it]Running generate_until requests:  60%|██████    | 60/100 [31:13<19:43, 29.59s/it]Running generate_until requests:  61%|██████    | 61/100 [31:42<19:12, 29.55s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:11<18:40, 29.50s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:41<18:07, 29.39s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:10<17:34, 29.29s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:39<17:02, 29.21s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:08<16:31, 29.15s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:37<15:59, 29.09s/it]Running generate_until requests:  68%|██████▊   | 68/100 [35:05<15:27, 28.97s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:34<14:55, 28.88s/it]Running generate_until requests:  70%|███████   | 70/100 [36:03<14:24, 28.81s/it]Running generate_until requests:  71%|███████   | 71/100 [36:31<13:53, 28.75s/it]Running generate_until requests:  72%|███████▏  | 72/100 [37:00<13:22, 28.66s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:28<12:52, 28.59s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:56<12:21, 28.51s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:25<11:51, 28.44s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:53<11:21, 28.38s/it]Running generate_until requests:  77%|███████▋  | 77/100 [39:21<10:51, 28.33s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:49<10:22, 28.28s/it]Running generate_until requests:  79%|███████▉  | 79/100 [40:17<09:52, 28.23s/it]Running generate_until requests:  80%|████████  | 80/100 [40:45<09:23, 28.15s/it]Running generate_until requests:  81%|████████  | 81/100 [41:13<08:53, 28.10s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:41<08:24, 28.00s/it]Running generate_until requests:  83%|████████▎ | 83/100 [42:09<07:54, 27.90s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:36<07:24, 27.78s/it]Running generate_until requests:  85%|████████▌ | 85/100 [43:03<06:53, 27.59s/it]Running generate_until requests:  86%|████████▌ | 86/100 [43:30<06:23, 27.42s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:57<05:54, 27.28s/it]Running generate_until requests:  88%|████████▊ | 88/100 [44:12<04:40, 23.35s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:38<04:28, 24.36s/it]Running generate_until requests:  90%|█████████ | 90/100 [45:05<04:10, 25.07s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:32<03:49, 25.52s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:58<03:26, 25.76s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:24<03:01, 25.93s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:42<02:21, 23.53s/it]Running generate_until requests:  95%|█████████▌| 95/100 [47:08<02:01, 24.34s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:35<01:39, 24.90s/it]Running generate_until requests:  97%|█████████▋| 97/100 [48:01<01:15, 25.29s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:27<00:51, 25.50s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:52<00:25, 25.54s/it]Running generate_until requests: 100%|██████████| 100/100 [49:18<00:00, 25.54s/it]Running generate_until requests: 100%|██████████| 100/100 [49:18<00:00, 29.58s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-21:02:48:11,746 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-21:02:48:11,750 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-21:02:48:51,972 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-21:02:49:02,959 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-21:02:49:02,960 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-21:02:49:02,970 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-21:02:49:02,971 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-21:02:49:02,971 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-21:02:49:03,198 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-21:02:49:03,379 INFO     [huggingface.py:481] Using model type 'default'
2025-03-21:02:49:03,976 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.23s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.04s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.19it/s]
2025-03-21:02:49:14,024 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-21:02:49:14,026 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 31%|███       | 31/100 [00:00<00:00, 309.81it/s] 66%|██████▌   | 66/100 [00:00<00:00, 332.24it/s]100%|██████████| 100/100 [00:00<00:00, 335.58it/s]
2025-03-21:02:49:14,328 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:03:03, 38.21s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:19, 36.94s/it]Running generate_until requests:   3%|▎         | 3/100 [01:50<58:56, 36.46s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:37, 36.02s/it]Running generate_until requests:   5%|▌         | 5/100 [03:00<56:16, 35.54s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:12, 35.24s/it]Running generate_until requests:   7%|▋         | 7/100 [04:09<54:16, 35.02s/it]Running generate_until requests:   8%|▊         | 8/100 [04:43<53:10, 34.68s/it]Running generate_until requests:   9%|▉         | 9/100 [05:17<52:09, 34.39s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:17, 34.19s/it]Running generate_until requests:  11%|█         | 11/100 [06:24<50:27, 34.02s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:57<49:34, 33.80s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:31<48:46, 33.63s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:04<48:02, 33.51s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:37<47:19, 33.41s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:10<46:39, 33.32s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:43<45:53, 33.18s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:15<44:59, 32.92s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:48<44:10, 32.73s/it]Running generate_until requests:  20%|██        | 20/100 [11:20<43:26, 32.58s/it]Running generate_until requests:  21%|██        | 21/100 [11:52<42:44, 32.46s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:05<34:39, 26.66s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:17<28:22, 22.11s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:48<31:43, 25.04s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:20<33:51, 27.09s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:52<35:08, 28.49s/it]Running generate_until requests:  27%|██▋       | 27/100 [14:24<35:50, 29.45s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:55<36:09, 30.13s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:27<36:12, 30.60s/it]Running generate_until requests:  30%|███       | 30/100 [15:59<36:04, 30.92s/it]Running generate_until requests:  31%|███       | 31/100 [16:30<35:46, 31.11s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:02<35:23, 31.22s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:33<34:55, 31.28s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:05<34:25, 31.30s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:36<33:54, 31.29s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:07<33:21, 31.28s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:38<32:49, 31.26s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:10<32:16, 31.23s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:41<31:43, 31.21s/it]Running generate_until requests:  40%|████      | 40/100 [21:12<31:10, 31.17s/it]Running generate_until requests:  41%|████      | 41/100 [21:43<30:36, 31.13s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:14<30:03, 31.10s/it]Running generate_until requests:  43%|████▎     | 43/100 [22:45<29:30, 31.06s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:16<28:56, 31.01s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:47<28:23, 30.98s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:17<27:50, 30.94s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:48<27:18, 30.91s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:19<26:45, 30.87s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:50<26:10, 30.79s/it]Running generate_until requests:  50%|█████     | 50/100 [26:20<25:35, 30.71s/it]Running generate_until requests:  51%|█████     | 51/100 [26:51<24:59, 30.60s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:21<24:24, 30.50s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:49<23:21, 29.82s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:19<22:53, 29.85s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:49<22:23, 29.86s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:19<21:53, 29.86s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:48<21:22, 29.82s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:18<20:50, 29.77s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:48<20:18, 29.72s/it]Running generate_until requests:  60%|██████    | 60/100 [31:17<19:46, 29.67s/it]Running generate_until requests:  61%|██████    | 61/100 [31:47<19:15, 29.63s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:16<18:44, 29.58s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:45<18:10, 29.48s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:15<17:37, 29.37s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:44<17:05, 29.29s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:13<16:33, 29.23s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:42<16:02, 29.17s/it]Running generate_until requests:  68%|██████▊   | 68/100 [35:11<15:29, 29.06s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:39<14:57, 28.97s/it]Running generate_until requests:  70%|███████   | 70/100 [36:08<14:26, 28.89s/it]Running generate_until requests:  71%|███████   | 71/100 [36:37<13:55, 28.83s/it]Running generate_until requests:  72%|███████▏  | 72/100 [37:05<13:24, 28.74s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:34<12:54, 28.67s/it]Running generate_until requests:  74%|███████▍  | 74/100 [38:02<12:23, 28.59s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:31<11:53, 28.52s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:59<11:23, 28.46s/it]Running generate_until requests:  77%|███████▋  | 77/100 [39:27<10:53, 28.41s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:55<10:23, 28.36s/it]Running generate_until requests:  79%|███████▉  | 79/100 [40:24<09:54, 28.31s/it]Running generate_until requests:  80%|████████  | 80/100 [40:52<09:24, 28.23s/it]Running generate_until requests:  81%|████████  | 81/100 [41:20<08:55, 28.18s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:48<08:25, 28.08s/it]Running generate_until requests:  83%|████████▎ | 83/100 [42:15<07:55, 27.98s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:43<07:25, 27.85s/it]Running generate_until requests:  85%|████████▌ | 85/100 [43:10<06:55, 27.67s/it]Running generate_until requests:  86%|████████▌ | 86/100 [43:37<06:25, 27.50s/it]Running generate_until requests:  87%|████████▋ | 87/100 [44:04<05:55, 27.36s/it]Running generate_until requests:  88%|████████▊ | 88/100 [44:18<04:40, 23.42s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:45<04:28, 24.44s/it]Running generate_until requests:  90%|█████████ | 90/100 [45:12<04:11, 25.14s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:39<03:50, 25.60s/it]Running generate_until requests:  92%|█████████▏| 92/100 [46:05<03:26, 25.84s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:32<03:02, 26.01s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:50<02:21, 23.60s/it]Running generate_until requests:  95%|█████████▌| 95/100 [47:16<02:02, 24.41s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:42<01:39, 24.98s/it]Running generate_until requests:  97%|█████████▋| 97/100 [48:08<01:16, 25.37s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:34<00:51, 25.58s/it]Running generate_until requests:  99%|█████████▉| 99/100 [49:00<00:25, 25.61s/it]Running generate_until requests: 100%|██████████| 100/100 [49:26<00:00, 25.62s/it]Running generate_until requests: 100%|██████████| 100/100 [49:26<00:00, 29.66s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-21:03:38:45,850 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-21:03:38:45,913 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-03-21:03:39:26,399 INFO     [__main__.py:279] Verbosity set to INFO
2025-03-21:03:39:38,009 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-03-21:03:39:38,010 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-03-21:03:39:38,019 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-03-21:03:39:38,020 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-03-21:03:39:38,020 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.1-8B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-03-21:03:39:38,265 INFO     [huggingface.py:129] Using device 'cuda'
2025-03-21:03:39:38,436 INFO     [huggingface.py:481] Using model type 'default'
2025-03-21:03:39:38,910 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.19s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.01s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s]
2025-03-21:03:39:49,389 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-03-21:03:39:49,392 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 334.05it/s] 70%|███████   | 70/100 [00:00<00:00, 341.21it/s]100%|██████████| 100/100 [00:00<00:00, 343.61it/s]
2025-03-21:03:39:49,687 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/100 [00:38<1:02:54, 38.12s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<1:00:11, 36.85s/it]Running generate_until requests:   3%|▎         | 3/100 [01:49<58:48, 36.38s/it]  Running generate_until requests:   4%|▍         | 4/100 [02:25<57:29, 35.93s/it]Running generate_until requests:   5%|▌         | 5/100 [02:59<56:08, 35.46s/it]Running generate_until requests:   6%|▌         | 6/100 [03:34<55:04, 35.16s/it]Running generate_until requests:   7%|▋         | 7/100 [04:08<54:08, 34.93s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<53:02, 34.59s/it]Running generate_until requests:   9%|▉         | 9/100 [05:16<52:02, 34.31s/it]Running generate_until requests:  10%|█         | 10/100 [05:50<51:09, 34.11s/it]Running generate_until requests:  11%|█         | 11/100 [06:23<50:19, 33.93s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:56<49:27, 33.72s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:29<48:38, 33.55s/it]Running generate_until requests:  14%|█▍        | 14/100 [08:03<47:54, 33.43s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:36<47:12, 33.32s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:09<46:31, 33.24s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:41<45:46, 33.09s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:14<44:52, 32.83s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:46<44:03, 32.64s/it]Running generate_until requests:  20%|██        | 20/100 [11:18<43:19, 32.50s/it]Running generate_until requests:  21%|██        | 21/100 [11:50<42:37, 32.38s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:03<34:34, 26.59s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:15<28:17, 22.05s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:47<31:38, 24.98s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:18<33:46, 27.01s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:50<35:02, 28.41s/it]Running generate_until requests:  27%|██▋       | 27/100 [14:22<35:44, 29.38s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:53<36:03, 30.05s/it]Running generate_until requests:  29%|██▉       | 29/100 [15:25<36:06, 30.51s/it]Running generate_until requests:  30%|███       | 30/100 [15:56<35:58, 30.84s/it]Running generate_until requests:  31%|███       | 31/100 [16:28<35:40, 31.03s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:59<35:17, 31.14s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:31<34:50, 31.19s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:02<34:20, 31.22s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:33<33:48, 31.21s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:04<33:16, 31.20s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:35<32:43, 31.17s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:06<32:11, 31.15s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:37<31:38, 31.12s/it]Running generate_until requests:  40%|████      | 40/100 [21:08<31:05, 31.08s/it]Running generate_until requests:  41%|████      | 41/100 [21:39<30:31, 31.05s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:10<29:58, 31.01s/it]Running generate_until requests:  43%|████▎     | 43/100 [22:41<29:25, 30.98s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:12<28:52, 30.93s/it]Running generate_until requests:  45%|████▌     | 45/100 [23:43<28:19, 30.90s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:14<27:45, 30.85s/it]Running generate_until requests:  47%|████▋     | 47/100 [24:44<27:13, 30.82s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:15<26:40, 30.79s/it]Running generate_until requests:  49%|████▉     | 49/100 [25:46<26:05, 30.70s/it]Running generate_until requests:  50%|█████     | 50/100 [26:16<25:31, 30.62s/it]Running generate_until requests:  51%|█████     | 51/100 [26:46<24:55, 30.52s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:16<24:20, 30.42s/it]Running generate_until requests:  53%|█████▎    | 53/100 [27:45<23:17, 29.73s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:14<22:49, 29.77s/it]Running generate_until requests:  55%|█████▌    | 55/100 [28:44<22:19, 29.78s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:14<21:49, 29.77s/it]Running generate_until requests:  57%|█████▋    | 57/100 [29:44<21:18, 29.73s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:13<20:46, 29.69s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:43<20:15, 29.63s/it]Running generate_until requests:  60%|██████    | 60/100 [31:12<19:43, 29.59s/it]Running generate_until requests:  61%|██████    | 61/100 [31:42<19:12, 29.55s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:11<18:40, 29.49s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:40<18:07, 29.39s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:09<17:34, 29.28s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:38<17:02, 29.21s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:07<16:30, 29.14s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:36<15:59, 29.08s/it]Running generate_until requests:  68%|██████▊   | 68/100 [35:05<15:27, 28.97s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:34<14:55, 28.88s/it]Running generate_until requests:  70%|███████   | 70/100 [36:02<14:24, 28.81s/it]Running generate_until requests:  71%|███████   | 71/100 [36:31<13:53, 28.74s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:59<13:22, 28.65s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:28<12:51, 28.59s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:56<12:21, 28.51s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:24<11:51, 28.44s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:53<11:21, 28.38s/it]Running generate_until requests:  77%|███████▋  | 77/100 [39:21<10:51, 28.32s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:49<10:22, 28.27s/it]Running generate_until requests:  79%|███████▉  | 79/100 [40:17<09:52, 28.23s/it]Running generate_until requests:  80%|████████  | 80/100 [40:45<09:22, 28.15s/it]Running generate_until requests:  81%|████████  | 81/100 [41:13<08:53, 28.09s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:41<08:23, 27.99s/it]Running generate_until requests:  83%|████████▎ | 83/100 [42:08<07:54, 27.89s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:36<07:24, 27.77s/it]Running generate_until requests:  85%|████████▌ | 85/100 [43:03<06:53, 27.59s/it]Running generate_until requests:  86%|████████▌ | 86/100 [43:30<06:23, 27.42s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:57<05:54, 27.27s/it]Running generate_until requests:  88%|████████▊ | 88/100 [44:11<04:40, 23.34s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:38<04:27, 24.36s/it]Running generate_until requests:  90%|█████████ | 90/100 [45:05<04:10, 25.07s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:31<03:49, 25.52s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:57<03:26, 25.76s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:24<03:01, 25.93s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:42<02:21, 23.52s/it]Running generate_until requests:  95%|█████████▌| 95/100 [47:08<02:01, 24.33s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:34<01:39, 24.89s/it]Running generate_until requests:  97%|█████████▋| 97/100 [48:00<01:15, 25.28s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:26<00:50, 25.49s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:52<00:25, 25.53s/it]Running generate_until requests: 100%|██████████| 100/100 [49:17<00:00, 25.53s/it]Running generate_until requests: 100%|██████████| 100/100 [49:17<00:00, 29.58s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-03-21:04:29:12,879 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-03-21:04:29:12,907 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
