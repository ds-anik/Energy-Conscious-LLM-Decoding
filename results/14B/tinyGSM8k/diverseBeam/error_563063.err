2025-01-06:15:35:12,179 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:15:35:24,915 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:15:35:24,917 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:15:35:24,925 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:15:35:24,925 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:15:35:24,925 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:15:35:25,251 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:15:35:25,415 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:15:35:25,774 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.07s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.13it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.20it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.26it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.29it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.32it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.56it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.35it/s]
2025-01-06:15:35:37,912 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:15:35:37,914 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 340.28it/s] 70%|███████   | 70/100 [00:00<00:00, 343.17it/s]100%|██████████| 100/100 [00:00<00:00, 343.12it/s]
2025-01-06:15:35:38,209 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:23<39:13, 23.77s/it]Running generate_until requests:   2%|▏         | 2/100 [00:43<34:28, 21.11s/it]Running generate_until requests:   3%|▎         | 3/100 [01:05<35:15, 21.81s/it]Running generate_until requests:   4%|▍         | 4/100 [01:27<35:09, 21.98s/it]Running generate_until requests:   5%|▌         | 5/100 [01:45<32:23, 20.46s/it]Running generate_until requests:   6%|▌         | 6/100 [02:07<32:42, 20.87s/it]Running generate_until requests:   7%|▋         | 7/100 [02:25<30:43, 19.82s/it]Running generate_until requests:   8%|▊         | 8/100 [02:42<29:28, 19.23s/it]Running generate_until requests:   9%|▉         | 9/100 [03:04<30:17, 19.97s/it]Running generate_until requests:  10%|█         | 10/100 [03:26<30:40, 20.46s/it]Running generate_until requests:  11%|█         | 11/100 [03:47<30:47, 20.76s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:09<30:45, 20.98s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:26<28:58, 19.99s/it]Running generate_until requests:  14%|█▍        | 14/100 [04:48<29:12, 20.38s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:09<29:12, 20.62s/it]Running generate_until requests:  16%|█▌        | 16/100 [05:30<29:04, 20.76s/it]Running generate_until requests:  17%|█▋        | 17/100 [05:51<28:49, 20.84s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:12<28:32, 20.88s/it]Running generate_until requests:  19%|█▉        | 19/100 [06:33<28:10, 20.87s/it]Running generate_until requests:  20%|██        | 20/100 [06:53<27:48, 20.86s/it]Running generate_until requests:  21%|██        | 21/100 [07:10<25:40, 19.50s/it]Running generate_until requests:  22%|██▏       | 22/100 [07:30<25:48, 19.85s/it]Running generate_until requests:  23%|██▎       | 23/100 [07:51<25:45, 20.07s/it]Running generate_until requests:  24%|██▍       | 24/100 [08:12<25:36, 20.22s/it]Running generate_until requests:  25%|██▌       | 25/100 [08:23<21:54, 17.53s/it]Running generate_until requests:  26%|██▌       | 26/100 [08:43<22:43, 18.43s/it]Running generate_until requests:  27%|██▋       | 27/100 [09:04<23:11, 19.07s/it]Running generate_until requests:  28%|██▊       | 28/100 [09:15<20:03, 16.72s/it]Running generate_until requests:  29%|██▉       | 29/100 [09:36<21:08, 17.87s/it]Running generate_until requests:  30%|███       | 30/100 [09:56<21:44, 18.64s/it]Running generate_until requests:  31%|███       | 31/100 [10:07<18:37, 16.20s/it]Running generate_until requests:  32%|███▏      | 32/100 [10:27<19:40, 17.36s/it]Running generate_until requests:  33%|███▎      | 33/100 [10:32<15:29, 13.87s/it]Running generate_until requests:  34%|███▍      | 34/100 [10:53<17:23, 15.81s/it]Running generate_until requests:  35%|███▌      | 35/100 [11:07<16:31, 15.25s/it]Running generate_until requests:  36%|███▌      | 36/100 [11:27<17:53, 16.77s/it]Running generate_until requests:  37%|███▋      | 37/100 [11:47<18:42, 17.82s/it]Running generate_until requests:  38%|███▊      | 38/100 [12:08<19:10, 18.56s/it]Running generate_until requests:  39%|███▉      | 39/100 [12:28<19:23, 19.07s/it]Running generate_until requests:  40%|████      | 40/100 [12:48<19:23, 19.40s/it]Running generate_until requests:  41%|████      | 41/100 [13:08<19:18, 19.64s/it]Running generate_until requests:  42%|████▏     | 42/100 [13:27<18:42, 19.35s/it]Running generate_until requests:  43%|████▎     | 43/100 [13:47<18:37, 19.60s/it]Running generate_until requests:  44%|████▍     | 44/100 [14:07<18:27, 19.77s/it]Running generate_until requests:  45%|████▌     | 45/100 [14:27<18:13, 19.87s/it]Running generate_until requests:  46%|████▌     | 46/100 [14:38<15:23, 17.10s/it]Running generate_until requests:  47%|████▋     | 47/100 [14:58<15:52, 17.97s/it]Running generate_until requests:  48%|████▊     | 48/100 [15:18<16:04, 18.56s/it]Running generate_until requests:  49%|████▉     | 49/100 [15:38<16:06, 18.95s/it]Running generate_until requests:  50%|█████     | 50/100 [15:56<15:42, 18.85s/it]Running generate_until requests:  51%|█████     | 51/100 [16:16<15:38, 19.15s/it]Running generate_until requests:  52%|█████▏    | 52/100 [16:36<15:28, 19.34s/it]Running generate_until requests:  53%|█████▎    | 53/100 [16:56<15:14, 19.46s/it]Running generate_until requests:  54%|█████▍    | 54/100 [17:16<14:58, 19.54s/it]Running generate_until requests:  55%|█████▌    | 55/100 [17:26<12:35, 16.78s/it]Running generate_until requests:  56%|█████▌    | 56/100 [17:46<12:56, 17.64s/it]Running generate_until requests:  57%|█████▋    | 57/100 [18:00<12:01, 16.79s/it]Running generate_until requests:  58%|█████▊    | 58/100 [18:20<12:21, 17.65s/it]Running generate_until requests:  59%|█████▉    | 59/100 [18:40<12:27, 18.24s/it]Running generate_until requests:  60%|██████    | 60/100 [18:59<12:25, 18.64s/it]Running generate_until requests:  61%|██████    | 61/100 [19:13<11:07, 17.12s/it]Running generate_until requests:  62%|██████▏   | 62/100 [19:23<09:37, 15.21s/it]Running generate_until requests:  63%|██████▎   | 63/100 [19:43<10:10, 16.49s/it]Running generate_until requests:  64%|██████▍   | 64/100 [20:02<10:26, 17.40s/it]Running generate_until requests:  65%|██████▌   | 65/100 [20:22<10:30, 18.02s/it]Running generate_until requests:  66%|██████▌   | 66/100 [20:34<09:10, 16.18s/it]Running generate_until requests:  67%|██████▋   | 67/100 [20:42<07:34, 13.78s/it]Running generate_until requests:  68%|██████▊   | 68/100 [21:01<08:15, 15.47s/it]Running generate_until requests:  69%|██████▉   | 69/100 [21:21<08:36, 16.65s/it]Running generate_until requests:  70%|███████   | 70/100 [21:40<08:44, 17.47s/it]Running generate_until requests:  71%|███████   | 71/100 [21:59<08:42, 18.00s/it]Running generate_until requests:  72%|███████▏  | 72/100 [22:10<07:19, 15.70s/it]Running generate_until requests:  73%|███████▎  | 73/100 [22:27<07:16, 16.15s/it]Running generate_until requests:  74%|███████▍  | 74/100 [22:46<07:23, 17.07s/it]Running generate_until requests:  75%|███████▌  | 75/100 [22:56<06:12, 14.91s/it]Running generate_until requests:  76%|███████▌  | 76/100 [23:13<06:12, 15.53s/it]Running generate_until requests:  77%|███████▋  | 77/100 [23:23<05:17, 13.81s/it]Running generate_until requests:  78%|███████▊  | 78/100 [23:42<05:39, 15.42s/it]Running generate_until requests:  79%|███████▉  | 79/100 [23:57<05:18, 15.14s/it]Running generate_until requests:  80%|████████  | 80/100 [24:08<04:41, 14.06s/it]Running generate_until requests:  81%|████████  | 81/100 [24:27<04:55, 15.53s/it]Running generate_until requests:  82%|████████▏ | 82/100 [24:46<04:57, 16.54s/it]Running generate_until requests:  83%|████████▎ | 83/100 [25:05<04:52, 17.23s/it]Running generate_until requests:  84%|████████▍ | 84/100 [25:14<03:57, 14.82s/it]Running generate_until requests:  85%|████████▌ | 85/100 [25:30<03:48, 15.26s/it]Running generate_until requests:  86%|████████▌ | 86/100 [25:49<03:48, 16.31s/it]Running generate_until requests:  87%|████████▋ | 87/100 [26:08<03:41, 17.03s/it]Running generate_until requests:  88%|████████▊ | 88/100 [26:21<03:09, 15.76s/it]Running generate_until requests:  89%|████████▉ | 89/100 [26:39<03:02, 16.61s/it]Running generate_until requests:  90%|█████████ | 90/100 [26:58<02:51, 17.20s/it]Running generate_until requests:  91%|█████████ | 91/100 [27:16<02:38, 17.61s/it]Running generate_until requests:  92%|█████████▏| 92/100 [27:25<02:00, 15.07s/it]Running generate_until requests:  93%|█████████▎| 93/100 [27:44<01:52, 16.10s/it]Running generate_until requests:  94%|█████████▍| 94/100 [28:02<01:40, 16.82s/it]Running generate_until requests:  95%|█████████▌| 95/100 [28:21<01:26, 17.29s/it]Running generate_until requests:  96%|█████████▌| 96/100 [28:39<01:10, 17.54s/it]Running generate_until requests:  97%|█████████▋| 97/100 [28:57<00:53, 17.78s/it]Running generate_until requests:  98%|█████████▊| 98/100 [29:16<00:35, 17.94s/it]Running generate_until requests:  99%|█████████▉| 99/100 [29:24<00:15, 15.16s/it]Running generate_until requests: 100%|██████████| 100/100 [29:35<00:00, 13.80s/it]Running generate_until requests: 100%|██████████| 100/100 [29:35<00:00, 17.75s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:16:05:19,227 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:16:05:19,355 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:16:06:02,011 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:16:06:16,725 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:16:06:16,726 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:16:06:16,736 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:16:06:16,736 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:16:06:16,736 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:16:06:17,019 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:16:06:17,273 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:16:06:17,698 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.11s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.11it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.18it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.25it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.28it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.28it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.54it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.33it/s]
2025-01-06:16:06:29,896 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:16:06:29,899 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 337.28it/s] 69%|██████▉   | 69/100 [00:00<00:00, 343.14it/s]100%|██████████| 100/100 [00:00<00:00, 344.30it/s]
2025-01-06:16:06:30,194 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:23<39:00, 23.64s/it]Running generate_until requests:   2%|▏         | 2/100 [00:42<34:20, 21.03s/it]Running generate_until requests:   3%|▎         | 3/100 [01:05<35:08, 21.74s/it]Running generate_until requests:   4%|▍         | 4/100 [01:27<35:02, 21.91s/it]Running generate_until requests:   5%|▌         | 5/100 [01:45<32:17, 20.40s/it]Running generate_until requests:   6%|▌         | 6/100 [02:06<32:35, 20.81s/it]Running generate_until requests:   7%|▋         | 7/100 [02:24<30:37, 19.76s/it]Running generate_until requests:   8%|▊         | 8/100 [02:42<29:23, 19.17s/it]Running generate_until requests:   9%|▉         | 9/100 [03:03<30:11, 19.91s/it]Running generate_until requests:  10%|█         | 10/100 [03:25<30:35, 20.39s/it]Running generate_until requests:  11%|█         | 11/100 [03:46<30:42, 20.70s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:08<30:40, 20.91s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:25<28:53, 19.92s/it]Running generate_until requests:  14%|█▍        | 14/100 [04:47<29:07, 20.32s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:08<29:07, 20.56s/it]Running generate_until requests:  16%|█▌        | 16/100 [05:29<28:58, 20.70s/it]Running generate_until requests:  17%|█▋        | 17/100 [05:50<28:43, 20.77s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:11<28:26, 20.81s/it]Running generate_until requests:  19%|█▉        | 19/100 [06:31<28:05, 20.81s/it]Running generate_until requests:  20%|██        | 20/100 [06:52<27:44, 20.80s/it]Running generate_until requests:  21%|██        | 21/100 [07:08<25:36, 19.45s/it]Running generate_until requests:  22%|██▏       | 22/100 [07:29<25:42, 19.78s/it]Running generate_until requests:  23%|██▎       | 23/100 [07:50<25:40, 20.00s/it]Running generate_until requests:  24%|██▍       | 24/100 [08:10<25:31, 20.15s/it]Running generate_until requests:  25%|██▌       | 25/100 [08:21<21:50, 17.47s/it]Running generate_until requests:  26%|██▌       | 26/100 [08:42<22:39, 18.37s/it]Running generate_until requests:  27%|██▋       | 27/100 [09:02<23:07, 19.01s/it]Running generate_until requests:  28%|██▊       | 28/100 [09:13<20:00, 16.67s/it]Running generate_until requests:  29%|██▉       | 29/100 [09:34<21:04, 17.81s/it]Running generate_until requests:  30%|███       | 30/100 [09:54<21:40, 18.58s/it]Running generate_until requests:  31%|███       | 31/100 [10:05<18:34, 16.15s/it]Running generate_until requests:  32%|███▏      | 32/100 [10:25<19:36, 17.30s/it]Running generate_until requests:  33%|███▎      | 33/100 [10:30<15:26, 13.83s/it]Running generate_until requests:  34%|███▍      | 34/100 [10:51<17:20, 15.76s/it]Running generate_until requests:  35%|███▌      | 35/100 [11:05<16:28, 15.21s/it]Running generate_until requests:  36%|███▌      | 36/100 [11:25<17:49, 16.72s/it]Running generate_until requests:  37%|███▋      | 37/100 [11:45<18:39, 17.77s/it]Running generate_until requests:  38%|███▊      | 38/100 [12:05<19:06, 18.50s/it]Running generate_until requests:  39%|███▉      | 39/100 [12:26<19:19, 19.01s/it]Running generate_until requests:  40%|████      | 40/100 [12:46<19:20, 19.34s/it]Running generate_until requests:  41%|████      | 41/100 [13:06<19:15, 19.58s/it]Running generate_until requests:  42%|████▏     | 42/100 [13:24<18:38, 19.28s/it]Running generate_until requests:  43%|████▎     | 43/100 [13:44<18:33, 19.54s/it]Running generate_until requests:  44%|████▍     | 44/100 [14:05<18:23, 19.71s/it]Running generate_until requests:  45%|████▌     | 45/100 [14:25<18:09, 19.81s/it]Running generate_until requests:  46%|████▌     | 46/100 [14:35<15:20, 17.05s/it]Running generate_until requests:  47%|████▋     | 47/100 [14:55<15:49, 17.91s/it]Running generate_until requests:  48%|████▊     | 48/100 [15:15<16:01, 18.49s/it]Running generate_until requests:  49%|████▉     | 49/100 [15:35<16:03, 18.89s/it]Running generate_until requests:  50%|█████     | 50/100 [15:53<15:39, 18.79s/it]Running generate_until requests:  51%|█████     | 51/100 [16:13<15:35, 19.10s/it]Running generate_until requests:  52%|█████▏    | 52/100 [16:33<15:26, 19.31s/it]Running generate_until requests:  53%|█████▎    | 53/100 [16:53<15:12, 19.41s/it]Running generate_until requests:  54%|█████▍    | 54/100 [17:12<14:56, 19.48s/it]Running generate_until requests:  55%|█████▌    | 55/100 [17:23<12:32, 16.72s/it]Running generate_until requests:  56%|█████▌    | 56/100 [17:42<12:53, 17.58s/it]Running generate_until requests:  57%|█████▋    | 57/100 [17:57<11:59, 16.73s/it]Running generate_until requests:  58%|█████▊    | 58/100 [18:17<12:18, 17.59s/it]Running generate_until requests:  59%|█████▉    | 59/100 [18:36<12:25, 18.18s/it]Running generate_until requests:  60%|██████    | 60/100 [18:56<12:23, 18.58s/it]Running generate_until requests:  61%|██████    | 61/100 [19:09<11:05, 17.07s/it]Running generate_until requests:  62%|██████▏   | 62/100 [19:20<09:35, 15.16s/it]Running generate_until requests:  63%|██████▎   | 63/100 [19:39<10:08, 16.44s/it]Running generate_until requests:  64%|██████▍   | 64/100 [19:59<10:24, 17.34s/it]Running generate_until requests:  65%|██████▌   | 65/100 [20:18<10:28, 17.96s/it]Running generate_until requests:  66%|██████▌   | 66/100 [20:30<09:08, 16.13s/it]Running generate_until requests:  67%|██████▋   | 67/100 [20:38<07:33, 13.74s/it]Running generate_until requests:  68%|██████▊   | 68/100 [20:57<08:13, 15.42s/it]Running generate_until requests:  69%|██████▉   | 69/100 [21:17<08:34, 16.60s/it]Running generate_until requests:  70%|███████   | 70/100 [21:36<08:42, 17.41s/it]Running generate_until requests:  71%|███████   | 71/100 [21:55<08:40, 17.94s/it]Running generate_until requests:  72%|███████▏  | 72/100 [22:06<07:18, 15.65s/it]Running generate_until requests:  73%|███████▎  | 73/100 [22:23<07:14, 16.10s/it]Running generate_until requests:  74%|███████▍  | 74/100 [22:42<07:22, 17.01s/it]Running generate_until requests:  75%|███████▌  | 75/100 [22:52<06:11, 14.86s/it]Running generate_until requests:  76%|███████▌  | 76/100 [23:09<06:11, 15.48s/it]Running generate_until requests:  77%|███████▋  | 77/100 [23:18<05:16, 13.76s/it]Running generate_until requests:  78%|███████▊  | 78/100 [23:38<05:38, 15.37s/it]Running generate_until requests:  79%|███████▉  | 79/100 [23:52<05:16, 15.09s/it]Running generate_until requests:  80%|████████  | 80/100 [24:03<04:40, 14.01s/it]Running generate_until requests:  81%|████████  | 81/100 [24:22<04:54, 15.48s/it]Running generate_until requests:  82%|████████▏ | 82/100 [24:41<04:56, 16.49s/it]Running generate_until requests:  83%|████████▎ | 83/100 [25:00<04:51, 17.17s/it]Running generate_until requests:  84%|████████▍ | 84/100 [25:09<03:56, 14.77s/it]Running generate_until requests:  85%|████████▌ | 85/100 [25:25<03:48, 15.21s/it]Running generate_until requests:  86%|████████▌ | 86/100 [25:44<03:47, 16.26s/it]Running generate_until requests:  87%|████████▋ | 87/100 [26:03<03:40, 16.97s/it]Running generate_until requests:  88%|████████▊ | 88/100 [26:15<03:08, 15.70s/it]Running generate_until requests:  89%|████████▉ | 89/100 [26:34<03:02, 16.55s/it]Running generate_until requests:  90%|█████████ | 90/100 [26:52<02:51, 17.13s/it]Running generate_until requests:  91%|█████████ | 91/100 [27:11<02:37, 17.53s/it]Running generate_until requests:  92%|█████████▏| 92/100 [27:20<01:59, 15.00s/it]Running generate_until requests:  93%|█████████▎| 93/100 [27:38<01:52, 16.03s/it]Running generate_until requests:  94%|█████████▍| 94/100 [27:57<01:40, 16.74s/it]Running generate_until requests:  95%|█████████▌| 95/100 [28:15<01:26, 17.22s/it]Running generate_until requests:  96%|█████████▌| 96/100 [28:33<01:09, 17.46s/it]Running generate_until requests:  97%|█████████▋| 97/100 [28:51<00:53, 17.71s/it]Running generate_until requests:  98%|█████████▊| 98/100 [29:10<00:35, 17.87s/it]Running generate_until requests:  99%|█████████▉| 99/100 [29:18<00:15, 15.10s/it]Running generate_until requests: 100%|██████████| 100/100 [29:29<00:00, 13.75s/it]Running generate_until requests: 100%|██████████| 100/100 [29:29<00:00, 17.69s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:16:36:05,427 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:16:36:05,488 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:16:36:48,628 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:16:37:03,962 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:16:37:03,963 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:16:37:03,976 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:16:37:03,977 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:16:37:03,977 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:16:37:04,240 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:16:37:04,449 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:16:37:04,924 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.07s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.12it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.19it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.24it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.27it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.30it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.32it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.57it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.34it/s]
2025-01-06:16:37:16,621 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:16:37:16,624 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 331.73it/s] 69%|██████▉   | 69/100 [00:00<00:00, 337.43it/s]100%|██████████| 100/100 [00:00<00:00, 338.53it/s]
2025-01-06:16:37:16,924 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:23<39:09, 23.73s/it]Running generate_until requests:   2%|▏         | 2/100 [00:43<34:29, 21.11s/it]Running generate_until requests:   3%|▎         | 3/100 [01:05<35:17, 21.83s/it]Running generate_until requests:   4%|▍         | 4/100 [01:27<35:11, 22.00s/it]Running generate_until requests:   5%|▌         | 5/100 [01:45<32:26, 20.49s/it]Running generate_until requests:   6%|▌         | 6/100 [02:07<32:44, 20.90s/it]Running generate_until requests:   7%|▋         | 7/100 [02:25<30:46, 19.85s/it]Running generate_until requests:   8%|▊         | 8/100 [02:43<29:31, 19.26s/it]Running generate_until requests:   9%|▉         | 9/100 [03:04<30:20, 20.00s/it]Running generate_until requests:  10%|█         | 10/100 [03:26<30:44, 20.49s/it]Running generate_until requests:  11%|█         | 11/100 [03:47<30:51, 20.80s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:09<30:48, 21.01s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:27<29:01, 20.02s/it]Running generate_until requests:  14%|█▍        | 14/100 [04:48<29:15, 20.41s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:09<29:15, 20.66s/it]Running generate_until requests:  16%|█▌        | 16/100 [05:30<29:07, 20.80s/it]Running generate_until requests:  17%|█▋        | 17/100 [05:51<28:52, 20.88s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:12<28:34, 20.91s/it]Running generate_until requests:  19%|█▉        | 19/100 [06:33<28:13, 20.90s/it]Running generate_until requests:  20%|██        | 20/100 [06:54<27:51, 20.89s/it]Running generate_until requests:  21%|██        | 21/100 [07:10<25:43, 19.53s/it]Running generate_until requests:  22%|██▏       | 22/100 [07:31<25:49, 19.87s/it]Running generate_until requests:  23%|██▎       | 23/100 [07:52<25:47, 20.09s/it]Running generate_until requests:  24%|██▍       | 24/100 [08:12<25:38, 20.24s/it]Running generate_until requests:  25%|██▌       | 25/100 [08:24<21:56, 17.55s/it]Running generate_until requests:  26%|██▌       | 26/100 [08:44<22:45, 18.46s/it]Running generate_until requests:  27%|██▋       | 27/100 [09:05<23:14, 19.10s/it]Running generate_until requests:  28%|██▊       | 28/100 [09:16<20:05, 16.75s/it]Running generate_until requests:  29%|██▉       | 29/100 [09:37<21:10, 17.89s/it]Running generate_until requests:  30%|███       | 30/100 [09:57<21:46, 18.67s/it]Running generate_until requests:  31%|███       | 31/100 [10:08<18:39, 16.23s/it]Running generate_until requests:  32%|███▏      | 32/100 [10:28<19:42, 17.38s/it]Running generate_until requests:  33%|███▎      | 33/100 [10:33<15:30, 13.89s/it]Running generate_until requests:  34%|███▍      | 34/100 [10:54<17:25, 15.84s/it]Running generate_until requests:  35%|███▌      | 35/100 [11:08<16:33, 15.28s/it]Running generate_until requests:  36%|███▌      | 36/100 [11:28<17:55, 16.80s/it]Running generate_until requests:  37%|███▋      | 37/100 [11:48<18:44, 17.85s/it]Running generate_until requests:  38%|███▊      | 38/100 [12:09<19:12, 18.59s/it]Running generate_until requests:  39%|███▉      | 39/100 [12:29<19:25, 19.10s/it]Running generate_until requests:  40%|████      | 40/100 [12:49<19:25, 19.43s/it]Running generate_until requests:  41%|████      | 41/100 [13:09<19:20, 19.68s/it]Running generate_until requests:  42%|████▏     | 42/100 [13:28<18:43, 19.38s/it]Running generate_until requests:  43%|████▎     | 43/100 [13:48<18:39, 19.63s/it]Running generate_until requests:  44%|████▍     | 44/100 [14:09<18:28, 19.80s/it]Running generate_until requests:  45%|████▌     | 45/100 [14:29<18:14, 19.91s/it]Running generate_until requests:  46%|████▌     | 46/100 [14:39<15:25, 17.13s/it]Running generate_until requests:  47%|████▋     | 47/100 [14:59<15:54, 18.00s/it]Running generate_until requests:  48%|████▊     | 48/100 [15:19<16:06, 18.58s/it]Running generate_until requests:  49%|████▉     | 49/100 [15:39<16:08, 18.98s/it]Running generate_until requests:  50%|█████     | 50/100 [15:58<15:44, 18.88s/it]Running generate_until requests:  51%|█████     | 51/100 [16:18<15:39, 19.18s/it]Running generate_until requests:  52%|█████▏    | 52/100 [16:38<15:30, 19.38s/it]Running generate_until requests:  53%|█████▎    | 53/100 [16:57<15:15, 19.49s/it]Running generate_until requests:  54%|█████▍    | 54/100 [17:17<14:59, 19.56s/it]Running generate_until requests:  55%|█████▌    | 55/100 [17:27<12:35, 16.79s/it]Running generate_until requests:  56%|█████▌    | 56/100 [17:47<12:57, 17.66s/it]Running generate_until requests:  57%|█████▋    | 57/100 [18:02<12:02, 16.81s/it]Running generate_until requests:  58%|█████▊    | 58/100 [18:22<12:22, 17.67s/it]Running generate_until requests:  59%|█████▉    | 59/100 [18:41<12:28, 18.26s/it]Running generate_until requests:  60%|██████    | 60/100 [19:01<12:26, 18.67s/it]Running generate_until requests:  61%|██████    | 61/100 [19:14<11:08, 17.15s/it]Running generate_until requests:  62%|██████▏   | 62/100 [19:25<09:38, 15.23s/it]Running generate_until requests:  63%|██████▎   | 63/100 [19:45<10:11, 16.52s/it]Running generate_until requests:  64%|██████▍   | 64/100 [20:04<10:27, 17.43s/it]Running generate_until requests:  65%|██████▌   | 65/100 [20:24<10:31, 18.05s/it]Running generate_until requests:  66%|██████▌   | 66/100 [20:36<09:11, 16.21s/it]Running generate_until requests:  67%|██████▋   | 67/100 [20:44<07:35, 13.80s/it]Running generate_until requests:  68%|██████▊   | 68/100 [21:03<08:15, 15.50s/it]Running generate_until requests:  69%|██████▉   | 69/100 [21:23<08:37, 16.68s/it]Running generate_until requests:  70%|███████   | 70/100 [21:42<08:44, 17.49s/it]Running generate_until requests:  71%|███████   | 71/100 [22:01<08:42, 18.03s/it]Running generate_until requests:  72%|███████▏  | 72/100 [22:12<07:20, 15.73s/it]Running generate_until requests:  73%|███████▎  | 73/100 [22:29<07:16, 16.18s/it]Running generate_until requests:  74%|███████▍  | 74/100 [22:48<07:24, 17.10s/it]Running generate_until requests:  75%|███████▌  | 75/100 [22:58<06:13, 14.94s/it]Running generate_until requests:  76%|███████▌  | 76/100 [23:15<06:13, 15.56s/it]Running generate_until requests:  77%|███████▋  | 77/100 [23:25<05:18, 13.84s/it]Running generate_until requests:  78%|███████▊  | 78/100 [23:44<05:39, 15.45s/it]Running generate_until requests:  79%|███████▉  | 79/100 [23:59<05:18, 15.17s/it]Running generate_until requests:  80%|████████  | 80/100 [24:10<04:41, 14.09s/it]Running generate_until requests:  81%|████████  | 81/100 [24:29<04:55, 15.56s/it]Running generate_until requests:  82%|████████▏ | 82/100 [24:48<04:58, 16.57s/it]Running generate_until requests:  83%|████████▎ | 83/100 [25:07<04:53, 17.26s/it]Running generate_until requests:  84%|████████▍ | 84/100 [25:16<03:57, 14.85s/it]Running generate_until requests:  85%|████████▌ | 85/100 [25:33<03:49, 15.30s/it]Running generate_until requests:  86%|████████▌ | 86/100 [25:52<03:49, 16.37s/it]Running generate_until requests:  87%|████████▋ | 87/100 [26:10<03:42, 17.08s/it]Running generate_until requests:  88%|████████▊ | 88/100 [26:23<03:09, 15.80s/it]Running generate_until requests:  89%|████████▉ | 89/100 [26:42<03:03, 16.64s/it]Running generate_until requests:  90%|█████████ | 90/100 [27:00<02:52, 17.23s/it]Running generate_until requests:  91%|█████████ | 91/100 [27:19<02:38, 17.63s/it]Running generate_until requests:  92%|█████████▏| 92/100 [27:28<02:00, 15.08s/it]Running generate_until requests:  93%|█████████▎| 93/100 [27:47<01:52, 16.11s/it]Running generate_until requests:  94%|█████████▍| 94/100 [28:05<01:41, 16.84s/it]Running generate_until requests:  95%|█████████▌| 95/100 [28:24<01:26, 17.32s/it]Running generate_until requests:  96%|█████████▌| 96/100 [28:42<01:10, 17.56s/it]Running generate_until requests:  97%|█████████▋| 97/100 [29:00<00:53, 17.81s/it]Running generate_until requests:  98%|█████████▊| 98/100 [29:18<00:35, 17.97s/it]Running generate_until requests:  99%|█████████▉| 99/100 [29:27<00:15, 15.19s/it]Running generate_until requests: 100%|██████████| 100/100 [29:38<00:00, 13.83s/it]Running generate_until requests: 100%|██████████| 100/100 [29:38<00:00, 17.78s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:17:07:00,673 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:17:07:00,753 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:17:07:43,435 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:17:07:58,680 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:17:07:58,682 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:17:07:58,695 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:17:07:58,695 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:17:07:58,696 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:17:07:58,962 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:17:07:59,257 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:17:07:59,621 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.06s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.16it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:03,  1.25it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.26it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.29it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.30it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.33it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.56it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.35it/s]
2025-01-06:17:08:10,732 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:17:08:10,735 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 344.19it/s] 70%|███████   | 70/100 [00:00<00:00, 346.20it/s]100%|██████████| 100/100 [00:00<00:00, 343.88it/s]
2025-01-06:17:08:11,030 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:23<38:59, 23.63s/it]Running generate_until requests:   2%|▏         | 2/100 [00:42<34:20, 21.02s/it]Running generate_until requests:   3%|▎         | 3/100 [01:05<35:07, 21.73s/it]Running generate_until requests:   4%|▍         | 4/100 [01:27<35:02, 21.90s/it]Running generate_until requests:   5%|▌         | 5/100 [01:45<32:17, 20.39s/it]Running generate_until requests:   6%|▌         | 6/100 [02:06<32:35, 20.80s/it]Running generate_until requests:   7%|▋         | 7/100 [02:24<30:37, 19.76s/it]Running generate_until requests:   8%|▊         | 8/100 [02:42<29:23, 19.17s/it]Running generate_until requests:   9%|▉         | 9/100 [03:03<30:11, 19.91s/it]Running generate_until requests:  10%|█         | 10/100 [03:25<30:35, 20.39s/it]Running generate_until requests:  11%|█         | 11/100 [03:46<30:42, 20.70s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:08<30:39, 20.91s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:25<28:53, 19.92s/it]Running generate_until requests:  14%|█▍        | 14/100 [04:47<29:07, 20.32s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:08<29:07, 20.56s/it]Running generate_until requests:  16%|█▌        | 16/100 [05:29<28:58, 20.70s/it]Running generate_until requests:  17%|█▋        | 17/100 [05:50<28:43, 20.77s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:11<28:26, 20.81s/it]Running generate_until requests:  19%|█▉        | 19/100 [06:31<28:04, 20.80s/it]Running generate_until requests:  20%|██        | 20/100 [06:52<27:43, 20.79s/it]Running generate_until requests:  21%|██        | 21/100 [07:08<25:35, 19.44s/it]Running generate_until requests:  22%|██▏       | 22/100 [07:29<25:42, 19.77s/it]Running generate_until requests:  23%|██▎       | 23/100 [07:49<25:39, 19.99s/it]Running generate_until requests:  24%|██▍       | 24/100 [08:10<25:30, 20.14s/it]Running generate_until requests:  25%|██▌       | 25/100 [08:21<21:49, 17.46s/it]Running generate_until requests:  26%|██▌       | 26/100 [08:42<22:39, 18.37s/it]Running generate_until requests:  27%|██▋       | 27/100 [09:02<23:07, 19.00s/it]Running generate_until requests:  28%|██▊       | 28/100 [09:13<19:59, 16.67s/it]Running generate_until requests:  29%|██▉       | 29/100 [09:34<21:03, 17.80s/it]Running generate_until requests:  30%|███       | 30/100 [09:54<21:40, 18.58s/it]Running generate_until requests:  31%|███       | 31/100 [10:05<18:33, 16.14s/it]Running generate_until requests:  32%|███▏      | 32/100 [10:25<19:36, 17.30s/it]Running generate_until requests:  33%|███▎      | 33/100 [10:30<15:26, 13.82s/it]Running generate_until requests:  34%|███▍      | 34/100 [10:51<17:20, 15.76s/it]Running generate_until requests:  35%|███▌      | 35/100 [11:05<16:28, 15.20s/it]Running generate_until requests:  36%|███▌      | 36/100 [11:25<17:49, 16.71s/it]Running generate_until requests:  37%|███▋      | 37/100 [11:45<18:39, 17.76s/it]Running generate_until requests:  38%|███▊      | 38/100 [12:05<19:06, 18.49s/it]Running generate_until requests:  39%|███▉      | 39/100 [12:25<19:19, 19.00s/it]Running generate_until requests:  40%|████      | 40/100 [12:45<19:20, 19.33s/it]Running generate_until requests:  41%|████      | 41/100 [13:06<19:15, 19.58s/it]Running generate_until requests:  42%|████▏     | 42/100 [13:24<18:38, 19.28s/it]Running generate_until requests:  43%|████▎     | 43/100 [13:44<18:33, 19.53s/it]Running generate_until requests:  44%|████▍     | 44/100 [14:04<18:23, 19.70s/it]Running generate_until requests:  45%|████▌     | 45/100 [14:24<18:09, 19.81s/it]Running generate_until requests:  46%|████▌     | 46/100 [14:35<15:20, 17.05s/it]Running generate_until requests:  47%|████▋     | 47/100 [14:55<15:50, 17.94s/it]Running generate_until requests:  48%|████▊     | 48/100 [15:15<16:02, 18.52s/it]Running generate_until requests:  49%|████▉     | 49/100 [15:35<16:03, 18.90s/it]Running generate_until requests:  50%|█████     | 50/100 [15:53<15:39, 18.80s/it]Running generate_until requests:  51%|█████     | 51/100 [16:13<15:35, 19.09s/it]Running generate_until requests:  52%|█████▏    | 52/100 [16:33<15:25, 19.28s/it]Running generate_until requests:  53%|█████▎    | 53/100 [16:52<15:11, 19.39s/it]Running generate_until requests:  54%|█████▍    | 54/100 [17:12<14:55, 19.46s/it]Running generate_until requests:  55%|█████▌    | 55/100 [17:22<12:31, 16.70s/it]Running generate_until requests:  56%|█████▌    | 56/100 [17:42<12:52, 17.57s/it]Running generate_until requests:  57%|█████▋    | 57/100 [17:57<11:59, 16.72s/it]Running generate_until requests:  58%|█████▊    | 58/100 [18:16<12:18, 17.58s/it]Running generate_until requests:  59%|█████▉    | 59/100 [18:36<12:24, 18.17s/it]Running generate_until requests:  60%|██████    | 60/100 [18:55<12:22, 18.57s/it]Running generate_until requests:  61%|██████    | 61/100 [19:09<11:05, 17.06s/it]Running generate_until requests:  62%|██████▏   | 62/100 [19:20<09:35, 15.15s/it]Running generate_until requests:  63%|██████▎   | 63/100 [19:39<10:07, 16.43s/it]Running generate_until requests:  64%|██████▍   | 64/100 [19:58<10:23, 17.33s/it]Running generate_until requests:  65%|██████▌   | 65/100 [20:18<10:28, 17.95s/it]Running generate_until requests:  66%|██████▌   | 66/100 [20:30<09:08, 16.12s/it]Running generate_until requests:  67%|██████▋   | 67/100 [20:38<07:33, 13.73s/it]Running generate_until requests:  68%|██████▊   | 68/100 [20:57<08:13, 15.41s/it]Running generate_until requests:  69%|██████▉   | 69/100 [21:16<08:34, 16.59s/it]Running generate_until requests:  70%|███████   | 70/100 [21:36<08:41, 17.40s/it]Running generate_until requests:  71%|███████   | 71/100 [21:55<08:40, 17.93s/it]Running generate_until requests:  72%|███████▏  | 72/100 [22:05<07:17, 15.64s/it]Running generate_until requests:  73%|███████▎  | 73/100 [22:22<07:14, 16.09s/it]Running generate_until requests:  74%|███████▍  | 74/100 [22:41<07:22, 17.00s/it]Running generate_until requests:  75%|███████▌  | 75/100 [22:51<06:11, 14.86s/it]Running generate_until requests:  76%|███████▌  | 76/100 [23:08<06:11, 15.47s/it]Running generate_until requests:  77%|███████▋  | 77/100 [23:18<05:16, 13.76s/it]Running generate_until requests:  78%|███████▊  | 78/100 [23:37<05:37, 15.36s/it]Running generate_until requests:  79%|███████▉  | 79/100 [23:52<05:16, 15.08s/it]Running generate_until requests:  80%|████████  | 80/100 [24:03<04:40, 14.01s/it]Running generate_until requests:  81%|████████  | 81/100 [24:22<04:53, 15.47s/it]Running generate_until requests:  82%|████████▏ | 82/100 [24:41<04:56, 16.48s/it]Running generate_until requests:  83%|████████▎ | 83/100 [24:59<04:51, 17.17s/it]Running generate_until requests:  84%|████████▍ | 84/100 [25:09<03:56, 14.77s/it]Running generate_until requests:  85%|████████▌ | 85/100 [25:25<03:48, 15.21s/it]Running generate_until requests:  86%|████████▌ | 86/100 [25:44<03:47, 16.25s/it]Running generate_until requests:  87%|████████▋ | 87/100 [26:02<03:40, 16.96s/it]Running generate_until requests:  88%|████████▊ | 88/100 [26:15<03:08, 15.70s/it]Running generate_until requests:  89%|████████▉ | 89/100 [26:33<03:01, 16.54s/it]Running generate_until requests:  90%|█████████ | 90/100 [26:52<02:51, 17.12s/it]Running generate_until requests:  91%|█████████ | 91/100 [27:10<02:37, 17.52s/it]Running generate_until requests:  92%|█████████▏| 92/100 [27:19<01:59, 14.99s/it]Running generate_until requests:  93%|█████████▎| 93/100 [27:38<01:52, 16.02s/it]Running generate_until requests:  94%|█████████▍| 94/100 [27:56<01:40, 16.74s/it]Running generate_until requests:  95%|█████████▌| 95/100 [28:15<01:26, 17.21s/it]Running generate_until requests:  96%|█████████▌| 96/100 [28:33<01:09, 17.46s/it]Running generate_until requests:  97%|█████████▋| 97/100 [28:51<00:53, 17.70s/it]Running generate_until requests:  98%|█████████▊| 98/100 [29:09<00:35, 17.87s/it]Running generate_until requests:  99%|█████████▉| 99/100 [29:18<00:15, 15.10s/it]Running generate_until requests: 100%|██████████| 100/100 [29:28<00:00, 13.75s/it]Running generate_until requests: 100%|██████████| 100/100 [29:28<00:00, 17.69s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:17:37:45,950 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:17:37:46,036 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:17:38:28,944 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:17:38:43,698 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:17:38:43,700 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:17:38:43,713 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:17:38:43,713 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:17:38:43,713 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:17:38:43,978 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:17:38:44,169 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:17:38:44,528 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:09,  1.37s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:02<00:06,  1.01s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.11it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.20it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.25it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:05<00:01,  1.26it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.29it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.54it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.28it/s]
2025-01-06:17:38:55,874 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:17:38:55,878 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 341.44it/s] 71%|███████   | 71/100 [00:00<00:00, 347.41it/s]100%|██████████| 100/100 [00:00<00:00, 347.53it/s]
2025-01-06:17:38:56,171 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:23<39:08, 23.73s/it]Running generate_until requests:   2%|▏         | 2/100 [00:43<34:28, 21.11s/it]Running generate_until requests:   3%|▎         | 3/100 [01:05<35:16, 21.82s/it]Running generate_until requests:   4%|▍         | 4/100 [01:27<35:11, 21.99s/it]Running generate_until requests:   5%|▌         | 5/100 [01:45<32:25, 20.48s/it]Running generate_until requests:   6%|▌         | 6/100 [02:07<32:43, 20.89s/it]Running generate_until requests:   7%|▋         | 7/100 [02:25<30:45, 19.84s/it]Running generate_until requests:   8%|▊         | 8/100 [02:43<29:30, 19.25s/it]Running generate_until requests:   9%|▉         | 9/100 [03:04<30:19, 19.99s/it]Running generate_until requests:  10%|█         | 10/100 [03:26<30:43, 20.48s/it]Running generate_until requests:  11%|█         | 11/100 [03:47<30:50, 20.79s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:09<30:48, 21.01s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:27<29:01, 20.02s/it]Running generate_until requests:  14%|█▍        | 14/100 [04:48<29:15, 20.41s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:09<29:15, 20.65s/it]Running generate_until requests:  16%|█▌        | 16/100 [05:30<29:06, 20.80s/it]Running generate_until requests:  17%|█▋        | 17/100 [05:51<28:52, 20.87s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:12<28:34, 20.91s/it]Running generate_until requests:  19%|█▉        | 19/100 [06:33<28:12, 20.90s/it]Running generate_until requests:  20%|██        | 20/100 [06:54<27:50, 20.89s/it]Running generate_until requests:  21%|██        | 21/100 [07:10<25:42, 19.53s/it]Running generate_until requests:  22%|██▏       | 22/100 [07:31<25:49, 19.86s/it]Running generate_until requests:  23%|██▎       | 23/100 [07:52<25:46, 20.09s/it]Running generate_until requests:  24%|██▍       | 24/100 [08:12<25:37, 20.24s/it]Running generate_until requests:  25%|██▌       | 25/100 [08:23<21:55, 17.55s/it]Running generate_until requests:  26%|██▌       | 26/100 [08:44<22:45, 18.45s/it]Running generate_until requests:  27%|██▋       | 27/100 [09:05<23:13, 19.09s/it]Running generate_until requests:  28%|██▊       | 28/100 [09:16<20:05, 16.74s/it]Running generate_until requests:  29%|██▉       | 29/100 [09:36<21:09, 17.88s/it]Running generate_until requests:  30%|███       | 30/100 [09:57<21:46, 18.66s/it]Running generate_until requests:  31%|███       | 31/100 [10:07<18:39, 16.22s/it]Running generate_until requests:  32%|███▏      | 32/100 [10:27<19:41, 17.38s/it]Running generate_until requests:  33%|███▎      | 33/100 [10:33<15:30, 13.89s/it]Running generate_until requests:  34%|███▍      | 34/100 [10:54<17:24, 15.83s/it]Running generate_until requests:  35%|███▌      | 35/100 [11:08<16:32, 15.27s/it]Running generate_until requests:  36%|███▌      | 36/100 [11:28<17:54, 16.79s/it]Running generate_until requests:  37%|███▋      | 37/100 [11:48<18:44, 17.84s/it]Running generate_until requests:  38%|███▊      | 38/100 [12:08<19:11, 18.58s/it]Running generate_until requests:  39%|███▉      | 39/100 [12:29<19:24, 19.09s/it]Running generate_until requests:  40%|████      | 40/100 [12:49<19:25, 19.42s/it]Running generate_until requests:  41%|████      | 41/100 [13:09<19:20, 19.67s/it]Running generate_until requests:  42%|████▏     | 42/100 [13:28<18:43, 19.37s/it]Running generate_until requests:  43%|████▎     | 43/100 [13:48<18:38, 19.63s/it]Running generate_until requests:  44%|████▍     | 44/100 [14:08<18:28, 19.80s/it]Running generate_until requests:  45%|████▌     | 45/100 [14:28<18:14, 19.90s/it]Running generate_until requests:  46%|████▌     | 46/100 [14:39<15:24, 17.13s/it]Running generate_until requests:  47%|████▋     | 47/100 [14:59<15:53, 18.00s/it]Running generate_until requests:  48%|████▊     | 48/100 [15:19<16:06, 18.58s/it]Running generate_until requests:  49%|████▉     | 49/100 [15:39<16:07, 18.97s/it]Running generate_until requests:  50%|█████     | 50/100 [15:58<15:43, 18.88s/it]Running generate_until requests:  51%|█████     | 51/100 [16:17<15:39, 19.17s/it]Running generate_until requests:  52%|█████▏    | 52/100 [16:37<15:29, 19.37s/it]Running generate_until requests:  53%|█████▎    | 53/100 [16:57<15:15, 19.48s/it]Running generate_until requests:  54%|█████▍    | 54/100 [17:17<14:59, 19.56s/it]Running generate_until requests:  55%|█████▌    | 55/100 [17:27<12:35, 16.79s/it]Running generate_until requests:  56%|█████▌    | 56/100 [17:47<12:56, 17.66s/it]Running generate_until requests:  57%|█████▋    | 57/100 [18:02<12:02, 16.81s/it]Running generate_until requests:  58%|█████▊    | 58/100 [18:21<12:22, 17.67s/it]Running generate_until requests:  59%|█████▉    | 59/100 [18:41<12:28, 18.26s/it]Running generate_until requests:  60%|██████    | 60/100 [19:01<12:26, 18.67s/it]Running generate_until requests:  61%|██████    | 61/100 [19:14<11:08, 17.15s/it]Running generate_until requests:  62%|██████▏   | 62/100 [19:25<09:38, 15.23s/it]Running generate_until requests:  63%|██████▎   | 63/100 [19:44<10:11, 16.52s/it]Running generate_until requests:  64%|██████▍   | 64/100 [20:04<10:27, 17.42s/it]Running generate_until requests:  65%|██████▌   | 65/100 [20:23<10:31, 18.04s/it]Running generate_until requests:  66%|██████▌   | 66/100 [20:35<09:10, 16.21s/it]Running generate_until requests:  67%|██████▋   | 67/100 [20:44<07:35, 13.80s/it]Running generate_until requests:  68%|██████▊   | 68/100 [21:03<08:15, 15.49s/it]Running generate_until requests:  69%|██████▉   | 69/100 [21:22<08:36, 16.68s/it]Running generate_until requests:  70%|███████   | 70/100 [21:42<08:44, 17.49s/it]Running generate_until requests:  71%|███████   | 71/100 [22:01<08:42, 18.03s/it]Running generate_until requests:  72%|███████▏  | 72/100 [22:11<07:20, 15.72s/it]Running generate_until requests:  73%|███████▎  | 73/100 [22:29<07:16, 16.18s/it]Running generate_until requests:  74%|███████▍  | 74/100 [22:48<07:24, 17.09s/it]Running generate_until requests:  75%|███████▌  | 75/100 [22:58<06:13, 14.93s/it]Running generate_until requests:  76%|███████▌  | 76/100 [23:15<06:13, 15.55s/it]Running generate_until requests:  77%|███████▋  | 77/100 [23:25<05:18, 13.83s/it]Running generate_until requests:  78%|███████▊  | 78/100 [23:44<05:39, 15.44s/it]Running generate_until requests:  79%|███████▉  | 79/100 [23:58<05:18, 15.17s/it]Running generate_until requests:  80%|████████  | 80/100 [24:10<04:41, 14.09s/it]Running generate_until requests:  81%|████████  | 81/100 [24:29<04:55, 15.56s/it]Running generate_until requests:  82%|████████▏ | 82/100 [24:48<04:58, 16.57s/it]Running generate_until requests:  83%|████████▎ | 83/100 [25:07<04:53, 17.26s/it]Running generate_until requests:  84%|████████▍ | 84/100 [25:16<03:57, 14.84s/it]Running generate_until requests:  85%|████████▌ | 85/100 [25:32<03:49, 15.29s/it]Running generate_until requests:  86%|████████▌ | 86/100 [25:51<03:48, 16.35s/it]Running generate_until requests:  87%|████████▋ | 87/100 [26:10<03:41, 17.07s/it]Running generate_until requests:  88%|████████▊ | 88/100 [26:23<03:09, 15.80s/it]Running generate_until requests:  89%|████████▉ | 89/100 [26:41<03:02, 16.64s/it]Running generate_until requests:  90%|█████████ | 90/100 [27:00<02:52, 17.22s/it]Running generate_until requests:  91%|█████████ | 91/100 [27:18<02:38, 17.62s/it]Running generate_until requests:  92%|█████████▏| 92/100 [27:27<02:00, 15.08s/it]Running generate_until requests:  93%|█████████▎| 93/100 [27:46<01:52, 16.11s/it]Running generate_until requests:  94%|█████████▍| 94/100 [28:04<01:40, 16.83s/it]Running generate_until requests:  95%|█████████▌| 95/100 [28:23<01:26, 17.31s/it]Running generate_until requests:  96%|█████████▌| 96/100 [28:41<01:10, 17.56s/it]Running generate_until requests:  97%|█████████▋| 97/100 [28:59<00:53, 17.80s/it]Running generate_until requests:  98%|█████████▊| 98/100 [29:18<00:35, 17.97s/it]Running generate_until requests:  99%|█████████▉| 99/100 [29:26<00:15, 15.18s/it]Running generate_until requests: 100%|██████████| 100/100 [29:37<00:00, 13.82s/it]Running generate_until requests: 100%|██████████| 100/100 [29:37<00:00, 17.78s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:18:08:39,504 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:18:08:39,575 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:18:10:32,698 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:18:10:47,603 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:18:10:47,605 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:18:10:47,615 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:18:10:47,615 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:18:10:47,616 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:18:10:47,887 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:18:10:48,083 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:18:10:48,452 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.07s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.11it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.20it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.24it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.26it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.29it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.32it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.57it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.34it/s]
2025-01-06:18:10:59,159 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:18:10:59,162 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 339.48it/s] 69%|██████▉   | 69/100 [00:00<00:00, 343.84it/s]100%|██████████| 100/100 [00:00<00:00, 344.69it/s]
2025-01-06:18:10:59,458 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:27<44:36, 27.03s/it]Running generate_until requests:   2%|▏         | 2/100 [00:48<38:57, 23.85s/it]Running generate_until requests:   3%|▎         | 3/100 [01:14<39:58, 24.72s/it]Running generate_until requests:   4%|▍         | 4/100 [01:39<39:57, 24.97s/it]Running generate_until requests:   5%|▌         | 5/100 [02:04<39:27, 24.92s/it]Running generate_until requests:   6%|▌         | 6/100 [02:29<38:55, 24.85s/it]Running generate_until requests:   7%|▋         | 7/100 [02:53<38:24, 24.78s/it]Running generate_until requests:   8%|▊         | 8/100 [03:14<35:53, 23.40s/it]Running generate_until requests:   9%|▉         | 9/100 [03:38<36:03, 23.77s/it]Running generate_until requests:  10%|█         | 10/100 [04:03<36:00, 24.01s/it]Running generate_until requests:  11%|█         | 11/100 [04:27<35:46, 24.12s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:36<28:13, 19.25s/it]Running generate_until requests:  13%|█▎        | 13/100 [05:00<30:07, 20.78s/it]Running generate_until requests:  14%|█▍        | 14/100 [05:24<31:15, 21.81s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:48<31:51, 22.49s/it]Running generate_until requests:  16%|█▌        | 16/100 [06:12<32:06, 22.94s/it]Running generate_until requests:  17%|█▋        | 17/100 [06:36<32:06, 23.21s/it]Running generate_until requests:  18%|█▊        | 18/100 [07:00<31:58, 23.39s/it]Running generate_until requests:  19%|█▉        | 19/100 [07:23<31:42, 23.49s/it]Running generate_until requests:  20%|██        | 20/100 [07:47<31:24, 23.55s/it]Running generate_until requests:  21%|██        | 21/100 [08:11<30:59, 23.54s/it]Running generate_until requests:  22%|██▏       | 22/100 [08:34<30:33, 23.51s/it]Running generate_until requests:  23%|██▎       | 23/100 [08:57<30:05, 23.45s/it]Running generate_until requests:  24%|██▍       | 24/100 [09:21<29:39, 23.42s/it]Running generate_until requests:  25%|██▌       | 25/100 [09:35<25:50, 20.67s/it]Running generate_until requests:  26%|██▌       | 26/100 [09:58<26:28, 21.46s/it]Running generate_until requests:  27%|██▋       | 27/100 [10:22<26:46, 22.01s/it]Running generate_until requests:  28%|██▊       | 28/100 [10:38<24:28, 20.39s/it]Running generate_until requests:  29%|██▉       | 29/100 [11:01<25:09, 21.26s/it]Running generate_until requests:  30%|███       | 30/100 [11:25<25:29, 21.85s/it]Running generate_until requests:  31%|███       | 31/100 [11:48<25:35, 22.26s/it]Running generate_until requests:  32%|███▏      | 32/100 [12:07<24:16, 21.42s/it]Running generate_until requests:  33%|███▎      | 33/100 [12:30<24:28, 21.92s/it]Running generate_until requests:  34%|███▍      | 34/100 [12:54<24:29, 22.26s/it]Running generate_until requests:  35%|███▌      | 35/100 [13:09<22:02, 20.35s/it]Running generate_until requests:  36%|███▌      | 36/100 [13:32<22:33, 21.15s/it]Running generate_until requests:  37%|███▋      | 37/100 [13:55<22:47, 21.71s/it]Running generate_until requests:  38%|███▊      | 38/100 [14:18<22:49, 22.09s/it]Running generate_until requests:  39%|███▉      | 39/100 [14:36<21:03, 20.71s/it]Running generate_until requests:  40%|████      | 40/100 [14:59<21:21, 21.36s/it]Running generate_until requests:  41%|████      | 41/100 [15:22<21:27, 21.82s/it]Running generate_until requests:  42%|████▏     | 42/100 [15:45<21:23, 22.14s/it]Running generate_until requests:  43%|████▎     | 43/100 [16:07<21:14, 22.35s/it]Running generate_until requests:  44%|████▍     | 44/100 [16:30<21:00, 22.50s/it]Running generate_until requests:  45%|████▌     | 45/100 [16:53<20:41, 22.58s/it]Running generate_until requests:  46%|████▌     | 46/100 [17:05<17:26, 19.37s/it]Running generate_until requests:  47%|████▋     | 47/100 [17:28<17:59, 20.37s/it]Running generate_until requests:  48%|████▊     | 48/100 [17:50<18:13, 21.03s/it]Running generate_until requests:  49%|████▉     | 49/100 [18:13<18:15, 21.48s/it]Running generate_until requests:  50%|█████     | 50/100 [18:35<18:09, 21.79s/it]Running generate_until requests:  51%|█████     | 51/100 [18:58<17:58, 22.00s/it]Running generate_until requests:  52%|█████▏    | 52/100 [19:20<17:42, 22.14s/it]Running generate_until requests:  53%|█████▎    | 53/100 [19:43<17:23, 22.20s/it]Running generate_until requests:  54%|█████▍    | 54/100 [20:05<17:03, 22.25s/it]Running generate_until requests:  55%|█████▌    | 55/100 [20:17<14:30, 19.34s/it]Running generate_until requests:  56%|█████▌    | 56/100 [20:40<14:50, 20.24s/it]Running generate_until requests:  57%|█████▋    | 57/100 [21:02<14:57, 20.86s/it]Running generate_until requests:  58%|█████▊    | 58/100 [21:16<13:08, 18.77s/it]Running generate_until requests:  59%|█████▉    | 59/100 [21:38<13:31, 19.80s/it]Running generate_until requests:  60%|██████    | 60/100 [22:00<13:41, 20.53s/it]Running generate_until requests:  61%|██████    | 61/100 [22:23<13:40, 21.03s/it]Running generate_until requests:  62%|██████▏   | 62/100 [22:35<11:39, 18.41s/it]Running generate_until requests:  63%|██████▎   | 63/100 [22:57<12:03, 19.54s/it]Running generate_until requests:  64%|██████▍   | 64/100 [23:19<12:11, 20.31s/it]Running generate_until requests:  65%|██████▌   | 65/100 [23:41<12:09, 20.85s/it]Running generate_until requests:  66%|██████▌   | 66/100 [23:54<10:30, 18.55s/it]Running generate_until requests:  67%|██████▋   | 67/100 [24:16<10:46, 19.58s/it]Running generate_until requests:  68%|██████▊   | 68/100 [24:38<10:49, 20.30s/it]Running generate_until requests:  69%|██████▉   | 69/100 [25:00<10:44, 20.80s/it]Running generate_until requests:  70%|███████   | 70/100 [25:22<10:34, 21.14s/it]Running generate_until requests:  71%|███████   | 71/100 [25:40<09:40, 20.01s/it]Running generate_until requests:  72%|███████▏  | 72/100 [25:51<08:10, 17.51s/it]Running generate_until requests:  73%|███████▎  | 73/100 [26:13<08:26, 18.77s/it]Running generate_until requests:  74%|███████▍  | 74/100 [26:35<08:30, 19.64s/it]Running generate_until requests:  75%|███████▌  | 75/100 [26:56<08:26, 20.25s/it]Running generate_until requests:  76%|███████▌  | 76/100 [27:16<07:58, 19.95s/it]Running generate_until requests:  77%|███████▋  | 77/100 [27:27<06:36, 17.24s/it]Running generate_until requests:  78%|███████▊  | 78/100 [27:39<05:49, 15.90s/it]Running generate_until requests:  79%|███████▉  | 79/100 [28:01<06:10, 17.62s/it]Running generate_until requests:  80%|████████  | 80/100 [28:22<06:15, 18.76s/it]Running generate_until requests:  81%|████████  | 81/100 [28:44<06:11, 19.54s/it]Running generate_until requests:  82%|████████▏ | 82/100 [29:05<06:01, 20.08s/it]Running generate_until requests:  83%|████████▎ | 83/100 [29:26<05:47, 20.45s/it]Running generate_until requests:  84%|████████▍ | 84/100 [29:36<04:34, 17.17s/it]Running generate_until requests:  85%|████████▌ | 85/100 [29:56<04:29, 17.97s/it]Running generate_until requests:  86%|████████▌ | 86/100 [30:17<04:25, 18.95s/it]Running generate_until requests:  87%|████████▋ | 87/100 [30:38<04:14, 19.61s/it]Running generate_until requests:  88%|████████▊ | 88/100 [30:52<03:34, 17.91s/it]Running generate_until requests:  89%|████████▉ | 89/100 [31:13<03:27, 18.83s/it]Running generate_until requests:  90%|█████████ | 90/100 [31:34<03:14, 19.49s/it]Running generate_until requests:  91%|█████████ | 91/100 [31:55<02:59, 19.92s/it]Running generate_until requests:  92%|█████████▏| 92/100 [32:06<02:17, 17.14s/it]Running generate_until requests:  93%|█████████▎| 93/100 [32:25<02:04, 17.79s/it]Running generate_until requests:  94%|█████████▍| 94/100 [32:46<01:52, 18.71s/it]Running generate_until requests:  95%|█████████▌| 95/100 [33:05<01:34, 18.93s/it]Running generate_until requests:  96%|█████████▌| 96/100 [33:26<01:17, 19.48s/it]Running generate_until requests:  97%|█████████▋| 97/100 [33:41<00:54, 18.13s/it]Running generate_until requests:  98%|█████████▊| 98/100 [34:02<00:37, 18.91s/it]Running generate_until requests:  99%|█████████▉| 99/100 [34:22<00:19, 19.43s/it]Running generate_until requests: 100%|██████████| 100/100 [34:43<00:00, 19.70s/it]Running generate_until requests: 100%|██████████| 100/100 [34:43<00:00, 20.83s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:18:45:48,387 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:18:45:48,424 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:18:46:31,441 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:18:46:46,549 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:18:46:46,551 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:18:46:46,562 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:18:46:46,563 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:18:46:46,563 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:18:46:46,838 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:18:46:47,043 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:18:46:47,415 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.08s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.13it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.20it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.25it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.30it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.30it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.53it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.33it/s]
2025-01-06:18:46:58,441 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:18:46:58,444 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 33%|███▎      | 33/100 [00:00<00:00, 325.13it/s] 68%|██████▊   | 68/100 [00:00<00:00, 338.14it/s]100%|██████████| 100/100 [00:00<00:00, 340.35it/s]
2025-01-06:18:46:58,743 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:27<44:36, 27.03s/it]Running generate_until requests:   2%|▏         | 2/100 [00:48<38:55, 23.83s/it]Running generate_until requests:   3%|▎         | 3/100 [01:14<39:54, 24.69s/it]Running generate_until requests:   4%|▍         | 4/100 [01:39<39:53, 24.93s/it]Running generate_until requests:   5%|▌         | 5/100 [02:04<39:22, 24.87s/it]Running generate_until requests:   6%|▌         | 6/100 [02:29<38:50, 24.79s/it]Running generate_until requests:   7%|▋         | 7/100 [02:53<38:18, 24.72s/it]Running generate_until requests:   8%|▊         | 8/100 [03:14<35:48, 23.35s/it]Running generate_until requests:   9%|▉         | 9/100 [03:38<35:58, 23.72s/it]Running generate_until requests:  10%|█         | 10/100 [04:03<35:56, 23.96s/it]Running generate_until requests:  11%|█         | 11/100 [04:27<35:42, 24.07s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:35<28:10, 19.21s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:59<30:04, 20.74s/it]Running generate_until requests:  14%|█▍        | 14/100 [05:23<31:11, 21.77s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:47<31:47, 22.45s/it]Running generate_until requests:  16%|█▌        | 16/100 [06:11<32:03, 22.90s/it]Running generate_until requests:  17%|█▋        | 17/100 [06:35<32:03, 23.17s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:59<31:54, 23.35s/it]Running generate_until requests:  19%|█▉        | 19/100 [07:23<31:38, 23.44s/it]Running generate_until requests:  20%|██        | 20/100 [07:46<31:20, 23.51s/it]Running generate_until requests:  21%|██        | 21/100 [08:10<30:55, 23.49s/it]Running generate_until requests:  22%|██▏       | 22/100 [08:33<30:29, 23.46s/it]Running generate_until requests:  23%|██▎       | 23/100 [08:56<30:02, 23.40s/it]Running generate_until requests:  24%|██▍       | 24/100 [09:20<29:35, 23.37s/it]Running generate_until requests:  25%|██▌       | 25/100 [09:34<25:47, 20.63s/it]Running generate_until requests:  26%|██▌       | 26/100 [09:57<26:24, 21.42s/it]Running generate_until requests:  27%|██▋       | 27/100 [10:20<26:43, 21.97s/it]Running generate_until requests:  28%|██▊       | 28/100 [10:37<24:24, 20.35s/it]Running generate_until requests:  29%|██▉       | 29/100 [11:00<25:05, 21.21s/it]Running generate_until requests:  30%|███       | 30/100 [11:23<25:25, 21.80s/it]Running generate_until requests:  31%|███       | 31/100 [11:46<25:32, 22.21s/it]Running generate_until requests:  32%|███▏      | 32/100 [12:06<24:12, 21.36s/it]Running generate_until requests:  33%|███▎      | 33/100 [12:29<24:24, 21.86s/it]Running generate_until requests:  34%|███▍      | 34/100 [12:52<24:25, 22.20s/it]Running generate_until requests:  35%|███▌      | 35/100 [13:08<21:59, 20.30s/it]Running generate_until requests:  36%|███▌      | 36/100 [13:31<22:29, 21.09s/it]Running generate_until requests:  37%|███▋      | 37/100 [13:54<22:43, 21.64s/it]Running generate_until requests:  38%|███▊      | 38/100 [14:17<22:45, 22.02s/it]Running generate_until requests:  39%|███▉      | 39/100 [14:34<20:59, 20.65s/it]Running generate_until requests:  40%|████      | 40/100 [14:57<21:17, 21.30s/it]Running generate_until requests:  41%|████      | 41/100 [15:20<21:24, 21.77s/it]Running generate_until requests:  42%|████▏     | 42/100 [15:42<21:20, 22.08s/it]Running generate_until requests:  43%|████▎     | 43/100 [16:05<21:11, 22.31s/it]Running generate_until requests:  44%|████▍     | 44/100 [16:28<20:57, 22.46s/it]Running generate_until requests:  45%|████▌     | 45/100 [16:51<20:39, 22.54s/it]Running generate_until requests:  46%|████▌     | 46/100 [17:03<17:24, 19.33s/it]Running generate_until requests:  47%|████▋     | 47/100 [17:25<17:57, 20.33s/it]Running generate_until requests:  48%|████▊     | 48/100 [17:48<18:11, 21.00s/it]Running generate_until requests:  49%|████▉     | 49/100 [18:10<18:13, 21.45s/it]Running generate_until requests:  50%|█████     | 50/100 [18:33<18:07, 21.76s/it]Running generate_until requests:  51%|█████     | 51/100 [18:55<17:56, 21.96s/it]Running generate_until requests:  52%|█████▏    | 52/100 [19:18<17:40, 22.09s/it]Running generate_until requests:  53%|█████▎    | 53/100 [19:40<17:21, 22.16s/it]Running generate_until requests:  54%|█████▍    | 54/100 [20:02<17:01, 22.20s/it]Running generate_until requests:  55%|█████▌    | 55/100 [20:15<14:28, 19.30s/it]Running generate_until requests:  56%|█████▌    | 56/100 [20:37<14:48, 20.19s/it]Running generate_until requests:  57%|█████▋    | 57/100 [20:59<14:54, 20.81s/it]Running generate_until requests:  58%|█████▊    | 58/100 [21:13<13:06, 18.73s/it]Running generate_until requests:  59%|█████▉    | 59/100 [21:35<13:29, 19.75s/it]Running generate_until requests:  60%|██████    | 60/100 [21:58<13:38, 20.47s/it]Running generate_until requests:  61%|██████    | 61/100 [22:20<13:38, 20.98s/it]Running generate_until requests:  62%|██████▏   | 62/100 [22:32<11:37, 18.36s/it]Running generate_until requests:  63%|██████▎   | 63/100 [22:54<12:01, 19.49s/it]Running generate_until requests:  64%|██████▍   | 64/100 [23:16<12:09, 20.26s/it]Running generate_until requests:  65%|██████▌   | 65/100 [23:38<12:07, 20.80s/it]Running generate_until requests:  66%|██████▌   | 66/100 [23:51<10:29, 18.50s/it]Running generate_until requests:  67%|██████▋   | 67/100 [24:13<10:44, 19.53s/it]Running generate_until requests:  68%|██████▊   | 68/100 [24:35<10:47, 20.25s/it]Running generate_until requests:  69%|██████▉   | 69/100 [24:57<10:43, 20.74s/it]Running generate_until requests:  70%|███████   | 70/100 [25:19<10:32, 21.09s/it]Running generate_until requests:  71%|███████   | 71/100 [25:36<09:38, 19.96s/it]Running generate_until requests:  72%|███████▏  | 72/100 [25:48<08:08, 17.46s/it]Running generate_until requests:  73%|███████▎  | 73/100 [26:10<08:25, 18.73s/it]Running generate_until requests:  74%|███████▍  | 74/100 [26:31<08:29, 19.60s/it]Running generate_until requests:  75%|███████▌  | 75/100 [26:53<08:25, 20.21s/it]Running generate_until requests:  76%|███████▌  | 76/100 [27:12<07:57, 19.90s/it]Running generate_until requests:  77%|███████▋  | 77/100 [27:23<06:35, 17.20s/it]Running generate_until requests:  78%|███████▊  | 78/100 [27:36<05:48, 15.86s/it]Running generate_until requests:  79%|███████▉  | 79/100 [27:57<06:09, 17.58s/it]Running generate_until requests:  80%|████████  | 80/100 [28:19<06:14, 18.72s/it]Running generate_until requests:  81%|████████  | 81/100 [28:40<06:10, 19.50s/it]Running generate_until requests:  82%|████████▏ | 82/100 [29:01<06:00, 20.03s/it]Running generate_until requests:  83%|████████▎ | 83/100 [29:23<05:46, 20.40s/it]Running generate_until requests:  84%|████████▍ | 84/100 [29:32<04:34, 17.13s/it]Running generate_until requests:  85%|████████▌ | 85/100 [29:52<04:28, 17.93s/it]Running generate_until requests:  86%|████████▌ | 86/100 [30:13<04:24, 18.90s/it]Running generate_until requests:  87%|████████▋ | 87/100 [30:34<04:14, 19.56s/it]Running generate_until requests:  88%|████████▊ | 88/100 [30:48<03:34, 17.86s/it]Running generate_until requests:  89%|████████▉ | 89/100 [31:09<03:26, 18.79s/it]Running generate_until requests:  90%|█████████ | 90/100 [31:30<03:14, 19.44s/it]Running generate_until requests:  91%|█████████ | 91/100 [31:51<02:58, 19.87s/it]Running generate_until requests:  92%|█████████▏| 92/100 [32:01<02:16, 17.09s/it]Running generate_until requests:  93%|█████████▎| 93/100 [32:21<02:04, 17.74s/it]Running generate_until requests:  94%|█████████▍| 94/100 [32:41<01:51, 18.65s/it]Running generate_until requests:  95%|█████████▌| 95/100 [33:01<01:34, 18.87s/it]Running generate_until requests:  96%|█████████▌| 96/100 [33:21<01:17, 19.42s/it]Running generate_until requests:  97%|█████████▋| 97/100 [33:36<00:54, 18.08s/it]Running generate_until requests:  98%|█████████▊| 98/100 [33:57<00:37, 18.84s/it]Running generate_until requests:  99%|█████████▉| 99/100 [34:18<00:19, 19.36s/it]Running generate_until requests: 100%|██████████| 100/100 [34:38<00:00, 19.63s/it]Running generate_until requests: 100%|██████████| 100/100 [34:38<00:00, 20.78s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:19:21:42,728 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:19:21:42,767 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:19:22:26,048 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:19:22:40,875 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:19:22:40,877 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:19:22:40,889 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:19:22:40,890 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:19:22:40,890 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:19:22:41,151 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:19:22:41,349 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:19:22:41,706 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:11,  1.67s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:02<00:06,  1.14s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:04,  1.03it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:04<00:04,  1.02s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:05<00:02,  1.09it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:05<00:01,  1.15it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:06<00:00,  1.21it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.46it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.15it/s]
2025-01-06:19:22:53,309 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:19:22:53,312 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.26it/s] 70%|███████   | 70/100 [00:00<00:00, 344.77it/s]100%|██████████| 100/100 [00:00<00:00, 343.54it/s]
2025-01-06:19:22:53,608 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:27<44:41, 27.09s/it]Running generate_until requests:   2%|▏         | 2/100 [00:48<38:59, 23.87s/it]Running generate_until requests:   3%|▎         | 3/100 [01:14<39:59, 24.74s/it]Running generate_until requests:   4%|▍         | 4/100 [01:39<39:58, 24.98s/it]Running generate_until requests:   5%|▌         | 5/100 [02:04<39:28, 24.93s/it]Running generate_until requests:   6%|▌         | 6/100 [02:29<38:55, 24.85s/it]Running generate_until requests:   7%|▋         | 7/100 [02:53<38:23, 24.77s/it]Running generate_until requests:   8%|▊         | 8/100 [03:14<35:52, 23.40s/it]Running generate_until requests:   9%|▉         | 9/100 [03:39<36:02, 23.76s/it]Running generate_until requests:  10%|█         | 10/100 [04:03<36:00, 24.00s/it]Running generate_until requests:  11%|█         | 11/100 [04:27<35:45, 24.11s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:36<28:13, 19.25s/it]Running generate_until requests:  13%|█▎        | 13/100 [05:00<30:07, 20.77s/it]Running generate_until requests:  14%|█▍        | 14/100 [05:24<31:15, 21.81s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:48<31:51, 22.48s/it]Running generate_until requests:  16%|█▌        | 16/100 [06:12<32:06, 22.93s/it]Running generate_until requests:  17%|█▋        | 17/100 [06:36<32:05, 23.20s/it]Running generate_until requests:  18%|█▊        | 18/100 [07:00<31:57, 23.38s/it]Running generate_until requests:  19%|█▉        | 19/100 [07:23<31:41, 23.48s/it]Running generate_until requests:  20%|██        | 20/100 [07:47<31:23, 23.54s/it]Running generate_until requests:  21%|██        | 21/100 [08:11<30:58, 23.53s/it]Running generate_until requests:  22%|██▏       | 22/100 [08:34<30:32, 23.50s/it]Running generate_until requests:  23%|██▎       | 23/100 [08:57<30:05, 23.44s/it]Running generate_until requests:  24%|██▍       | 24/100 [09:21<29:38, 23.41s/it]Running generate_until requests:  25%|██▌       | 25/100 [09:35<25:49, 20.66s/it]Running generate_until requests:  26%|██▌       | 26/100 [09:58<26:27, 21.45s/it]Running generate_until requests:  27%|██▋       | 27/100 [10:21<26:46, 22.01s/it]Running generate_until requests:  28%|██▊       | 28/100 [10:38<24:27, 20.39s/it]Running generate_until requests:  29%|██▉       | 29/100 [11:01<25:08, 21.25s/it]Running generate_until requests:  30%|███       | 30/100 [11:25<25:28, 21.84s/it]Running generate_until requests:  31%|███       | 31/100 [11:48<25:35, 22.25s/it]Running generate_until requests:  32%|███▏      | 32/100 [12:07<24:15, 21.41s/it]Running generate_until requests:  33%|███▎      | 33/100 [12:30<24:27, 21.90s/it]Running generate_until requests:  34%|███▍      | 34/100 [12:53<24:27, 22.24s/it]Running generate_until requests:  35%|███▌      | 35/100 [13:09<22:01, 20.34s/it]Running generate_until requests:  36%|███▌      | 36/100 [13:32<22:32, 21.13s/it]Running generate_until requests:  37%|███▋      | 37/100 [13:55<22:45, 21.67s/it]Running generate_until requests:  38%|███▊      | 38/100 [14:18<22:47, 22.06s/it]Running generate_until requests:  39%|███▉      | 39/100 [14:36<21:01, 20.68s/it]Running generate_until requests:  40%|████      | 40/100 [14:58<21:20, 21.34s/it]Running generate_until requests:  41%|████      | 41/100 [15:21<21:26, 21.80s/it]Running generate_until requests:  42%|████▏     | 42/100 [15:44<21:23, 22.12s/it]Running generate_until requests:  43%|████▎     | 43/100 [16:07<21:13, 22.34s/it]Running generate_until requests:  44%|████▍     | 44/100 [16:30<20:59, 22.49s/it]Running generate_until requests:  45%|████▌     | 45/100 [16:53<20:41, 22.57s/it]Running generate_until requests:  46%|████▌     | 46/100 [17:04<17:25, 19.36s/it]Running generate_until requests:  47%|████▋     | 47/100 [17:27<17:59, 20.36s/it]Running generate_until requests:  48%|████▊     | 48/100 [17:50<18:13, 21.03s/it]Running generate_until requests:  49%|████▉     | 49/100 [18:12<18:15, 21.48s/it]Running generate_until requests:  50%|█████     | 50/100 [18:35<18:09, 21.79s/it]Running generate_until requests:  51%|█████     | 51/100 [18:57<17:57, 22.00s/it]Running generate_until requests:  52%|█████▏    | 52/100 [19:20<17:42, 22.13s/it]Running generate_until requests:  53%|█████▎    | 53/100 [19:42<17:23, 22.20s/it]Running generate_until requests:  54%|█████▍    | 54/100 [20:04<17:03, 22.25s/it]Running generate_until requests:  55%|█████▌    | 55/100 [20:17<14:30, 19.34s/it]Running generate_until requests:  56%|█████▌    | 56/100 [20:39<14:50, 20.23s/it]Running generate_until requests:  57%|█████▋    | 57/100 [21:02<14:56, 20.86s/it]Running generate_until requests:  58%|█████▊    | 58/100 [21:16<13:08, 18.77s/it]Running generate_until requests:  59%|█████▉    | 59/100 [21:38<13:31, 19.80s/it]Running generate_until requests:  60%|██████    | 60/100 [22:00<13:40, 20.52s/it]Running generate_until requests:  61%|██████    | 61/100 [22:22<13:39, 21.02s/it]Running generate_until requests:  62%|██████▏   | 62/100 [22:34<11:39, 18.40s/it]Running generate_until requests:  63%|██████▎   | 63/100 [22:57<12:02, 19.53s/it]Running generate_until requests:  64%|██████▍   | 64/100 [23:19<12:10, 20.30s/it]Running generate_until requests:  65%|██████▌   | 65/100 [23:41<12:09, 20.84s/it]Running generate_until requests:  66%|██████▌   | 66/100 [23:54<10:30, 18.54s/it]Running generate_until requests:  67%|██████▋   | 67/100 [24:16<10:45, 19.57s/it]Running generate_until requests:  68%|██████▊   | 68/100 [24:38<10:49, 20.29s/it]Running generate_until requests:  69%|██████▉   | 69/100 [25:00<10:44, 20.79s/it]Running generate_until requests:  70%|███████   | 70/100 [25:22<10:34, 21.15s/it]Running generate_until requests:  71%|███████   | 71/100 [25:39<09:40, 20.02s/it]Running generate_until requests:  72%|███████▏  | 72/100 [25:51<08:10, 17.51s/it]Running generate_until requests:  73%|███████▎  | 73/100 [26:13<08:26, 18.77s/it]Running generate_until requests:  74%|███████▍  | 74/100 [26:34<08:30, 19.64s/it]Running generate_until requests:  75%|███████▌  | 75/100 [26:56<08:26, 20.25s/it]Running generate_until requests:  76%|███████▌  | 76/100 [27:15<07:58, 19.95s/it]Running generate_until requests:  77%|███████▋  | 77/100 [27:26<06:36, 17.24s/it]Running generate_until requests:  78%|███████▊  | 78/100 [27:39<05:49, 15.89s/it]Running generate_until requests:  79%|███████▉  | 79/100 [28:01<06:10, 17.62s/it]Running generate_until requests:  80%|████████  | 80/100 [28:22<06:15, 18.76s/it]Running generate_until requests:  81%|████████  | 81/100 [28:43<06:11, 19.54s/it]Running generate_until requests:  82%|████████▏ | 82/100 [29:05<06:01, 20.07s/it]Running generate_until requests:  83%|████████▎ | 83/100 [29:26<05:47, 20.45s/it]Running generate_until requests:  84%|████████▍ | 84/100 [29:35<04:34, 17.17s/it]Running generate_until requests:  85%|████████▌ | 85/100 [29:55<04:29, 17.97s/it]Running generate_until requests:  86%|████████▌ | 86/100 [30:17<04:25, 18.95s/it]Running generate_until requests:  87%|████████▋ | 87/100 [30:38<04:14, 19.61s/it]Running generate_until requests:  88%|████████▊ | 88/100 [30:52<03:34, 17.91s/it]Running generate_until requests:  89%|████████▉ | 89/100 [31:13<03:27, 18.83s/it]Running generate_until requests:  90%|█████████ | 90/100 [31:34<03:14, 19.48s/it]Running generate_until requests:  91%|█████████ | 91/100 [31:55<02:59, 19.91s/it]Running generate_until requests:  92%|█████████▏| 92/100 [32:05<02:17, 17.13s/it]Running generate_until requests:  93%|█████████▎| 93/100 [32:24<02:04, 17.78s/it]Running generate_until requests:  94%|█████████▍| 94/100 [32:45<01:52, 18.70s/it]Running generate_until requests:  95%|█████████▌| 95/100 [33:05<01:34, 18.92s/it]Running generate_until requests:  96%|█████████▌| 96/100 [33:25<01:17, 19.47s/it]Running generate_until requests:  97%|█████████▋| 97/100 [33:40<00:54, 18.12s/it]Running generate_until requests:  98%|█████████▊| 98/100 [34:01<00:37, 18.88s/it]Running generate_until requests:  99%|█████████▉| 99/100 [34:22<00:19, 19.41s/it]Running generate_until requests: 100%|██████████| 100/100 [34:42<00:00, 19.68s/it]Running generate_until requests: 100%|██████████| 100/100 [34:42<00:00, 20.83s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:19:57:42,078 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:19:57:42,183 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:19:58:24,926 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:19:58:39,817 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:19:58:39,819 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:19:58:39,830 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:19:58:39,831 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:19:58:39,831 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:19:58:40,098 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:19:58:40,293 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:19:58:40,663 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.09s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.12it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:05,  1.02s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.09it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.00it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:05<00:01,  1.10it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:06<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.41it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.17it/s]
2025-01-06:19:58:52,585 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:19:58:52,589 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 345.30it/s] 70%|███████   | 70/100 [00:00<00:00, 338.81it/s]100%|██████████| 100/100 [00:00<00:00, 341.55it/s]
2025-01-06:19:58:52,887 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:27<44:39, 27.06s/it]Running generate_until requests:   2%|▏         | 2/100 [00:48<38:57, 23.85s/it]Running generate_until requests:   3%|▎         | 3/100 [01:14<39:57, 24.72s/it]Running generate_until requests:   4%|▍         | 4/100 [01:39<39:56, 24.96s/it]Running generate_until requests:   5%|▌         | 5/100 [02:04<39:24, 24.89s/it]Running generate_until requests:   6%|▌         | 6/100 [02:29<38:52, 24.81s/it]Running generate_until requests:   7%|▋         | 7/100 [02:53<38:21, 24.74s/it]Running generate_until requests:   8%|▊         | 8/100 [03:14<35:50, 23.37s/it]Running generate_until requests:   9%|▉         | 9/100 [03:38<36:00, 23.74s/it]Running generate_until requests:  10%|█         | 10/100 [04:03<35:58, 23.99s/it]Running generate_until requests:  11%|█         | 11/100 [04:27<35:44, 24.10s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:35<28:12, 19.23s/it]Running generate_until requests:  13%|█▎        | 13/100 [05:00<30:06, 20.76s/it]Running generate_until requests:  14%|█▍        | 14/100 [05:24<31:13, 21.79s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:48<31:49, 22.47s/it]Running generate_until requests:  16%|█▌        | 16/100 [06:12<32:05, 22.92s/it]Running generate_until requests:  17%|█▋        | 17/100 [06:36<32:04, 23.19s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:59<31:56, 23.37s/it]Running generate_until requests:  19%|█▉        | 19/100 [07:23<31:40, 23.46s/it]Running generate_until requests:  20%|██        | 20/100 [07:47<31:22, 23.53s/it]Running generate_until requests:  21%|██        | 21/100 [08:10<30:57, 23.51s/it]Running generate_until requests:  22%|██▏       | 22/100 [08:34<30:31, 23.48s/it]Running generate_until requests:  23%|██▎       | 23/100 [08:57<30:03, 23.43s/it]Running generate_until requests:  24%|██▍       | 24/100 [09:20<29:37, 23.39s/it]Running generate_until requests:  25%|██▌       | 25/100 [09:34<25:48, 20.65s/it]Running generate_until requests:  26%|██▌       | 26/100 [09:58<26:26, 21.44s/it]Running generate_until requests:  27%|██▋       | 27/100 [10:21<26:45, 21.99s/it]Running generate_until requests:  28%|██▊       | 28/100 [10:38<24:26, 20.37s/it]Running generate_until requests:  29%|██▉       | 29/100 [11:01<25:07, 21.23s/it]Running generate_until requests:  30%|███       | 30/100 [11:24<25:27, 21.82s/it]Running generate_until requests:  31%|███       | 31/100 [11:47<25:33, 22.23s/it]Running generate_until requests:  32%|███▏      | 32/100 [12:07<24:15, 21.40s/it]Running generate_until requests:  33%|███▎      | 33/100 [12:30<24:27, 21.90s/it]Running generate_until requests:  34%|███▍      | 34/100 [12:53<24:27, 22.24s/it]Running generate_until requests:  35%|███▌      | 35/100 [13:09<22:01, 20.33s/it]Running generate_until requests:  36%|███▌      | 36/100 [13:32<22:31, 21.12s/it]Running generate_until requests:  37%|███▋      | 37/100 [13:55<22:44, 21.66s/it]Running generate_until requests:  38%|███▊      | 38/100 [14:17<22:47, 22.05s/it]Running generate_until requests:  39%|███▉      | 39/100 [14:35<21:01, 20.67s/it]Running generate_until requests:  40%|████      | 40/100 [14:58<21:19, 21.32s/it]Running generate_until requests:  41%|████      | 41/100 [15:21<21:25, 21.79s/it]Running generate_until requests:  42%|████▏     | 42/100 [15:44<21:22, 22.11s/it]Running generate_until requests:  43%|████▎     | 43/100 [16:06<21:12, 22.33s/it]Running generate_until requests:  44%|████▍     | 44/100 [16:29<20:58, 22.48s/it]Running generate_until requests:  45%|████▌     | 45/100 [16:52<20:40, 22.55s/it]Running generate_until requests:  46%|████▌     | 46/100 [17:04<17:24, 19.35s/it]Running generate_until requests:  47%|████▋     | 47/100 [17:26<17:58, 20.35s/it]Running generate_until requests:  48%|████▊     | 48/100 [17:49<18:12, 21.01s/it]Running generate_until requests:  49%|████▉     | 49/100 [18:12<18:14, 21.46s/it]Running generate_until requests:  50%|█████     | 50/100 [18:34<18:08, 21.77s/it]Running generate_until requests:  51%|█████     | 51/100 [18:56<17:56, 21.98s/it]Running generate_until requests:  52%|█████▏    | 52/100 [19:19<17:41, 22.11s/it]Running generate_until requests:  53%|█████▎    | 53/100 [19:41<17:22, 22.18s/it]Running generate_until requests:  54%|█████▍    | 54/100 [20:04<17:02, 22.23s/it]Running generate_until requests:  55%|█████▌    | 55/100 [20:16<14:29, 19.32s/it]Running generate_until requests:  56%|█████▌    | 56/100 [20:38<14:49, 20.21s/it]Running generate_until requests:  57%|█████▋    | 57/100 [21:01<14:55, 20.83s/it]Running generate_until requests:  58%|█████▊    | 58/100 [21:15<13:07, 18.75s/it]Running generate_until requests:  59%|█████▉    | 59/100 [21:37<13:30, 19.77s/it]Running generate_until requests:  60%|██████    | 60/100 [21:59<13:39, 20.49s/it]Running generate_until requests:  61%|██████    | 61/100 [22:21<13:39, 21.00s/it]Running generate_until requests:  62%|██████▏   | 62/100 [22:33<11:38, 18.38s/it]Running generate_until requests:  63%|██████▎   | 63/100 [22:56<12:01, 19.51s/it]Running generate_until requests:  64%|██████▍   | 64/100 [23:18<12:10, 20.28s/it]Running generate_until requests:  65%|██████▌   | 65/100 [23:40<12:08, 20.82s/it]Running generate_until requests:  66%|██████▌   | 66/100 [23:53<10:29, 18.52s/it]Running generate_until requests:  67%|██████▋   | 67/100 [24:15<10:45, 19.56s/it]Running generate_until requests:  68%|██████▊   | 68/100 [24:37<10:48, 20.27s/it]Running generate_until requests:  69%|██████▉   | 69/100 [24:59<10:43, 20.77s/it]Running generate_until requests:  70%|███████   | 70/100 [25:21<10:33, 21.11s/it]Running generate_until requests:  71%|███████   | 71/100 [25:38<09:39, 19.98s/it]Running generate_until requests:  72%|███████▏  | 72/100 [25:50<08:09, 17.48s/it]Running generate_until requests:  73%|███████▎  | 73/100 [26:11<08:26, 18.74s/it]Running generate_until requests:  74%|███████▍  | 74/100 [26:33<08:29, 19.61s/it]Running generate_until requests:  75%|███████▌  | 75/100 [26:55<08:25, 20.23s/it]Running generate_until requests:  76%|███████▌  | 76/100 [27:14<07:58, 19.92s/it]Running generate_until requests:  77%|███████▋  | 77/100 [27:25<06:35, 17.21s/it]Running generate_until requests:  78%|███████▊  | 78/100 [27:37<05:49, 15.87s/it]Running generate_until requests:  79%|███████▉  | 79/100 [27:59<06:09, 17.60s/it]Running generate_until requests:  80%|████████  | 80/100 [28:20<06:14, 18.74s/it]Running generate_until requests:  81%|████████  | 81/100 [28:42<06:10, 19.52s/it]Running generate_until requests:  82%|████████▏ | 82/100 [29:03<06:00, 20.05s/it]Running generate_until requests:  83%|████████▎ | 83/100 [29:24<05:47, 20.43s/it]Running generate_until requests:  84%|████████▍ | 84/100 [29:34<04:34, 17.15s/it]Running generate_until requests:  85%|████████▌ | 85/100 [29:54<04:29, 17.95s/it]Running generate_until requests:  86%|████████▌ | 86/100 [30:15<04:24, 18.93s/it]Running generate_until requests:  87%|████████▋ | 87/100 [30:36<04:14, 19.58s/it]Running generate_until requests:  88%|████████▊ | 88/100 [30:50<03:34, 17.89s/it]Running generate_until requests:  89%|████████▉ | 89/100 [31:11<03:26, 18.81s/it]Running generate_until requests:  90%|█████████ | 90/100 [31:32<03:14, 19.46s/it]Running generate_until requests:  91%|█████████ | 91/100 [31:53<02:59, 19.89s/it]Running generate_until requests:  92%|█████████▏| 92/100 [32:03<02:16, 17.11s/it]Running generate_until requests:  93%|█████████▎| 93/100 [32:23<02:04, 17.76s/it]Running generate_until requests:  94%|█████████▍| 94/100 [32:44<01:52, 18.68s/it]Running generate_until requests:  95%|█████████▌| 95/100 [33:03<01:34, 18.90s/it]Running generate_until requests:  96%|█████████▌| 96/100 [33:24<01:17, 19.44s/it]Running generate_until requests:  97%|█████████▋| 97/100 [33:39<00:54, 18.10s/it]Running generate_until requests:  98%|█████████▊| 98/100 [33:59<00:37, 18.86s/it]Running generate_until requests:  99%|█████████▉| 99/100 [34:20<00:19, 19.39s/it]Running generate_until requests: 100%|██████████| 100/100 [34:40<00:00, 19.67s/it]Running generate_until requests: 100%|██████████| 100/100 [34:40<00:00, 20.81s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:20:33:38,874 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:20:33:38,958 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:20:34:21,040 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:20:34:35,751 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:20:34:35,753 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:20:34:35,761 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:20:34:35,761 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:20:34:35,762 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:20:34:36,014 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:20:34:36,186 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:20:34:36,732 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.08s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.11it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.18it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.24it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.26it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.30it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.28it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.24it/s]
2025-01-06:20:34:48,166 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:20:34:48,169 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 337.66it/s] 70%|███████   | 70/100 [00:00<00:00, 345.26it/s]100%|██████████| 100/100 [00:00<00:00, 346.01it/s]
2025-01-06:20:34:48,463 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:26<44:24, 26.91s/it]Running generate_until requests:   2%|▏         | 2/100 [00:48<38:45, 23.73s/it]Running generate_until requests:   3%|▎         | 3/100 [01:14<39:45, 24.60s/it]Running generate_until requests:   4%|▍         | 4/100 [01:39<39:44, 24.84s/it]Running generate_until requests:   5%|▌         | 5/100 [02:03<39:13, 24.77s/it]Running generate_until requests:   6%|▌         | 6/100 [02:28<38:41, 24.69s/it]Running generate_until requests:   7%|▋         | 7/100 [02:52<38:10, 24.63s/it]Running generate_until requests:   8%|▊         | 8/100 [03:13<35:40, 23.26s/it]Running generate_until requests:   9%|▉         | 9/100 [03:37<35:50, 23.63s/it]Running generate_until requests:  10%|█         | 10/100 [04:02<35:48, 23.87s/it]Running generate_until requests:  11%|█         | 11/100 [04:26<35:34, 23.98s/it]Running generate_until requests:  12%|█▏        | 12/100 [04:34<28:04, 19.14s/it]Running generate_until requests:  13%|█▎        | 13/100 [04:58<29:57, 20.66s/it]Running generate_until requests:  14%|█▍        | 14/100 [05:22<31:04, 21.69s/it]Running generate_until requests:  15%|█▌        | 15/100 [05:46<31:40, 22.36s/it]Running generate_until requests:  16%|█▌        | 16/100 [06:10<31:55, 22.81s/it]Running generate_until requests:  17%|█▋        | 17/100 [06:34<31:55, 23.08s/it]Running generate_until requests:  18%|█▊        | 18/100 [06:57<31:47, 23.26s/it]Running generate_until requests:  19%|█▉        | 19/100 [07:21<31:31, 23.35s/it]Running generate_until requests:  20%|██        | 20/100 [07:44<31:13, 23.41s/it]Running generate_until requests:  21%|██        | 21/100 [08:08<30:49, 23.41s/it]Running generate_until requests:  22%|██▏       | 22/100 [08:31<30:23, 23.37s/it]Running generate_until requests:  23%|██▎       | 23/100 [08:54<29:55, 23.32s/it]Running generate_until requests:  24%|██▍       | 24/100 [09:17<29:29, 23.28s/it]Running generate_until requests:  25%|██▌       | 25/100 [09:32<25:41, 20.55s/it]Running generate_until requests:  26%|██▌       | 26/100 [09:55<26:18, 21.34s/it]Running generate_until requests:  27%|██▋       | 27/100 [10:18<26:37, 21.88s/it]Running generate_until requests:  28%|██▊       | 28/100 [10:35<24:19, 20.27s/it]Running generate_until requests:  29%|██▉       | 29/100 [10:58<25:00, 21.13s/it]Running generate_until requests:  30%|███       | 30/100 [11:21<25:20, 21.72s/it]Running generate_until requests:  31%|███       | 31/100 [11:44<25:26, 22.12s/it]Running generate_until requests:  32%|███▏      | 32/100 [12:03<24:07, 21.28s/it]Running generate_until requests:  33%|███▎      | 33/100 [12:26<24:19, 21.78s/it]Running generate_until requests:  34%|███▍      | 34/100 [12:49<24:19, 22.12s/it]Running generate_until requests:  35%|███▌      | 35/100 [13:05<21:54, 20.22s/it]Running generate_until requests:  36%|███▌      | 36/100 [13:28<22:24, 21.01s/it]Running generate_until requests:  37%|███▋      | 37/100 [13:50<22:37, 21.55s/it]Running generate_until requests:  38%|███▊      | 38/100 [14:13<22:39, 21.93s/it]Running generate_until requests:  39%|███▉      | 39/100 [14:31<20:54, 20.57s/it]Running generate_until requests:  40%|████      | 40/100 [14:53<21:12, 21.22s/it]Running generate_until requests:  41%|████      | 41/100 [15:16<21:19, 21.68s/it]Running generate_until requests:  42%|████▏     | 42/100 [15:39<21:15, 22.00s/it]Running generate_until requests:  43%|████▎     | 43/100 [16:02<21:06, 22.21s/it]Running generate_until requests:  44%|████▍     | 44/100 [16:24<20:52, 22.36s/it]Running generate_until requests:  45%|████▌     | 45/100 [16:47<20:34, 22.44s/it]Running generate_until requests:  46%|████▌     | 46/100 [16:59<17:19, 19.26s/it]Running generate_until requests:  47%|████▋     | 47/100 [17:21<17:53, 20.25s/it]Running generate_until requests:  48%|████▊     | 48/100 [17:44<18:07, 20.91s/it]Running generate_until requests:  49%|████▉     | 49/100 [18:06<18:09, 21.36s/it]Running generate_until requests:  50%|█████     | 50/100 [18:29<18:03, 21.67s/it]Running generate_until requests:  51%|█████     | 51/100 [18:51<17:51, 21.87s/it]Running generate_until requests:  52%|█████▏    | 52/100 [19:13<17:35, 22.00s/it]Running generate_until requests:  53%|█████▎    | 53/100 [19:35<17:17, 22.06s/it]Running generate_until requests:  54%|█████▍    | 54/100 [19:58<16:57, 22.11s/it]Running generate_until requests:  55%|█████▌    | 55/100 [20:10<14:25, 19.22s/it]Running generate_until requests:  56%|█████▌    | 56/100 [20:32<14:44, 20.11s/it]Running generate_until requests:  57%|█████▋    | 57/100 [20:54<14:51, 20.73s/it]Running generate_until requests:  58%|█████▊    | 58/100 [21:08<13:03, 18.65s/it]Running generate_until requests:  59%|█████▉    | 59/100 [21:30<13:26, 19.68s/it]Running generate_until requests:  60%|██████    | 60/100 [21:52<13:35, 20.39s/it]Running generate_until requests:  61%|██████    | 61/100 [22:15<13:35, 20.90s/it]Running generate_until requests:  62%|██████▏   | 62/100 [22:27<11:35, 18.30s/it]Running generate_until requests:  63%|██████▎   | 63/100 [22:49<11:58, 19.42s/it]Running generate_until requests:  64%|██████▍   | 64/100 [23:11<12:06, 20.18s/it]Running generate_until requests:  65%|██████▌   | 65/100 [23:33<12:05, 20.72s/it]Running generate_until requests:  66%|██████▌   | 66/100 [23:46<10:26, 18.43s/it]Running generate_until requests:  67%|██████▋   | 67/100 [24:08<10:41, 19.45s/it]Running generate_until requests:  68%|██████▊   | 68/100 [24:29<10:45, 20.17s/it]Running generate_until requests:  69%|██████▉   | 69/100 [24:51<10:40, 20.66s/it]Running generate_until requests:  70%|███████   | 70/100 [25:13<10:29, 21.00s/it]Running generate_until requests:  71%|███████   | 71/100 [25:30<09:36, 19.87s/it]Running generate_until requests:  72%|███████▏  | 72/100 [25:42<08:06, 17.39s/it]Running generate_until requests:  73%|███████▎  | 73/100 [26:03<08:23, 18.64s/it]Running generate_until requests:  74%|███████▍  | 74/100 [26:25<08:27, 19.51s/it]Running generate_until requests:  75%|███████▌  | 75/100 [26:47<08:22, 20.12s/it]Running generate_until requests:  76%|███████▌  | 76/100 [27:06<07:55, 19.81s/it]Running generate_until requests:  77%|███████▋  | 77/100 [27:16<06:33, 17.12s/it]Running generate_until requests:  78%|███████▊  | 78/100 [27:29<05:47, 15.79s/it]Running generate_until requests:  79%|███████▉  | 79/100 [27:51<06:07, 17.50s/it]Running generate_until requests:  80%|████████  | 80/100 [28:12<06:12, 18.64s/it]Running generate_until requests:  81%|████████  | 81/100 [28:33<06:08, 19.42s/it]Running generate_until requests:  82%|████████▏ | 82/100 [28:54<05:59, 19.95s/it]Running generate_until requests:  83%|████████▎ | 83/100 [29:16<05:45, 20.32s/it]Running generate_until requests:  84%|████████▍ | 84/100 [29:25<04:32, 17.06s/it]Running generate_until requests:  85%|████████▌ | 85/100 [29:45<04:27, 17.85s/it]Running generate_until requests:  86%|████████▌ | 86/100 [30:06<04:23, 18.82s/it]Running generate_until requests:  87%|████████▋ | 87/100 [30:27<04:13, 19.48s/it]Running generate_until requests:  88%|████████▊ | 88/100 [30:41<03:33, 17.79s/it]Running generate_until requests:  89%|████████▉ | 89/100 [31:01<03:25, 18.71s/it]Running generate_until requests:  90%|█████████ | 90/100 [31:22<03:13, 19.35s/it]Running generate_until requests:  91%|█████████ | 91/100 [31:43<02:58, 19.78s/it]Running generate_until requests:  92%|█████████▏| 92/100 [31:54<02:16, 17.01s/it]Running generate_until requests:  93%|█████████▎| 93/100 [32:13<02:03, 17.66s/it]Running generate_until requests:  94%|█████████▍| 94/100 [32:34<01:51, 18.57s/it]Running generate_until requests:  95%|█████████▌| 95/100 [32:53<01:33, 18.79s/it]Running generate_until requests:  96%|█████████▌| 96/100 [33:13<01:17, 19.33s/it]Running generate_until requests:  97%|█████████▋| 97/100 [33:28<00:53, 18.00s/it]Running generate_until requests:  98%|█████████▊| 98/100 [33:49<00:37, 18.76s/it]Running generate_until requests:  99%|█████████▉| 99/100 [34:09<00:19, 19.27s/it]Running generate_until requests: 100%|██████████| 100/100 [34:30<00:00, 19.54s/it]Running generate_until requests: 100%|██████████| 100/100 [34:30<00:00, 20.70s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:21:09:24,143 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:21:09:24,204 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:21:11:17,198 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:21:11:31,809 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:21:11:31,811 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:21:11:31,822 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:21:11:31,823 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:21:11:31,823 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:21:11:32,083 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:21:11:32,353 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:21:11:32,757 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.07s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.12it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.18it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.23it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.25it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.29it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.32it/s]
2025-01-06:21:11:45,451 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:21:11:45,453 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 346.09it/s] 70%|███████   | 70/100 [00:00<00:00, 346.84it/s]100%|██████████| 100/100 [00:00<00:00, 338.73it/s]
2025-01-06:21:11:45,754 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:39<1:05:57, 39.97s/it]Running generate_until requests:   2%|▏         | 2/100 [01:13<59:32, 36.46s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:52<1:00:27, 37.39s/it]Running generate_until requests:   4%|▍         | 4/100 [02:30<59:59, 37.50s/it]  Running generate_until requests:   5%|▌         | 5/100 [03:06<58:49, 37.15s/it]Running generate_until requests:   6%|▌         | 6/100 [03:42<57:43, 36.85s/it]Running generate_until requests:   7%|▋         | 7/100 [04:11<52:49, 34.08s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<50:48, 33.13s/it]Running generate_until requests:   9%|▉         | 9/100 [05:18<51:37, 34.04s/it]Running generate_until requests:  10%|█         | 10/100 [05:54<51:56, 34.63s/it]Running generate_until requests:  11%|█         | 11/100 [06:30<51:50, 34.95s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:41<40:58, 27.94s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:17<43:52, 30.26s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:31<36:24, 25.40s/it]Running generate_until requests:  15%|█▌        | 15/100 [07:59<37:00, 26.13s/it]Running generate_until requests:  16%|█▌        | 16/100 [08:30<38:28, 27.48s/it]Running generate_until requests:  17%|█▋        | 17/100 [08:42<31:47, 22.98s/it]Running generate_until requests:  18%|█▊        | 18/100 [09:17<36:09, 26.46s/it]Running generate_until requests:  19%|█▉        | 19/100 [09:50<38:30, 28.52s/it]Running generate_until requests:  20%|██        | 20/100 [10:24<40:21, 30.27s/it]Running generate_until requests:  21%|██        | 21/100 [10:58<41:18, 31.37s/it]Running generate_until requests:  22%|██▏       | 22/100 [11:32<41:44, 32.11s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:03<40:35, 31.63s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:36<40:48, 32.21s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:01<37:22, 29.90s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:34<38:13, 30.99s/it]Running generate_until requests:  27%|██▋       | 27/100 [13:52<32:48, 26.97s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:17<31:30, 26.26s/it]Running generate_until requests:  29%|██▉       | 29/100 [14:50<33:38, 28.43s/it]Running generate_until requests:  30%|███       | 30/100 [15:23<34:52, 29.90s/it]Running generate_until requests:  31%|███       | 31/100 [15:41<30:03, 26.13s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:14<32:00, 28.24s/it]Running generate_until requests:  33%|███▎      | 33/100 [16:47<33:10, 29.71s/it]Running generate_until requests:  34%|███▍      | 34/100 [17:20<33:47, 30.72s/it]Running generate_until requests:  35%|███▌      | 35/100 [17:48<32:19, 29.84s/it]Running generate_until requests:  36%|███▌      | 36/100 [18:21<32:49, 30.78s/it]Running generate_until requests:  37%|███▋      | 37/100 [18:54<32:59, 31.41s/it]Running generate_until requests:  38%|███▊      | 38/100 [19:27<32:55, 31.86s/it]Running generate_until requests:  39%|███▉      | 39/100 [19:59<32:41, 32.16s/it]Running generate_until requests:  40%|████      | 40/100 [20:23<29:26, 29.44s/it]Running generate_until requests:  41%|████      | 41/100 [20:50<28:14, 28.72s/it]Running generate_until requests:  42%|████▏     | 42/100 [21:16<26:58, 27.90s/it]Running generate_until requests:  43%|████▎     | 43/100 [21:47<27:32, 29.00s/it]Running generate_until requests:  44%|████▍     | 44/100 [22:20<28:05, 30.10s/it]Running generate_until requests:  45%|████▌     | 45/100 [22:52<28:14, 30.82s/it]Running generate_until requests:  46%|████▌     | 46/100 [23:09<24:02, 26.71s/it]Running generate_until requests:  47%|████▋     | 47/100 [23:42<25:04, 28.39s/it]Running generate_until requests:  48%|████▊     | 48/100 [24:14<25:34, 29.50s/it]Running generate_until requests:  49%|████▉     | 49/100 [24:46<25:42, 30.24s/it]Running generate_until requests:  50%|█████     | 50/100 [25:18<25:38, 30.76s/it]Running generate_until requests:  51%|█████     | 51/100 [25:50<25:24, 31.11s/it]Running generate_until requests:  52%|█████▏    | 52/100 [26:22<25:04, 31.33s/it]Running generate_until requests:  53%|█████▎    | 53/100 [26:53<24:37, 31.43s/it]Running generate_until requests:  54%|█████▍    | 54/100 [27:25<24:08, 31.49s/it]Running generate_until requests:  55%|█████▌    | 55/100 [27:56<23:38, 31.53s/it]Running generate_until requests:  56%|█████▌    | 56/100 [28:28<23:08, 31.55s/it]Running generate_until requests:  57%|█████▋    | 57/100 [28:55<21:38, 30.19s/it]Running generate_until requests:  58%|█████▊    | 58/100 [29:27<21:24, 30.59s/it]Running generate_until requests:  59%|█████▉    | 59/100 [29:58<21:03, 30.83s/it]Running generate_until requests:  60%|██████    | 60/100 [30:29<20:38, 30.97s/it]Running generate_until requests:  61%|██████    | 61/100 [30:49<17:56, 27.59s/it]Running generate_until requests:  62%|██████▏   | 62/100 [31:06<15:31, 24.52s/it]Running generate_until requests:  63%|██████▎   | 63/100 [31:21<13:17, 21.54s/it]Running generate_until requests:  64%|██████▍   | 64/100 [31:52<14:39, 24.42s/it]Running generate_until requests:  65%|██████▌   | 65/100 [32:23<15:24, 26.43s/it]Running generate_until requests:  66%|██████▌   | 66/100 [32:42<13:37, 24.05s/it]Running generate_until requests:  67%|██████▋   | 67/100 [32:54<11:21, 20.65s/it]Running generate_until requests:  68%|██████▊   | 68/100 [33:25<12:38, 23.72s/it]Running generate_until requests:  69%|██████▉   | 69/100 [33:52<12:46, 24.72s/it]Running generate_until requests:  70%|███████   | 70/100 [34:16<12:14, 24.49s/it]Running generate_until requests:  71%|███████   | 71/100 [34:47<12:42, 26.30s/it]Running generate_until requests:  72%|███████▏  | 72/100 [35:05<11:04, 23.73s/it]Running generate_until requests:  73%|███████▎  | 73/100 [35:35<11:34, 25.74s/it]Running generate_until requests:  74%|███████▍  | 74/100 [35:56<10:32, 24.34s/it]Running generate_until requests:  75%|███████▌  | 75/100 [36:12<09:05, 21.81s/it]Running generate_until requests:  76%|███████▌  | 76/100 [36:39<09:19, 23.31s/it]Running generate_until requests:  77%|███████▋  | 77/100 [36:54<08:03, 21.02s/it]Running generate_until requests:  78%|███████▊  | 78/100 [37:25<08:43, 23.80s/it]Running generate_until requests:  79%|███████▉  | 79/100 [37:49<08:20, 23.82s/it]Running generate_until requests:  80%|████████  | 80/100 [38:05<07:10, 21.51s/it]Running generate_until requests:  81%|████████  | 81/100 [38:34<07:35, 23.98s/it]Running generate_until requests:  82%|████████▏ | 82/100 [39:04<07:41, 25.65s/it]Running generate_until requests:  83%|████████▎ | 83/100 [39:34<07:36, 26.84s/it]Running generate_until requests:  84%|████████▍ | 84/100 [39:48<06:10, 23.19s/it]Running generate_until requests:  85%|████████▌ | 85/100 [40:16<06:06, 24.45s/it]Running generate_until requests:  86%|████████▌ | 86/100 [40:45<06:03, 25.95s/it]Running generate_until requests:  87%|████████▋ | 87/100 [41:14<05:50, 26.94s/it]Running generate_until requests:  88%|████████▊ | 88/100 [41:34<04:55, 24.66s/it]Running generate_until requests:  89%|████████▉ | 89/100 [42:03<04:45, 25.96s/it]Running generate_until requests:  90%|█████████ | 90/100 [42:32<04:28, 26.85s/it]Running generate_until requests:  91%|█████████ | 91/100 [43:01<04:07, 27.44s/it]Running generate_until requests:  92%|█████████▏| 92/100 [43:16<03:11, 23.96s/it]Running generate_until requests:  93%|█████████▎| 93/100 [43:27<02:20, 20.04s/it]Running generate_until requests:  94%|█████████▍| 94/100 [43:56<02:15, 22.65s/it]Running generate_until requests:  95%|█████████▌| 95/100 [44:25<02:02, 24.42s/it]Running generate_until requests:  96%|█████████▌| 96/100 [44:53<01:42, 25.65s/it]Running generate_until requests:  97%|█████████▋| 97/100 [45:21<01:19, 26.47s/it]Running generate_until requests:  98%|█████████▊| 98/100 [45:50<00:54, 27.05s/it]Running generate_until requests:  99%|█████████▉| 99/100 [46:03<00:23, 23.01s/it]Running generate_until requests: 100%|██████████| 100/100 [46:31<00:00, 24.39s/it]Running generate_until requests: 100%|██████████| 100/100 [46:31<00:00, 27.92s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:21:58:23,104 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:21:58:23,203 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:21:59:05,888 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:21:59:20,827 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:21:59:20,829 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:21:59:20,842 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:21:59:20,842 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:21:59:20,843 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:21:59:21,098 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:21:59:21,294 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:21:59:21,675 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.08s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.11it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.18it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.25it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.28it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.29it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.56it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.33it/s]
2025-01-06:21:59:32,980 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:21:59:32,984 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 346.14it/s] 71%|███████   | 71/100 [00:00<00:00, 349.49it/s]100%|██████████| 100/100 [00:00<00:00, 344.68it/s]
2025-01-06:21:59:33,281 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:39<1:05:42, 39.82s/it]Running generate_until requests:   2%|▏         | 2/100 [01:13<59:27, 36.40s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:52<1:00:25, 37.38s/it]Running generate_until requests:   4%|▍         | 4/100 [02:30<1:00:00, 37.50s/it]Running generate_until requests:   5%|▌         | 5/100 [03:06<58:51, 37.17s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:42<57:46, 36.88s/it]Running generate_until requests:   7%|▋         | 7/100 [04:11<52:52, 34.11s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<50:50, 33.16s/it]Running generate_until requests:   9%|▉         | 9/100 [05:18<51:40, 34.07s/it]Running generate_until requests:  10%|█         | 10/100 [05:54<51:59, 34.67s/it]Running generate_until requests:  11%|█         | 11/100 [06:30<51:54, 34.99s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:42<41:00, 27.97s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:17<43:55, 30.29s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:31<36:26, 25.42s/it]Running generate_until requests:  15%|█▌        | 15/100 [07:59<37:02, 26.15s/it]Running generate_until requests:  16%|█▌        | 16/100 [08:30<38:30, 27.51s/it]Running generate_until requests:  17%|█▋        | 17/100 [08:43<31:49, 23.01s/it]Running generate_until requests:  18%|█▊        | 18/100 [09:17<36:11, 26.49s/it]Running generate_until requests:  19%|█▉        | 19/100 [09:50<38:31, 28.53s/it]Running generate_until requests:  20%|██        | 20/100 [10:25<40:23, 30.29s/it]Running generate_until requests:  21%|██        | 21/100 [10:59<41:20, 31.39s/it]Running generate_until requests:  22%|██▏       | 22/100 [11:33<41:46, 32.14s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:03<40:37, 31.66s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:37<40:50, 32.25s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:01<37:24, 29.93s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:35<38:16, 31.03s/it]Running generate_until requests:  27%|██▋       | 27/100 [13:53<32:51, 27.01s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:17<31:33, 26.30s/it]Running generate_until requests:  29%|██▉       | 29/100 [14:51<33:41, 28.47s/it]Running generate_until requests:  30%|███       | 30/100 [15:24<34:55, 29.94s/it]Running generate_until requests:  31%|███       | 31/100 [15:41<30:05, 26.17s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:15<32:02, 28.27s/it]Running generate_until requests:  33%|███▎      | 33/100 [16:48<33:13, 29.75s/it]Running generate_until requests:  34%|███▍      | 34/100 [17:21<33:50, 30.76s/it]Running generate_until requests:  35%|███▌      | 35/100 [17:49<32:22, 29.88s/it]Running generate_until requests:  36%|███▌      | 36/100 [18:22<32:52, 30.82s/it]Running generate_until requests:  37%|███▋      | 37/100 [18:55<33:01, 31.46s/it]Running generate_until requests:  38%|███▊      | 38/100 [19:28<32:58, 31.91s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:01<32:44, 32.21s/it]Running generate_until requests:  40%|████      | 40/100 [20:24<29:28, 29.48s/it]Running generate_until requests:  41%|████      | 41/100 [20:51<28:16, 28.76s/it]Running generate_until requests:  42%|████▏     | 42/100 [21:17<27:00, 27.94s/it]Running generate_until requests:  43%|████▎     | 43/100 [21:48<27:34, 29.03s/it]Running generate_until requests:  44%|████▍     | 44/100 [22:21<28:07, 30.14s/it]Running generate_until requests:  45%|████▌     | 45/100 [22:54<28:17, 30.86s/it]Running generate_until requests:  46%|████▌     | 46/100 [23:11<24:04, 26.75s/it]Running generate_until requests:  47%|████▋     | 47/100 [23:43<25:06, 28.43s/it]Running generate_until requests:  48%|████▊     | 48/100 [24:15<25:36, 29.55s/it]Running generate_until requests:  49%|████▉     | 49/100 [24:47<25:45, 30.30s/it]Running generate_until requests:  50%|█████     | 50/100 [25:19<25:41, 30.82s/it]Running generate_until requests:  51%|█████     | 51/100 [25:51<25:27, 31.16s/it]Running generate_until requests:  52%|█████▏    | 52/100 [26:23<25:06, 31.39s/it]Running generate_until requests:  53%|█████▎    | 53/100 [26:55<24:39, 31.48s/it]Running generate_until requests:  54%|█████▍    | 54/100 [27:27<24:10, 31.54s/it]Running generate_until requests:  55%|█████▌    | 55/100 [27:58<23:40, 31.57s/it]Running generate_until requests:  56%|█████▌    | 56/100 [28:30<23:10, 31.60s/it]Running generate_until requests:  57%|█████▋    | 57/100 [28:57<21:40, 30.23s/it]Running generate_until requests:  58%|█████▊    | 58/100 [29:29<21:26, 30.64s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:00<21:05, 30.87s/it]Running generate_until requests:  60%|██████    | 60/100 [30:31<20:40, 31.02s/it]Running generate_until requests:  61%|██████    | 61/100 [30:51<17:57, 27.64s/it]Running generate_until requests:  62%|██████▏   | 62/100 [31:09<15:33, 24.56s/it]Running generate_until requests:  63%|██████▎   | 63/100 [31:23<13:18, 21.57s/it]Running generate_until requests:  64%|██████▍   | 64/100 [31:54<14:40, 24.45s/it]Running generate_until requests:  65%|██████▌   | 65/100 [32:25<15:26, 26.46s/it]Running generate_until requests:  66%|██████▌   | 66/100 [32:44<13:38, 24.08s/it]Running generate_until requests:  67%|██████▋   | 67/100 [32:57<11:22, 20.67s/it]Running generate_until requests:  68%|██████▊   | 68/100 [33:28<12:39, 23.75s/it]Running generate_until requests:  69%|██████▉   | 69/100 [33:55<12:47, 24.75s/it]Running generate_until requests:  70%|███████   | 70/100 [34:19<12:15, 24.52s/it]Running generate_until requests:  71%|███████   | 71/100 [34:49<12:43, 26.33s/it]Running generate_until requests:  72%|███████▏  | 72/100 [35:07<11:05, 23.76s/it]Running generate_until requests:  73%|███████▎  | 73/100 [35:37<11:35, 25.77s/it]Running generate_until requests:  74%|███████▍  | 74/100 [35:59<10:33, 24.37s/it]Running generate_until requests:  75%|███████▌  | 75/100 [36:14<09:05, 21.83s/it]Running generate_until requests:  76%|███████▌  | 76/100 [36:41<09:20, 23.34s/it]Running generate_until requests:  77%|███████▋  | 77/100 [36:57<08:03, 21.04s/it]Running generate_until requests:  78%|███████▊  | 78/100 [37:27<08:44, 23.83s/it]Running generate_until requests:  79%|███████▉  | 79/100 [37:51<08:20, 23.85s/it]Running generate_until requests:  80%|████████  | 80/100 [38:07<07:10, 21.54s/it]Running generate_until requests:  81%|████████  | 81/100 [38:37<07:36, 24.00s/it]Running generate_until requests:  82%|████████▏ | 82/100 [39:07<07:42, 25.68s/it]Running generate_until requests:  83%|████████▎ | 83/100 [39:36<07:36, 26.88s/it]Running generate_until requests:  84%|████████▍ | 84/100 [39:51<06:11, 23.21s/it]Running generate_until requests:  85%|████████▌ | 85/100 [40:18<06:07, 24.48s/it]Running generate_until requests:  86%|████████▌ | 86/100 [40:48<06:03, 25.97s/it]Running generate_until requests:  87%|████████▋ | 87/100 [41:17<05:50, 26.95s/it]Running generate_until requests:  88%|████████▊ | 88/100 [41:37<04:56, 24.67s/it]Running generate_until requests:  89%|████████▉ | 89/100 [42:06<04:45, 25.97s/it]Running generate_until requests:  90%|█████████ | 90/100 [42:34<04:28, 26.87s/it]Running generate_until requests:  91%|█████████ | 91/100 [43:03<04:07, 27.46s/it]Running generate_until requests:  92%|█████████▏| 92/100 [43:19<03:11, 23.98s/it]Running generate_until requests:  93%|█████████▎| 93/100 [43:30<02:20, 20.06s/it]Running generate_until requests:  94%|█████████▍| 94/100 [43:59<02:16, 22.68s/it]Running generate_until requests:  95%|█████████▌| 95/100 [44:27<02:02, 24.45s/it]Running generate_until requests:  96%|█████████▌| 96/100 [44:56<01:42, 25.68s/it]Running generate_until requests:  97%|█████████▋| 97/100 [45:24<01:19, 26.50s/it]Running generate_until requests:  98%|█████████▊| 98/100 [45:53<00:54, 27.08s/it]Running generate_until requests:  99%|█████████▉| 99/100 [46:06<00:23, 23.04s/it]Running generate_until requests: 100%|██████████| 100/100 [46:34<00:00, 24.42s/it]Running generate_until requests: 100%|██████████| 100/100 [46:34<00:00, 27.95s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:22:46:14,080 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:22:46:14,137 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:22:46:56,970 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:22:47:11,863 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:22:47:11,865 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:22:47:11,874 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:22:47:11,874 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:22:47:11,875 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:22:47:12,135 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:22:47:12,335 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:22:47:12,722 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:08,  1.21s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.06it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:05,  1.04s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.09it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.17it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:05<00:01,  1.20it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:06<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.49it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.23it/s]
2025-01-06:22:47:24,589 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:22:47:24,592 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 341.33it/s] 71%|███████   | 71/100 [00:00<00:00, 347.18it/s]100%|██████████| 100/100 [00:00<00:00, 342.75it/s]
2025-01-06:22:47:24,889 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:39<1:05:29, 39.69s/it]Running generate_until requests:   2%|▏         | 2/100 [01:13<59:14, 36.27s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:51<1:00:12, 37.25s/it]Running generate_until requests:   4%|▍         | 4/100 [02:29<59:47, 37.37s/it]  Running generate_until requests:   5%|▌         | 5/100 [03:05<58:38, 37.03s/it]Running generate_until requests:   6%|▌         | 6/100 [03:42<57:33, 36.74s/it]Running generate_until requests:   7%|▋         | 7/100 [04:10<52:40, 33.98s/it]Running generate_until requests:   8%|▊         | 8/100 [04:41<50:39, 33.04s/it]Running generate_until requests:   9%|▉         | 9/100 [05:17<51:28, 33.94s/it]Running generate_until requests:  10%|█         | 10/100 [05:53<51:48, 34.54s/it]Running generate_until requests:  11%|█         | 11/100 [06:28<51:42, 34.86s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:40<40:51, 27.86s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:16<43:45, 30.18s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:30<36:18, 25.33s/it]Running generate_until requests:  15%|█▌        | 15/100 [07:58<36:54, 26.06s/it]Running generate_until requests:  16%|█▌        | 16/100 [08:28<38:22, 27.42s/it]Running generate_until requests:  17%|█▋        | 17/100 [08:41<31:43, 22.93s/it]Running generate_until requests:  18%|█▊        | 18/100 [09:15<36:04, 26.39s/it]Running generate_until requests:  19%|█▉        | 19/100 [09:48<38:22, 28.43s/it]Running generate_until requests:  20%|██        | 20/100 [10:23<40:13, 30.17s/it]Running generate_until requests:  21%|██        | 21/100 [10:56<41:10, 31.27s/it]Running generate_until requests:  22%|██▏       | 22/100 [11:30<41:36, 32.01s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:01<40:27, 31.53s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:34<40:40, 32.12s/it]Running generate_until requests:  25%|██▌       | 25/100 [12:58<37:15, 29.81s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:32<38:06, 30.90s/it]Running generate_until requests:  27%|██▋       | 27/100 [13:49<32:43, 26.89s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:14<31:25, 26.19s/it]Running generate_until requests:  29%|██▉       | 29/100 [14:47<33:32, 28.35s/it]Running generate_until requests:  30%|███       | 30/100 [15:21<34:47, 29.82s/it]Running generate_until requests:  31%|███       | 31/100 [15:38<29:58, 26.07s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:11<31:54, 28.16s/it]Running generate_until requests:  33%|███▎      | 33/100 [16:44<33:05, 29.63s/it]Running generate_until requests:  34%|███▍      | 34/100 [17:17<33:42, 30.64s/it]Running generate_until requests:  35%|███▌      | 35/100 [17:45<32:14, 29.76s/it]Running generate_until requests:  36%|███▌      | 36/100 [18:18<32:44, 30.70s/it]Running generate_until requests:  37%|███▋      | 37/100 [18:50<32:53, 31.33s/it]Running generate_until requests:  38%|███▊      | 38/100 [19:23<32:49, 31.77s/it]Running generate_until requests:  39%|███▉      | 39/100 [19:56<32:36, 32.07s/it]Running generate_until requests:  40%|████      | 40/100 [20:19<29:21, 29.36s/it]Running generate_until requests:  41%|████      | 41/100 [20:46<28:09, 28.64s/it]Running generate_until requests:  42%|████▏     | 42/100 [21:12<26:53, 27.82s/it]Running generate_until requests:  43%|████▎     | 43/100 [21:43<27:27, 28.91s/it]Running generate_until requests:  44%|████▍     | 44/100 [22:16<28:00, 30.01s/it]Running generate_until requests:  45%|████▌     | 45/100 [22:48<28:10, 30.73s/it]Running generate_until requests:  46%|████▌     | 46/100 [23:05<23:58, 26.65s/it]Running generate_until requests:  47%|████▋     | 47/100 [23:38<25:00, 28.31s/it]Running generate_until requests:  48%|████▊     | 48/100 [24:10<25:30, 29.42s/it]Running generate_until requests:  49%|████▉     | 49/100 [24:42<25:38, 30.16s/it]Running generate_until requests:  50%|█████     | 50/100 [25:13<25:33, 30.68s/it]Running generate_until requests:  51%|█████     | 51/100 [25:45<25:20, 31.03s/it]Running generate_until requests:  52%|█████▏    | 52/100 [26:17<24:59, 31.25s/it]Running generate_until requests:  53%|█████▎    | 53/100 [26:49<24:33, 31.34s/it]Running generate_until requests:  54%|█████▍    | 54/100 [27:20<24:04, 31.40s/it]Running generate_until requests:  55%|█████▌    | 55/100 [27:52<23:34, 31.44s/it]Running generate_until requests:  56%|█████▌    | 56/100 [28:23<23:04, 31.46s/it]Running generate_until requests:  57%|█████▋    | 57/100 [28:50<21:34, 30.10s/it]Running generate_until requests:  58%|█████▊    | 58/100 [29:22<21:21, 30.50s/it]Running generate_until requests:  59%|█████▉    | 59/100 [29:53<21:00, 30.74s/it]Running generate_until requests:  60%|██████    | 60/100 [30:24<20:35, 30.89s/it]Running generate_until requests:  61%|██████    | 61/100 [30:44<17:53, 27.51s/it]Running generate_until requests:  62%|██████▏   | 62/100 [31:01<15:29, 24.45s/it]Running generate_until requests:  63%|██████▎   | 63/100 [31:16<13:14, 21.48s/it]Running generate_until requests:  64%|██████▍   | 64/100 [31:47<14:36, 24.35s/it]Running generate_until requests:  65%|██████▌   | 65/100 [32:18<15:21, 26.34s/it]Running generate_until requests:  66%|██████▌   | 66/100 [32:36<13:35, 23.97s/it]Running generate_until requests:  67%|██████▋   | 67/100 [32:49<11:19, 20.58s/it]Running generate_until requests:  68%|██████▊   | 68/100 [33:19<12:36, 23.64s/it]Running generate_until requests:  69%|██████▉   | 69/100 [33:46<12:43, 24.64s/it]Running generate_until requests:  70%|███████   | 70/100 [34:10<12:12, 24.40s/it]Running generate_until requests:  71%|███████   | 71/100 [34:41<12:40, 26.21s/it]Running generate_until requests:  72%|███████▏  | 72/100 [34:58<11:02, 23.65s/it]Running generate_until requests:  73%|███████▎  | 73/100 [35:29<11:32, 25.65s/it]Running generate_until requests:  74%|███████▍  | 74/100 [35:50<10:30, 24.26s/it]Running generate_until requests:  75%|███████▌  | 75/100 [36:06<09:03, 21.74s/it]Running generate_until requests:  76%|███████▌  | 76/100 [36:32<09:17, 23.23s/it]Running generate_until requests:  77%|███████▋  | 77/100 [36:48<08:01, 20.94s/it]Running generate_until requests:  78%|███████▊  | 78/100 [37:18<08:41, 23.71s/it]Running generate_until requests:  79%|███████▉  | 79/100 [37:42<08:18, 23.74s/it]Running generate_until requests:  80%|████████  | 80/100 [37:58<07:08, 21.44s/it]Running generate_until requests:  81%|████████  | 81/100 [38:28<07:33, 23.89s/it]Running generate_until requests:  82%|████████▏ | 82/100 [38:57<07:39, 25.55s/it]Running generate_until requests:  83%|████████▎ | 83/100 [39:27<07:34, 26.75s/it]Running generate_until requests:  84%|████████▍ | 84/100 [39:41<06:09, 23.11s/it]Running generate_until requests:  85%|████████▌ | 85/100 [40:08<06:05, 24.37s/it]Running generate_until requests:  86%|████████▌ | 86/100 [40:38<06:01, 25.85s/it]Running generate_until requests:  87%|████████▋ | 87/100 [41:07<05:48, 26.83s/it]Running generate_until requests:  88%|████████▊ | 88/100 [41:26<04:54, 24.55s/it]Running generate_until requests:  89%|████████▉ | 89/100 [41:55<04:44, 25.85s/it]Running generate_until requests:  90%|█████████ | 90/100 [42:24<04:27, 26.74s/it]Running generate_until requests:  91%|█████████ | 91/100 [42:53<04:05, 27.33s/it]Running generate_until requests:  92%|█████████▏| 92/100 [43:08<03:10, 23.87s/it]Running generate_until requests:  93%|█████████▎| 93/100 [43:19<02:19, 19.96s/it]Running generate_until requests:  94%|█████████▍| 94/100 [43:48<02:15, 22.57s/it]Running generate_until requests:  95%|█████████▌| 95/100 [44:16<02:01, 24.33s/it]Running generate_until requests:  96%|█████████▌| 96/100 [44:45<01:42, 25.55s/it]Running generate_until requests:  97%|█████████▋| 97/100 [45:13<01:19, 26.37s/it]Running generate_until requests:  98%|█████████▊| 98/100 [45:41<00:53, 26.95s/it]Running generate_until requests:  99%|█████████▉| 99/100 [45:55<00:22, 22.92s/it]Running generate_until requests: 100%|██████████| 100/100 [46:22<00:00, 24.30s/it]Running generate_until requests: 100%|██████████| 100/100 [46:22<00:00, 27.83s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-06:23:33:53,326 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-06:23:33:53,401 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-06:23:34:36,538 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-06:23:34:51,519 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-06:23:34:51,520 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-06:23:34:51,532 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-06:23:34:51,533 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-06:23:34:51,533 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-06:23:34:51,802 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-06:23:34:52,000 INFO     [huggingface.py:481] Using model type 'default'
2025-01-06:23:34:52,370 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.09s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.12it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.19it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.26it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.29it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.29it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.55it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.33it/s]
2025-01-06:23:35:03,452 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-06:23:35:03,456 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 339.02it/s] 69%|██████▉   | 69/100 [00:00<00:00, 343.58it/s]100%|██████████| 100/100 [00:00<00:00, 344.62it/s]
2025-01-06:23:35:03,751 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:39<1:05:29, 39.70s/it]Running generate_until requests:   2%|▏         | 2/100 [01:13<59:16, 36.29s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:52<1:00:14, 37.26s/it]Running generate_until requests:   4%|▍         | 4/100 [02:29<59:49, 37.39s/it]  Running generate_until requests:   5%|▌         | 5/100 [03:06<58:40, 37.05s/it]Running generate_until requests:   6%|▌         | 6/100 [03:42<57:35, 36.76s/it]Running generate_until requests:   7%|▋         | 7/100 [04:10<52:42, 34.00s/it]Running generate_until requests:   8%|▊         | 8/100 [04:41<50:40, 33.05s/it]Running generate_until requests:   9%|▉         | 9/100 [05:17<51:30, 33.96s/it]Running generate_until requests:  10%|█         | 10/100 [05:53<51:50, 34.56s/it]Running generate_until requests:  11%|█         | 11/100 [06:29<51:44, 34.88s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:40<40:53, 27.88s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:16<43:47, 30.20s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:30<36:19, 25.34s/it]Running generate_until requests:  15%|█▌        | 15/100 [07:58<36:56, 26.07s/it]Running generate_until requests:  16%|█▌        | 16/100 [08:28<38:23, 27.43s/it]Running generate_until requests:  17%|█▋        | 17/100 [08:41<31:43, 22.94s/it]Running generate_until requests:  18%|█▊        | 18/100 [09:15<36:04, 26.40s/it]Running generate_until requests:  19%|█▉        | 19/100 [09:49<38:23, 28.44s/it]Running generate_until requests:  20%|██        | 20/100 [10:23<40:15, 30.19s/it]Running generate_until requests:  21%|██        | 21/100 [10:57<41:12, 31.29s/it]Running generate_until requests:  22%|██▏       | 22/100 [11:30<41:38, 32.03s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:01<40:29, 31.55s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:34<40:42, 32.14s/it]Running generate_until requests:  25%|██▌       | 25/100 [12:59<37:17, 29.83s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:32<38:08, 30.92s/it]Running generate_until requests:  27%|██▋       | 27/100 [13:50<32:44, 26.91s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:14<31:26, 26.21s/it]Running generate_until requests:  29%|██▉       | 29/100 [14:48<33:34, 28.37s/it]Running generate_until requests:  30%|███       | 30/100 [15:21<34:48, 29.84s/it]Running generate_until requests:  31%|███       | 31/100 [15:38<29:59, 26.08s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:11<31:55, 28.18s/it]Running generate_until requests:  33%|███▎      | 33/100 [16:45<33:06, 29.65s/it]Running generate_until requests:  34%|███▍      | 34/100 [17:18<33:43, 30.66s/it]Running generate_until requests:  35%|███▌      | 35/100 [17:45<32:15, 29.78s/it]Running generate_until requests:  36%|███▌      | 36/100 [18:18<32:46, 30.72s/it]Running generate_until requests:  37%|███▋      | 37/100 [18:51<32:55, 31.35s/it]Running generate_until requests:  38%|███▊      | 38/100 [19:24<32:51, 31.80s/it]Running generate_until requests:  39%|███▉      | 39/100 [19:57<32:37, 32.10s/it]Running generate_until requests:  40%|████      | 40/100 [20:20<29:22, 29.38s/it]Running generate_until requests:  41%|████      | 41/100 [20:47<28:10, 28.66s/it]Running generate_until requests:  42%|████▏     | 42/100 [21:13<26:54, 27.84s/it]Running generate_until requests:  43%|████▎     | 43/100 [21:44<27:29, 28.93s/it]Running generate_until requests:  44%|████▍     | 44/100 [22:17<28:02, 30.04s/it]Running generate_until requests:  45%|████▌     | 45/100 [22:49<28:11, 30.75s/it]Running generate_until requests:  46%|████▌     | 46/100 [23:06<23:59, 26.65s/it]Running generate_until requests:  47%|████▋     | 47/100 [23:39<25:03, 28.36s/it]Running generate_until requests:  48%|████▊     | 48/100 [24:11<25:32, 29.47s/it]Running generate_until requests:  49%|████▉     | 49/100 [24:43<25:40, 30.20s/it]Running generate_until requests:  50%|█████     | 50/100 [25:14<25:36, 30.72s/it]Running generate_until requests:  51%|█████     | 51/100 [25:46<25:21, 31.06s/it]Running generate_until requests:  52%|█████▏    | 52/100 [26:18<25:01, 31.27s/it]Running generate_until requests:  53%|█████▎    | 53/100 [26:50<24:34, 31.37s/it]Running generate_until requests:  54%|█████▍    | 54/100 [27:21<24:05, 31.43s/it]Running generate_until requests:  55%|█████▌    | 55/100 [27:53<23:35, 31.46s/it]Running generate_until requests:  56%|█████▌    | 56/100 [28:24<23:05, 31.48s/it]Running generate_until requests:  57%|█████▋    | 57/100 [28:51<21:35, 30.12s/it]Running generate_until requests:  58%|█████▊    | 58/100 [29:23<21:21, 30.52s/it]Running generate_until requests:  59%|█████▉    | 59/100 [29:54<21:01, 30.76s/it]Running generate_until requests:  60%|██████    | 60/100 [30:25<20:36, 30.90s/it]Running generate_until requests:  61%|██████    | 61/100 [30:45<17:53, 27.53s/it]Running generate_until requests:  62%|██████▏   | 62/100 [31:02<15:29, 24.46s/it]Running generate_until requests:  63%|██████▎   | 63/100 [31:17<13:15, 21.49s/it]Running generate_until requests:  64%|██████▍   | 64/100 [31:48<14:36, 24.36s/it]Running generate_until requests:  65%|██████▌   | 65/100 [32:19<15:22, 26.36s/it]Running generate_until requests:  66%|██████▌   | 66/100 [32:37<13:35, 23.98s/it]Running generate_until requests:  67%|██████▋   | 67/100 [32:50<11:19, 20.59s/it]Running generate_until requests:  68%|██████▊   | 68/100 [33:21<12:36, 23.65s/it]Running generate_until requests:  69%|██████▉   | 69/100 [33:48<12:44, 24.65s/it]Running generate_until requests:  70%|███████   | 70/100 [34:12<12:12, 24.42s/it]Running generate_until requests:  71%|███████   | 71/100 [34:42<12:40, 26.23s/it]Running generate_until requests:  72%|███████▏  | 72/100 [35:00<11:02, 23.67s/it]Running generate_until requests:  73%|███████▎  | 73/100 [35:30<11:32, 25.67s/it]Running generate_until requests:  74%|███████▍  | 74/100 [35:51<10:31, 24.27s/it]Running generate_until requests:  75%|███████▌  | 75/100 [36:07<09:03, 21.75s/it]Running generate_until requests:  76%|███████▌  | 76/100 [36:34<09:17, 23.25s/it]Running generate_until requests:  77%|███████▋  | 77/100 [36:49<08:02, 20.96s/it]Running generate_until requests:  78%|███████▊  | 78/100 [37:20<08:42, 23.73s/it]Running generate_until requests:  79%|███████▉  | 79/100 [37:43<08:18, 23.76s/it]Running generate_until requests:  80%|████████  | 80/100 [37:59<07:09, 21.46s/it]Running generate_until requests:  81%|████████  | 81/100 [38:29<07:34, 23.91s/it]Running generate_until requests:  82%|████████▏ | 82/100 [38:59<07:40, 25.58s/it]Running generate_until requests:  83%|████████▎ | 83/100 [39:28<07:35, 26.77s/it]Running generate_until requests:  84%|████████▍ | 84/100 [39:43<06:09, 23.12s/it]Running generate_until requests:  85%|████████▌ | 85/100 [40:10<06:05, 24.38s/it]Running generate_until requests:  86%|████████▌ | 86/100 [40:39<06:02, 25.86s/it]Running generate_until requests:  87%|████████▋ | 87/100 [41:08<05:48, 26.84s/it]Running generate_until requests:  88%|████████▊ | 88/100 [41:28<04:54, 24.57s/it]Running generate_until requests:  89%|████████▉ | 89/100 [41:57<04:44, 25.86s/it]Running generate_until requests:  90%|█████████ | 90/100 [42:25<04:27, 26.76s/it]Running generate_until requests:  91%|█████████ | 91/100 [42:54<04:06, 27.35s/it]Running generate_until requests:  92%|█████████▏| 92/100 [43:10<03:11, 23.88s/it]Running generate_until requests:  93%|█████████▎| 93/100 [43:21<02:19, 19.97s/it]Running generate_until requests:  94%|█████████▍| 94/100 [43:49<02:15, 22.58s/it]Running generate_until requests:  95%|█████████▌| 95/100 [44:18<02:01, 24.34s/it]Running generate_until requests:  96%|█████████▌| 96/100 [44:46<01:42, 25.57s/it]Running generate_until requests:  97%|█████████▋| 97/100 [45:15<01:19, 26.39s/it]Running generate_until requests:  98%|█████████▊| 98/100 [45:43<00:53, 26.96s/it]Running generate_until requests:  99%|█████████▉| 99/100 [45:57<00:22, 22.93s/it]Running generate_until requests: 100%|██████████| 100/100 [46:24<00:00, 24.32s/it]Running generate_until requests: 100%|██████████| 100/100 [46:24<00:00, 27.85s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:00:21:34,135 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:00:21:34,252 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-07:00:22:16,937 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-07:00:22:31,210 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-07:00:22:31,212 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-07:00:22:31,223 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-07:00:22:31,224 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-07:00:22:31,224 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-07:00:22:31,488 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-07:00:22:31,678 INFO     [huggingface.py:481] Using model type 'default'
2025-01-07:00:22:32,275 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.09s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.11it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.20it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.22it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.26it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.26it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.28it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.53it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.31it/s]
2025-01-07:00:22:43,789 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-07:00:22:43,793 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 342.45it/s] 70%|███████   | 70/100 [00:00<00:00, 340.38it/s]100%|██████████| 100/100 [00:00<00:00, 342.60it/s]
2025-01-07:00:22:44,089 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:39<1:05:42, 39.82s/it]Running generate_until requests:   2%|▏         | 2/100 [01:13<59:27, 36.40s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:52<1:00:25, 37.38s/it]Running generate_until requests:   4%|▍         | 4/100 [02:30<1:00:00, 37.50s/it]Running generate_until requests:   5%|▌         | 5/100 [03:06<58:50, 37.17s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:42<57:45, 36.87s/it]Running generate_until requests:   7%|▋         | 7/100 [04:11<52:51, 34.10s/it]Running generate_until requests:   8%|▊         | 8/100 [04:42<50:50, 33.15s/it]Running generate_until requests:   9%|▉         | 9/100 [05:18<51:40, 34.07s/it]Running generate_until requests:  10%|█         | 10/100 [05:54<51:59, 34.66s/it]Running generate_until requests:  11%|█         | 11/100 [06:30<51:53, 34.99s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:42<41:00, 27.96s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:17<43:55, 30.29s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:31<36:25, 25.42s/it]Running generate_until requests:  15%|█▌        | 15/100 [07:59<37:02, 26.15s/it]Running generate_until requests:  16%|█▌        | 16/100 [08:30<38:30, 27.51s/it]Running generate_until requests:  17%|█▋        | 17/100 [08:42<31:49, 23.00s/it]Running generate_until requests:  18%|█▊        | 18/100 [09:17<36:11, 26.48s/it]Running generate_until requests:  19%|█▉        | 19/100 [09:50<38:31, 28.53s/it]Running generate_until requests:  20%|██        | 20/100 [10:25<40:23, 30.29s/it]Running generate_until requests:  21%|██        | 21/100 [10:59<41:20, 31.39s/it]Running generate_until requests:  22%|██▏       | 22/100 [11:33<41:46, 32.13s/it]Running generate_until requests:  23%|██▎       | 23/100 [12:03<40:37, 31.66s/it]Running generate_until requests:  24%|██▍       | 24/100 [12:37<40:50, 32.24s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:01<37:24, 29.93s/it]Running generate_until requests:  26%|██▌       | 26/100 [13:35<38:15, 31.03s/it]Running generate_until requests:  27%|██▋       | 27/100 [13:52<32:50, 27.00s/it]Running generate_until requests:  28%|██▊       | 28/100 [14:17<31:33, 26.29s/it]Running generate_until requests:  29%|██▉       | 29/100 [14:51<33:40, 28.46s/it]Running generate_until requests:  30%|███       | 30/100 [15:24<34:55, 29.93s/it]Running generate_until requests:  31%|███       | 31/100 [15:41<30:05, 26.16s/it]Running generate_until requests:  32%|███▏      | 32/100 [16:15<32:02, 28.27s/it]Running generate_until requests:  33%|███▎      | 33/100 [16:48<33:12, 29.74s/it]Running generate_until requests:  34%|███▍      | 34/100 [17:21<33:49, 30.76s/it]Running generate_until requests:  35%|███▌      | 35/100 [17:49<32:21, 29.87s/it]Running generate_until requests:  36%|███▌      | 36/100 [18:22<32:52, 30.82s/it]Running generate_until requests:  37%|███▋      | 37/100 [18:55<33:01, 31.45s/it]Running generate_until requests:  38%|███▊      | 38/100 [19:28<32:57, 31.90s/it]Running generate_until requests:  39%|███▉      | 39/100 [20:00<32:44, 32.20s/it]Running generate_until requests:  40%|████      | 40/100 [20:24<29:29, 29.48s/it]Running generate_until requests:  41%|████      | 41/100 [20:51<28:16, 28.76s/it]Running generate_until requests:  42%|████▏     | 42/100 [21:17<27:00, 27.94s/it]Running generate_until requests:  43%|████▎     | 43/100 [21:48<27:34, 29.03s/it]Running generate_until requests:  44%|████▍     | 44/100 [22:21<28:07, 30.14s/it]Running generate_until requests:  45%|████▌     | 45/100 [22:54<28:17, 30.86s/it]Running generate_until requests:  46%|████▌     | 46/100 [23:11<24:04, 26.74s/it]Running generate_until requests:  47%|████▋     | 47/100 [23:43<25:06, 28.42s/it]Running generate_until requests:  48%|████▊     | 48/100 [24:15<25:36, 29.54s/it]Running generate_until requests:  49%|████▉     | 49/100 [24:47<25:44, 30.29s/it]Running generate_until requests:  50%|█████     | 50/100 [25:19<25:41, 30.83s/it]Running generate_until requests:  51%|█████     | 51/100 [25:51<25:27, 31.16s/it]Running generate_until requests:  52%|█████▏    | 52/100 [26:23<25:06, 31.38s/it]Running generate_until requests:  53%|█████▎    | 53/100 [26:55<24:39, 31.48s/it]Running generate_until requests:  54%|█████▍    | 54/100 [27:26<24:10, 31.53s/it]Running generate_until requests:  55%|█████▌    | 55/100 [27:58<23:40, 31.57s/it]Running generate_until requests:  56%|█████▌    | 56/100 [28:30<23:10, 31.59s/it]Running generate_until requests:  57%|█████▋    | 57/100 [28:57<21:39, 30.23s/it]Running generate_until requests:  58%|█████▊    | 58/100 [29:28<21:26, 30.63s/it]Running generate_until requests:  59%|█████▉    | 59/100 [30:00<21:05, 30.87s/it]Running generate_until requests:  60%|██████    | 60/100 [30:31<20:40, 31.02s/it]Running generate_until requests:  61%|██████    | 61/100 [30:51<17:57, 27.63s/it]Running generate_until requests:  62%|██████▏   | 62/100 [31:08<15:32, 24.55s/it]Running generate_until requests:  63%|██████▎   | 63/100 [31:23<13:17, 21.56s/it]Running generate_until requests:  64%|██████▍   | 64/100 [31:54<14:40, 24.45s/it]Running generate_until requests:  65%|██████▌   | 65/100 [32:25<15:25, 26.45s/it]Running generate_until requests:  66%|██████▌   | 66/100 [32:44<13:38, 24.07s/it]Running generate_until requests:  67%|██████▋   | 67/100 [32:56<11:21, 20.66s/it]Running generate_until requests:  68%|██████▊   | 68/100 [33:27<12:39, 23.74s/it]Running generate_until requests:  69%|██████▉   | 69/100 [33:54<12:46, 24.74s/it]Running generate_until requests:  70%|███████   | 70/100 [34:18<12:15, 24.51s/it]Running generate_until requests:  71%|███████   | 71/100 [34:49<12:43, 26.32s/it]Running generate_until requests:  72%|███████▏  | 72/100 [35:07<11:05, 23.75s/it]Running generate_until requests:  73%|███████▎  | 73/100 [35:37<11:35, 25.76s/it]Running generate_until requests:  74%|███████▍  | 74/100 [35:58<10:33, 24.36s/it]Running generate_until requests:  75%|███████▌  | 75/100 [36:14<09:05, 21.83s/it]Running generate_until requests:  76%|███████▌  | 76/100 [36:41<09:19, 23.33s/it]Running generate_until requests:  77%|███████▋  | 77/100 [36:57<08:03, 21.03s/it]Running generate_until requests:  78%|███████▊  | 78/100 [37:27<08:43, 23.82s/it]Running generate_until requests:  79%|███████▉  | 79/100 [37:51<08:20, 23.84s/it]Running generate_until requests:  80%|████████  | 80/100 [38:07<07:10, 21.53s/it]Running generate_until requests:  81%|████████  | 81/100 [38:37<07:35, 24.00s/it]Running generate_until requests:  82%|████████▏ | 82/100 [39:06<07:42, 25.67s/it]Running generate_until requests:  83%|████████▎ | 83/100 [39:36<07:36, 26.87s/it]Running generate_until requests:  84%|████████▍ | 84/100 [39:51<06:11, 23.21s/it]Running generate_until requests:  85%|████████▌ | 85/100 [40:18<06:07, 24.47s/it]Running generate_until requests:  86%|████████▌ | 86/100 [40:48<06:03, 25.96s/it]Running generate_until requests:  87%|████████▋ | 87/100 [41:17<05:50, 26.95s/it]Running generate_until requests:  88%|████████▊ | 88/100 [41:36<04:55, 24.66s/it]Running generate_until requests:  89%|████████▉ | 89/100 [42:05<04:45, 25.97s/it]Running generate_until requests:  90%|█████████ | 90/100 [42:34<04:28, 26.86s/it]Running generate_until requests:  91%|█████████ | 91/100 [43:03<04:07, 27.46s/it]Running generate_until requests:  92%|█████████▏| 92/100 [43:19<03:11, 23.98s/it]Running generate_until requests:  93%|█████████▎| 93/100 [43:30<02:20, 20.05s/it]Running generate_until requests:  94%|█████████▍| 94/100 [43:58<02:16, 22.67s/it]Running generate_until requests:  95%|█████████▌| 95/100 [44:27<02:02, 24.44s/it]Running generate_until requests:  96%|█████████▌| 96/100 [44:56<01:42, 25.67s/it]Running generate_until requests:  97%|█████████▋| 97/100 [45:24<01:19, 26.49s/it]Running generate_until requests:  98%|█████████▊| 98/100 [45:52<00:54, 27.07s/it]Running generate_until requests:  99%|█████████▉| 99/100 [46:06<00:23, 23.03s/it]Running generate_until requests: 100%|██████████| 100/100 [46:34<00:00, 24.41s/it]Running generate_until requests: 100%|██████████| 100/100 [46:34<00:00, 27.94s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:01:09:23,976 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:01:09:24,042 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-07:01:11:17,286 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-07:01:11:32,299 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-07:01:11:32,300 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-07:01:11:32,311 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-07:01:11:32,312 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-07:01:11:32,312 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-07:01:11:32,567 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-07:01:11:32,749 INFO     [huggingface.py:481] Using model type 'default'
2025-01-07:01:11:33,116 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.06s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.13it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.22it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.23it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.25it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.29it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.29it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.54it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.33it/s]
2025-01-07:01:11:44,271 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-07:01:11:44,273 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 36%|███▌      | 36/100 [00:00<00:00, 351.80it/s] 72%|███████▏  | 72/100 [00:00<00:00, 350.75it/s]100%|██████████| 100/100 [00:00<00:00, 350.48it/s]
2025-01-07:01:11:44,563 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:40<1:07:05, 40.66s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<59:38, 36.51s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:53<1:01:03, 37.77s/it]Running generate_until requests:   4%|▍         | 4/100 [02:32<1:00:52, 38.05s/it]Running generate_until requests:   5%|▌         | 5/100 [03:06<58:11, 36.75s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:43<57:44, 36.85s/it]Running generate_until requests:   7%|▋         | 7/100 [04:13<53:46, 34.69s/it]Running generate_until requests:   8%|▊         | 8/100 [04:44<51:13, 33.40s/it]Running generate_until requests:   9%|▉         | 9/100 [05:21<52:16, 34.47s/it]Running generate_until requests:  10%|█         | 10/100 [05:57<52:45, 35.17s/it]Running generate_until requests:  11%|█         | 11/100 [06:34<52:45, 35.57s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:46<41:42, 28.44s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:16<41:59, 28.96s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:52<44:36, 31.13s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:28<46:08, 32.57s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:04<46:56, 33.53s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:39<47:10, 34.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:15<47:07, 34.48s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:50<46:48, 34.67s/it]Running generate_until requests:  20%|██        | 20/100 [11:25<46:23, 34.80s/it]Running generate_until requests:  21%|██        | 21/100 [12:00<45:46, 34.77s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:34<45:07, 34.71s/it]Running generate_until requests:  23%|██▎       | 23/100 [13:04<42:38, 33.23s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:38<42:30, 33.57s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:57<36:14, 29.00s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:31<37:43, 30.59s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:05<38:34, 31.70s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:40<38:58, 32.47s/it]Running generate_until requests:  29%|██▉       | 29/100 [16:14<39:03, 33.01s/it]Running generate_until requests:  30%|███       | 30/100 [16:48<38:53, 33.34s/it]Running generate_until requests:  31%|███       | 31/100 [17:06<32:57, 28.67s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:39<34:06, 30.09s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:51<27:20, 24.48s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:24<30:01, 27.30s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:48<28:19, 26.14s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:22<30:19, 28.43s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:55<31:30, 30.01s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:29<32:08, 31.11s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:03<32:24, 31.87s/it]Running generate_until requests:  40%|████      | 40/100 [21:36<32:21, 32.37s/it]Running generate_until requests:  41%|████      | 41/100 [22:04<30:35, 31.10s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:35<30:03, 31.09s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:09<30:12, 31.80s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:42<30:08, 32.30s/it]Running generate_until requests:  45%|████▌     | 45/100 [24:16<29:52, 32.59s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:33<25:16, 28.07s/it]Running generate_until requests:  47%|████▋     | 47/100 [25:06<26:07, 29.57s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:39<26:29, 30.57s/it]Running generate_until requests:  49%|████▉     | 49/100 [26:12<26:32, 31.23s/it]Running generate_until requests:  50%|█████     | 50/100 [26:45<26:24, 31.69s/it]Running generate_until requests:  51%|█████     | 51/100 [27:17<26:07, 31.99s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:50<25:44, 32.18s/it]Running generate_until requests:  53%|█████▎    | 53/100 [28:22<25:16, 32.26s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:55<24:46, 32.32s/it]Running generate_until requests:  55%|█████▌    | 55/100 [29:12<20:49, 27.77s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:44<21:22, 29.14s/it]Running generate_until requests:  57%|█████▋    | 57/100 [30:15<21:06, 29.46s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:35<18:46, 26.82s/it]Running generate_until requests:  59%|█████▉    | 59/100 [31:07<19:25, 28.42s/it]Running generate_until requests:  60%|██████    | 60/100 [31:40<19:41, 29.54s/it]Running generate_until requests:  61%|██████    | 61/100 [32:02<17:47, 27.38s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:20<15:30, 24.49s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:34<13:11, 21.38s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:06<14:43, 24.55s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:38<15:36, 26.75s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:57<13:55, 24.59s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:10<11:35, 21.08s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:42<12:56, 24.25s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:13<13:40, 26.47s/it]Running generate_until requests:  70%|███████   | 70/100 [35:45<14:00, 28.01s/it]Running generate_until requests:  71%|███████   | 71/100 [36:16<14:00, 29.00s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:33<11:53, 25.47s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:05<12:13, 27.19s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:36<12:17, 28.36s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:52<10:18, 24.74s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:20<10:13, 25.57s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:35<08:40, 22.64s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:06<09:13, 25.17s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:30<08:38, 24.68s/it]Running generate_until requests:  80%|████████  | 80/100 [40:01<08:48, 26.44s/it]Running generate_until requests:  81%|████████  | 81/100 [40:31<08:45, 27.65s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:01<08:32, 28.48s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:32<08:13, 29.06s/it]Running generate_until requests:  84%|████████▍ | 84/100 [41:47<06:37, 24.84s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:14<06:21, 25.44s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:44<06:16, 26.86s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:14<06:01, 27.81s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:34<05:07, 25.65s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:04<04:55, 26.87s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:34<04:37, 27.73s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:04<04:14, 28.29s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:20<03:19, 24.88s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:50<03:03, 26.27s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:19<02:43, 27.24s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:42<02:08, 25.72s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:11<01:47, 26.80s/it]Running generate_until requests:  97%|█████████▋| 97/100 [47:40<01:22, 27.51s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:09<00:56, 28.01s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:23<00:23, 23.78s/it]Running generate_until requests: 100%|██████████| 100/100 [48:52<00:00, 25.18s/it]Running generate_until requests: 100%|██████████| 100/100 [48:52<00:00, 29.32s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:02:00:42,340 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:02:00:42,374 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-07:02:01:25,477 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-07:02:01:40,651 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-07:02:01:40,653 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-07:02:01:40,666 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-07:02:01:40,666 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-07:02:01:40,667 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-07:02:01:40,946 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-07:02:01:41,142 INFO     [huggingface.py:481] Using model type 'default'
2025-01-07:02:01:41,530 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.12s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:02<00:06,  1.13s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:04,  1.03it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.14it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.10it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:05<00:01,  1.16it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:06<00:00,  1.21it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.46it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.20it/s]
2025-01-07:02:01:53,394 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-07:02:01:53,397 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 337.64it/s] 69%|██████▉   | 69/100 [00:00<00:00, 343.72it/s]100%|██████████| 100/100 [00:00<00:00, 344.85it/s]
2025-01-07:02:01:53,691 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:40<1:07:09, 40.70s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<59:46, 36.60s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:53<1:01:13, 37.87s/it]Running generate_until requests:   4%|▍         | 4/100 [02:32<1:01:03, 38.16s/it]Running generate_until requests:   5%|▌         | 5/100 [03:06<58:22, 36.87s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:44<57:55, 36.97s/it]Running generate_until requests:   7%|▋         | 7/100 [04:14<53:56, 34.80s/it]Running generate_until requests:   8%|▊         | 8/100 [04:45<51:23, 33.52s/it]Running generate_until requests:   9%|▉         | 9/100 [05:22<52:27, 34.59s/it]Running generate_until requests:  10%|█         | 10/100 [05:59<52:56, 35.29s/it]Running generate_until requests:  11%|█         | 11/100 [06:35<52:56, 35.69s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:47<41:51, 28.54s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:18<42:08, 29.06s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:54<44:45, 31.23s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:30<46:17, 32.68s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:06<47:03, 33.62s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:41<47:18, 34.20s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:17<47:16, 34.59s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:52<46:57, 34.78s/it]Running generate_until requests:  20%|██        | 20/100 [11:27<46:32, 34.91s/it]Running generate_until requests:  21%|██        | 21/100 [12:02<45:56, 34.89s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:37<45:17, 34.83s/it]Running generate_until requests:  23%|██▎       | 23/100 [13:07<42:48, 33.35s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:41<42:40, 33.69s/it]Running generate_until requests:  25%|██▌       | 25/100 [14:00<36:22, 29.11s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:34<37:52, 30.71s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:08<38:42, 31.82s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:43<39:06, 32.59s/it]Running generate_until requests:  29%|██▉       | 29/100 [16:17<39:12, 33.13s/it]Running generate_until requests:  30%|███       | 30/100 [16:51<39:02, 33.46s/it]Running generate_until requests:  31%|███       | 31/100 [17:09<33:05, 28.77s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:43<34:13, 30.20s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:54<27:26, 24.57s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:28<30:08, 27.40s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:52<28:25, 26.24s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:26<30:26, 28.53s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:59<31:37, 30.12s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:33<32:16, 31.23s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:07<32:32, 32.01s/it]Running generate_until requests:  40%|████      | 40/100 [21:41<32:29, 32.49s/it]Running generate_until requests:  41%|████      | 41/100 [22:09<30:42, 31.22s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:40<30:09, 31.20s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:14<30:19, 31.92s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:47<30:14, 32.41s/it]Running generate_until requests:  45%|████▌     | 45/100 [24:21<29:58, 32.70s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:38<25:21, 28.17s/it]Running generate_until requests:  47%|████▋     | 47/100 [25:11<26:12, 29.67s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:44<26:34, 30.67s/it]Running generate_until requests:  49%|████▉     | 49/100 [26:17<26:38, 31.34s/it]Running generate_until requests:  50%|█████     | 50/100 [26:50<26:29, 31.80s/it]Running generate_until requests:  51%|█████     | 51/100 [27:23<26:12, 32.10s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:56<25:49, 32.29s/it]Running generate_until requests:  53%|█████▎    | 53/100 [28:28<25:21, 32.37s/it]Running generate_until requests:  54%|█████▍    | 54/100 [29:01<24:51, 32.43s/it]Running generate_until requests:  55%|█████▌    | 55/100 [29:18<20:53, 27.87s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:51<21:26, 29.24s/it]Running generate_until requests:  57%|█████▋    | 57/100 [30:21<21:11, 29.57s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:42<18:50, 26.92s/it]Running generate_until requests:  59%|█████▉    | 59/100 [31:14<19:29, 28.53s/it]Running generate_until requests:  60%|██████    | 60/100 [31:46<19:45, 29.64s/it]Running generate_until requests:  61%|██████    | 61/100 [32:09<17:51, 27.47s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:26<15:33, 24.57s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:40<13:13, 21.45s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:13<14:46, 24.63s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:45<15:39, 26.84s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:04<13:58, 24.67s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:17<11:38, 21.15s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:49<12:59, 24.36s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:21<13:44, 26.58s/it]Running generate_until requests:  70%|███████   | 70/100 [35:52<14:03, 28.12s/it]Running generate_until requests:  71%|███████   | 71/100 [36:24<14:04, 29.11s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:41<11:55, 25.57s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:12<12:16, 27.29s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:44<12:20, 28.47s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:00<10:20, 24.84s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:28<10:16, 25.67s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:43<08:42, 22.73s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:15<09:15, 25.26s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:38<08:40, 24.77s/it]Running generate_until requests:  80%|████████  | 80/100 [40:09<08:50, 26.54s/it]Running generate_until requests:  81%|████████  | 81/100 [40:40<08:47, 27.75s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:10<08:34, 28.59s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:41<08:15, 29.16s/it]Running generate_until requests:  84%|████████▍ | 84/100 [41:56<06:38, 24.93s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:23<06:22, 25.53s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:53<06:17, 26.96s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:23<06:02, 27.91s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:44<05:08, 25.74s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:14<04:56, 26.97s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:43<04:38, 27.83s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:13<04:15, 28.40s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:30<03:19, 24.97s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:00<03:04, 26.37s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:29<02:44, 27.35s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:52<02:09, 25.82s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:21<01:47, 26.90s/it]Running generate_until requests:  97%|█████████▋| 97/100 [47:50<01:22, 27.62s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:20<00:56, 28.11s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:34<00:23, 23.88s/it]Running generate_until requests: 100%|██████████| 100/100 [49:02<00:00, 25.28s/it]Running generate_until requests: 100%|██████████| 100/100 [49:02<00:00, 29.43s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:02:51:01,850 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:02:51:01,897 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-07:02:51:44,258 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-07:02:51:58,673 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-07:02:51:58,674 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-07:02:51:58,685 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-07:02:51:58,685 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-07:02:51:58,686 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-07:02:51:58,950 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-07:02:51:59,324 INFO     [huggingface.py:481] Using model type 'default'
2025-01-07:02:51:59,687 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.09s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.10it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.17it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.22it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.25it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.26it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.29it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:06<00:00,  1.31it/s]
2025-01-07:02:52:11,186 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-07:02:52:11,189 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 346.03it/s] 70%|███████   | 70/100 [00:00<00:00, 344.80it/s]100%|██████████| 100/100 [00:00<00:00, 346.96it/s]
2025-01-07:02:52:11,482 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:40<1:06:55, 40.57s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<59:35, 36.49s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:53<1:01:03, 37.77s/it]Running generate_until requests:   4%|▍         | 4/100 [02:31<1:00:53, 38.06s/it]Running generate_until requests:   5%|▌         | 5/100 [03:06<58:12, 36.77s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:43<57:45, 36.87s/it]Running generate_until requests:   7%|▋         | 7/100 [04:13<53:47, 34.71s/it]Running generate_until requests:   8%|▊         | 8/100 [04:44<51:14, 33.42s/it]Running generate_until requests:   9%|▉         | 9/100 [05:21<52:18, 34.49s/it]Running generate_until requests:  10%|█         | 10/100 [05:58<52:47, 35.19s/it]Running generate_until requests:  11%|█         | 11/100 [06:34<52:47, 35.59s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:46<41:44, 28.46s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:16<42:01, 28.98s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:53<44:38, 31.14s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:28<46:10, 32.59s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:04<46:55, 33.52s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:40<47:10, 34.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:15<47:08, 34.49s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:50<46:49, 34.69s/it]Running generate_until requests:  20%|██        | 20/100 [11:25<46:24, 34.81s/it]Running generate_until requests:  21%|██        | 21/100 [12:00<45:48, 34.79s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:35<45:09, 34.73s/it]Running generate_until requests:  23%|██▎       | 23/100 [13:04<42:40, 33.25s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:39<42:32, 33.59s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:57<36:16, 29.02s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:31<37:45, 30.62s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:06<38:39, 31.77s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:40<39:02, 32.53s/it]Running generate_until requests:  29%|██▉       | 29/100 [16:14<39:06, 33.05s/it]Running generate_until requests:  30%|███       | 30/100 [16:49<38:56, 33.38s/it]Running generate_until requests:  31%|███       | 31/100 [17:06<33:00, 28.70s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:40<34:08, 30.13s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:51<27:22, 24.52s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:25<30:04, 27.34s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:49<28:21, 26.18s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:22<30:21, 28.46s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:56<31:32, 30.05s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:30<32:11, 31.15s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:04<32:26, 31.91s/it]Running generate_until requests:  40%|████      | 40/100 [21:37<32:24, 32.40s/it]Running generate_until requests:  41%|████      | 41/100 [22:05<30:37, 31.14s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:36<30:05, 31.12s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:10<30:14, 31.84s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:43<30:10, 32.32s/it]Running generate_until requests:  45%|████▌     | 45/100 [24:17<29:54, 32.62s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:34<25:17, 28.10s/it]Running generate_until requests:  47%|████▋     | 47/100 [25:07<26:08, 29.60s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:40<26:31, 30.60s/it]Running generate_until requests:  49%|████▉     | 49/100 [26:13<26:34, 31.26s/it]Running generate_until requests:  50%|█████     | 50/100 [26:46<26:26, 31.72s/it]Running generate_until requests:  51%|█████     | 51/100 [27:19<26:09, 32.02s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:51<25:46, 32.21s/it]Running generate_until requests:  53%|█████▎    | 53/100 [28:24<25:17, 32.29s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:56<24:48, 32.35s/it]Running generate_until requests:  55%|█████▌    | 55/100 [29:13<20:50, 27.80s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:46<21:23, 29.17s/it]Running generate_until requests:  57%|█████▋    | 57/100 [30:16<21:08, 29.50s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:37<18:47, 26.86s/it]Running generate_until requests:  59%|█████▉    | 59/100 [31:09<19:26, 28.46s/it]Running generate_until requests:  60%|██████    | 60/100 [31:41<19:42, 29.57s/it]Running generate_until requests:  61%|██████    | 61/100 [32:04<17:48, 27.41s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:21<15:31, 24.51s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:35<13:11, 21.40s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:07<14:44, 24.57s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:39<15:37, 26.78s/it]Running generate_until requests:  66%|██████▌   | 66/100 [33:59<13:56, 24.61s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:12<11:36, 21.10s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:43<12:56, 24.28s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:15<13:41, 26.50s/it]Running generate_until requests:  70%|███████   | 70/100 [35:47<14:01, 28.04s/it]Running generate_until requests:  71%|███████   | 71/100 [36:18<14:01, 29.03s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:35<11:54, 25.50s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:07<12:14, 27.22s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:38<12:18, 28.40s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:54<10:19, 24.77s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:22<10:14, 25.61s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:37<08:41, 22.67s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:09<09:14, 25.20s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:32<08:38, 24.71s/it]Running generate_until requests:  80%|████████  | 80/100 [40:03<08:50, 26.53s/it]Running generate_until requests:  81%|████████  | 81/100 [40:33<08:46, 27.72s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:04<08:33, 28.55s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:34<08:14, 29.11s/it]Running generate_until requests:  84%|████████▍ | 84/100 [41:49<06:38, 24.88s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:16<06:22, 25.47s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:46<06:16, 26.90s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:16<06:01, 27.84s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:37<05:08, 25.68s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:07<04:55, 26.90s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:37<04:37, 27.76s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:06<04:14, 28.32s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:23<03:19, 24.91s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:53<03:04, 26.31s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:22<02:43, 27.28s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:44<02:08, 25.75s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:14<01:47, 26.83s/it]Running generate_until requests:  97%|█████████▋| 97/100 [47:43<01:22, 27.54s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:12<00:56, 28.04s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:26<00:23, 23.81s/it]Running generate_until requests: 100%|██████████| 100/100 [48:55<00:00, 25.21s/it]Running generate_until requests: 100%|██████████| 100/100 [48:55<00:00, 29.35s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:03:41:12,178 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:03:41:12,276 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-07:03:41:55,174 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-07:03:42:09,126 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-07:03:42:09,128 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-07:03:42:09,137 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-07:03:42:09,138 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-07:03:42:09,138 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-07:03:42:09,400 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-07:03:42:09,604 INFO     [huggingface.py:481] Using model type 'default'
2025-01-07:03:42:09,987 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:09,  1.29s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:02<00:06,  1.05s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:06,  1.26s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:04<00:04,  1.11s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:05<00:03,  1.06s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:06<00:02,  1.09s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:07<00:01,  1.01s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:08<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:08<00:00,  1.00s/it]
2025-01-07:03:42:22,979 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-07:03:42:22,981 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.47it/s] 71%|███████   | 71/100 [00:00<00:00, 349.72it/s]100%|██████████| 100/100 [00:00<00:00, 350.14it/s]
2025-01-07:03:42:23,272 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:40<1:07:18, 40.80s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<59:53, 36.66s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:54<1:01:20, 37.94s/it]Running generate_until requests:   4%|▍         | 4/100 [02:32<1:01:10, 38.23s/it]Running generate_until requests:   5%|▌         | 5/100 [03:07<58:28, 36.93s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:44<58:01, 37.04s/it]Running generate_until requests:   7%|▋         | 7/100 [04:14<54:02, 34.86s/it]Running generate_until requests:   8%|▊         | 8/100 [04:45<51:29, 33.58s/it]Running generate_until requests:   9%|▉         | 9/100 [05:22<52:33, 34.66s/it]Running generate_until requests:  10%|█         | 10/100 [05:59<53:02, 35.36s/it]Running generate_until requests:  11%|█         | 11/100 [06:36<53:03, 35.77s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:48<41:56, 28.60s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:18<42:13, 29.13s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:55<44:51, 31.30s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:31<46:23, 32.75s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:07<47:09, 33.69s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:42<47:24, 34.28s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:18<47:23, 34.67s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:53<47:04, 34.88s/it]Running generate_until requests:  20%|██        | 20/100 [11:29<46:39, 34.99s/it]Running generate_until requests:  21%|██        | 21/100 [12:04<46:02, 34.97s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:38<45:22, 34.91s/it]Running generate_until requests:  23%|██▎       | 23/100 [13:08<42:53, 33.42s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:43<42:45, 33.75s/it]Running generate_until requests:  25%|██▌       | 25/100 [14:01<36:27, 29.16s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:36<37:57, 30.77s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:10<38:47, 31.88s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:45<39:11, 32.66s/it]Running generate_until requests:  29%|██▉       | 29/100 [16:19<39:16, 33.20s/it]Running generate_until requests:  30%|███       | 30/100 [16:54<39:07, 33.53s/it]Running generate_until requests:  31%|███       | 31/100 [17:11<33:09, 28.83s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:45<34:17, 30.26s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:56<27:29, 24.62s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:30<30:11, 27.45s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:54<28:29, 26.29s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:28<30:29, 28.59s/it]Running generate_until requests:  37%|███▋      | 37/100 [20:02<31:41, 30.19s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:36<32:20, 31.30s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:10<32:36, 32.07s/it]Running generate_until requests:  40%|████      | 40/100 [21:43<32:33, 32.56s/it]Running generate_until requests:  41%|████      | 41/100 [22:12<30:45, 31.29s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:43<30:13, 31.27s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:17<30:23, 31.99s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:50<30:18, 32.48s/it]Running generate_until requests:  45%|████▌     | 45/100 [24:24<30:02, 32.77s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:41<25:24, 28.23s/it]Running generate_until requests:  47%|████▋     | 47/100 [25:15<26:16, 29.74s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:48<26:38, 30.75s/it]Running generate_until requests:  49%|████▉     | 49/100 [26:21<26:42, 31.41s/it]Running generate_until requests:  50%|█████     | 50/100 [26:54<26:33, 31.87s/it]Running generate_until requests:  51%|█████     | 51/100 [27:26<26:16, 32.17s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:59<25:53, 32.37s/it]Running generate_until requests:  53%|█████▎    | 53/100 [28:32<25:25, 32.45s/it]Running generate_until requests:  54%|█████▍    | 54/100 [29:05<24:55, 32.51s/it]Running generate_until requests:  55%|█████▌    | 55/100 [29:22<20:56, 27.93s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:54<21:29, 29.32s/it]Running generate_until requests:  57%|█████▋    | 57/100 [30:25<21:14, 29.63s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:46<18:53, 26.99s/it]Running generate_until requests:  59%|█████▉    | 59/100 [31:18<19:32, 28.60s/it]Running generate_until requests:  60%|██████    | 60/100 [31:50<19:48, 29.71s/it]Running generate_until requests:  61%|██████    | 61/100 [32:13<17:54, 27.56s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:31<15:36, 24.64s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:45<13:15, 21.51s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:17<14:48, 24.69s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:49<15:41, 26.90s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:09<14:00, 24.73s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:22<11:39, 21.20s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:53<13:00, 24.39s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:25<13:45, 26.62s/it]Running generate_until requests:  70%|███████   | 70/100 [35:57<14:05, 28.17s/it]Running generate_until requests:  71%|███████   | 71/100 [36:29<14:05, 29.16s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:46<11:57, 25.62s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:17<12:18, 27.34s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:49<12:21, 28.53s/it]Running generate_until requests:  75%|███████▌  | 75/100 [38:05<10:22, 24.89s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:33<10:17, 25.72s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:48<08:43, 22.77s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:20<09:16, 25.31s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:43<08:41, 24.82s/it]Running generate_until requests:  80%|████████  | 80/100 [40:14<08:51, 26.60s/it]Running generate_until requests:  81%|████████  | 81/100 [40:45<08:48, 27.83s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:15<08:35, 28.66s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:46<08:16, 29.24s/it]Running generate_until requests:  84%|████████▍ | 84/100 [42:01<06:39, 24.99s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:28<06:23, 25.59s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:58<06:18, 27.02s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:29<06:03, 27.98s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:49<05:09, 25.80s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:19<04:57, 27.04s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:49<04:39, 27.91s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:19<04:16, 28.48s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:36<03:20, 25.04s/it]Running generate_until requests:  93%|█████████▎| 93/100 [46:06<03:05, 26.44s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:35<02:44, 27.42s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:58<02:09, 25.88s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:27<01:47, 26.97s/it]Running generate_until requests:  97%|█████████▋| 97/100 [47:57<01:23, 27.69s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:26<00:56, 28.18s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:40<00:23, 23.93s/it]Running generate_until requests: 100%|██████████| 100/100 [49:09<00:00, 25.34s/it]Running generate_until requests: 100%|██████████| 100/100 [49:09<00:00, 29.49s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:04:31:37,952 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:04:31:38,016 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2025-01-07:04:32:20,193 INFO     [__main__.py:279] Verbosity set to INFO
2025-01-07:04:32:33,859 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2025-01-07:04:32:33,860 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2025-01-07:04:32:33,871 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-01-07:04:32:33,871 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2025-01-07:04:32:33,871 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-14B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2025-01-07:04:32:34,140 INFO     [huggingface.py:129] Using device 'cuda'
2025-01-07:04:32:34,562 INFO     [huggingface.py:481] Using model type 'default'
2025-01-07:04:32:35,125 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.06s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:05,  1.15it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:04,  1.21it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.26it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:04<00:02,  1.28it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.31it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.32it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.57it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.35it/s]
2025-01-07:04:32:46,619 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2025-01-07:04:32:46,622 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 34%|███▍      | 34/100 [00:00<00:00, 337.87it/s] 70%|███████   | 70/100 [00:00<00:00, 345.95it/s]100%|██████████| 100/100 [00:00<00:00, 347.00it/s]
2025-01-07:04:32:46,915 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:40<1:06:56, 40.57s/it]Running generate_until requests:   2%|▏         | 2/100 [01:14<59:35, 36.49s/it]  Running generate_until requests:   3%|▎         | 3/100 [01:53<1:01:03, 37.77s/it]Running generate_until requests:   4%|▍         | 4/100 [02:32<1:00:54, 38.06s/it]Running generate_until requests:   5%|▌         | 5/100 [03:06<58:13, 36.77s/it]  Running generate_until requests:   6%|▌         | 6/100 [03:43<57:46, 36.88s/it]Running generate_until requests:   7%|▋         | 7/100 [04:13<53:48, 34.71s/it]Running generate_until requests:   8%|▊         | 8/100 [04:44<51:15, 33.43s/it]Running generate_until requests:   9%|▉         | 9/100 [05:21<52:19, 34.50s/it]Running generate_until requests:  10%|█         | 10/100 [05:58<52:48, 35.20s/it]Running generate_until requests:  11%|█         | 11/100 [06:34<52:48, 35.60s/it]Running generate_until requests:  12%|█▏        | 12/100 [06:46<41:44, 28.46s/it]Running generate_until requests:  13%|█▎        | 13/100 [07:16<42:01, 28.99s/it]Running generate_until requests:  14%|█▍        | 14/100 [07:53<44:39, 31.15s/it]Running generate_until requests:  15%|█▌        | 15/100 [08:29<46:10, 32.60s/it]Running generate_until requests:  16%|█▌        | 16/100 [09:04<46:57, 33.54s/it]Running generate_until requests:  17%|█▋        | 17/100 [09:40<47:12, 34.13s/it]Running generate_until requests:  18%|█▊        | 18/100 [10:15<47:11, 34.52s/it]Running generate_until requests:  19%|█▉        | 19/100 [10:50<46:51, 34.72s/it]Running generate_until requests:  20%|██        | 20/100 [11:26<46:27, 34.84s/it]Running generate_until requests:  21%|██        | 21/100 [12:00<45:50, 34.82s/it]Running generate_until requests:  22%|██▏       | 22/100 [12:35<45:11, 34.76s/it]Running generate_until requests:  23%|██▎       | 23/100 [13:05<42:42, 33.28s/it]Running generate_until requests:  24%|██▍       | 24/100 [13:39<42:34, 33.62s/it]Running generate_until requests:  25%|██▌       | 25/100 [13:58<36:18, 29.04s/it]Running generate_until requests:  26%|██▌       | 26/100 [14:32<37:47, 30.64s/it]Running generate_until requests:  27%|██▋       | 27/100 [15:06<38:37, 31.75s/it]Running generate_until requests:  28%|██▊       | 28/100 [15:41<39:01, 32.52s/it]Running generate_until requests:  29%|██▉       | 29/100 [16:15<39:06, 33.05s/it]Running generate_until requests:  30%|███       | 30/100 [16:49<38:57, 33.39s/it]Running generate_until requests:  31%|███       | 31/100 [17:07<33:00, 28.71s/it]Running generate_until requests:  32%|███▏      | 32/100 [17:40<34:09, 30.13s/it]Running generate_until requests:  33%|███▎      | 33/100 [17:52<27:22, 24.52s/it]Running generate_until requests:  34%|███▍      | 34/100 [18:26<30:04, 27.34s/it]Running generate_until requests:  35%|███▌      | 35/100 [18:49<28:21, 26.18s/it]Running generate_until requests:  36%|███▌      | 36/100 [19:23<30:22, 28.47s/it]Running generate_until requests:  37%|███▋      | 37/100 [19:57<31:33, 30.05s/it]Running generate_until requests:  38%|███▊      | 38/100 [20:30<32:12, 31.16s/it]Running generate_until requests:  39%|███▉      | 39/100 [21:04<32:27, 31.92s/it]Running generate_until requests:  40%|████      | 40/100 [21:38<32:24, 32.41s/it]Running generate_until requests:  41%|████      | 41/100 [22:06<30:37, 31.15s/it]Running generate_until requests:  42%|████▏     | 42/100 [22:37<30:05, 31.13s/it]Running generate_until requests:  43%|████▎     | 43/100 [23:10<30:15, 31.85s/it]Running generate_until requests:  44%|████▍     | 44/100 [23:44<30:10, 32.34s/it]Running generate_until requests:  45%|████▌     | 45/100 [24:17<29:54, 32.63s/it]Running generate_until requests:  46%|████▌     | 46/100 [24:35<25:18, 28.13s/it]Running generate_until requests:  47%|████▋     | 47/100 [25:08<26:10, 29.62s/it]Running generate_until requests:  48%|████▊     | 48/100 [25:41<26:32, 30.62s/it]Running generate_until requests:  49%|████▉     | 49/100 [26:14<26:35, 31.28s/it]Running generate_until requests:  50%|█████     | 50/100 [26:47<26:26, 31.74s/it]Running generate_until requests:  51%|█████     | 51/100 [27:19<26:09, 32.04s/it]Running generate_until requests:  52%|█████▏    | 52/100 [27:52<25:46, 32.22s/it]Running generate_until requests:  53%|█████▎    | 53/100 [28:24<25:18, 32.30s/it]Running generate_until requests:  54%|█████▍    | 54/100 [28:57<24:48, 32.36s/it]Running generate_until requests:  55%|█████▌    | 55/100 [29:14<20:51, 27.81s/it]Running generate_until requests:  56%|█████▌    | 56/100 [29:47<21:23, 29.18s/it]Running generate_until requests:  57%|█████▋    | 57/100 [30:17<21:08, 29.51s/it]Running generate_until requests:  58%|█████▊    | 58/100 [30:38<18:48, 26.86s/it]Running generate_until requests:  59%|█████▉    | 59/100 [31:10<19:27, 28.46s/it]Running generate_until requests:  60%|██████    | 60/100 [31:42<19:43, 29.58s/it]Running generate_until requests:  61%|██████    | 61/100 [32:04<17:49, 27.41s/it]Running generate_until requests:  62%|██████▏   | 62/100 [32:22<15:31, 24.52s/it]Running generate_until requests:  63%|██████▎   | 63/100 [32:36<13:12, 21.41s/it]Running generate_until requests:  64%|██████▍   | 64/100 [33:08<14:44, 24.58s/it]Running generate_until requests:  65%|██████▌   | 65/100 [33:40<15:37, 26.78s/it]Running generate_until requests:  66%|██████▌   | 66/100 [34:00<13:57, 24.62s/it]Running generate_until requests:  67%|██████▋   | 67/100 [34:13<11:36, 21.11s/it]Running generate_until requests:  68%|██████▊   | 68/100 [34:44<12:57, 24.28s/it]Running generate_until requests:  69%|██████▉   | 69/100 [35:16<13:41, 26.51s/it]Running generate_until requests:  70%|███████   | 70/100 [35:48<14:01, 28.04s/it]Running generate_until requests:  71%|███████   | 71/100 [36:19<14:01, 29.03s/it]Running generate_until requests:  72%|███████▏  | 72/100 [36:36<11:54, 25.51s/it]Running generate_until requests:  73%|███████▎  | 73/100 [37:07<12:14, 27.22s/it]Running generate_until requests:  74%|███████▍  | 74/100 [37:39<12:18, 28.40s/it]Running generate_until requests:  75%|███████▌  | 75/100 [37:55<10:19, 24.78s/it]Running generate_until requests:  76%|███████▌  | 76/100 [38:22<10:14, 25.61s/it]Running generate_until requests:  77%|███████▋  | 77/100 [38:38<08:41, 22.67s/it]Running generate_until requests:  78%|███████▊  | 78/100 [39:09<09:14, 25.20s/it]Running generate_until requests:  79%|███████▉  | 79/100 [39:33<08:38, 24.71s/it]Running generate_until requests:  80%|████████  | 80/100 [40:04<08:49, 26.48s/it]Running generate_until requests:  81%|████████  | 81/100 [40:34<08:46, 27.69s/it]Running generate_until requests:  82%|████████▏ | 82/100 [41:05<08:33, 28.54s/it]Running generate_until requests:  83%|████████▎ | 83/100 [41:35<08:14, 29.10s/it]Running generate_until requests:  84%|████████▍ | 84/100 [41:50<06:38, 24.88s/it]Running generate_until requests:  85%|████████▌ | 85/100 [42:17<06:22, 25.47s/it]Running generate_until requests:  86%|████████▌ | 86/100 [42:47<06:16, 26.89s/it]Running generate_until requests:  87%|████████▋ | 87/100 [43:17<06:01, 27.84s/it]Running generate_until requests:  88%|████████▊ | 88/100 [43:38<05:08, 25.67s/it]Running generate_until requests:  89%|████████▉ | 89/100 [44:07<04:55, 26.90s/it]Running generate_until requests:  90%|█████████ | 90/100 [44:37<04:37, 27.75s/it]Running generate_until requests:  91%|█████████ | 91/100 [45:07<04:14, 28.32s/it]Running generate_until requests:  92%|█████████▏| 92/100 [45:24<03:19, 24.90s/it]Running generate_until requests:  93%|█████████▎| 93/100 [45:53<03:04, 26.30s/it]Running generate_until requests:  94%|█████████▍| 94/100 [46:23<02:43, 27.27s/it]Running generate_until requests:  95%|█████████▌| 95/100 [46:45<02:08, 25.74s/it]Running generate_until requests:  96%|█████████▌| 96/100 [47:14<01:47, 26.82s/it]Running generate_until requests:  97%|█████████▋| 97/100 [47:44<01:22, 27.53s/it]Running generate_until requests:  98%|█████████▊| 98/100 [48:13<00:56, 28.03s/it]Running generate_until requests:  99%|█████████▉| 99/100 [48:27<00:23, 23.80s/it]Running generate_until requests: 100%|██████████| 100/100 [48:55<00:00, 25.20s/it]Running generate_until requests: 100%|██████████| 100/100 [48:55<00:00, 29.36s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-01-07:05:21:48,226 INFO     [evaluation_tracker.py:206] Saving results aggregated
2025-01-07:05:21:48,259 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
