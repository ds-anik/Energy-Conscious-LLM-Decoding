2024-12-27:01:03:59,671 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:01:04:14,564 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:01:04:14,566 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:01:04:14,576 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:01:04:14,577 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:01:04:14,577 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:01:04:14,831 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:01:04:15,001 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:01:04:15,448 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.08s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.00it/s]
2024-12-27:01:04:24,508 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:01:04:24,512 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 344.52it/s] 70%|███████   | 70/100 [00:00<00:00, 347.16it/s]100%|██████████| 100/100 [00:00<00:00, 347.85it/s]
2024-12-27:01:04:24,805 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:04<07:48,  4.74s/it]Running generate_until requests:   2%|▏         | 2/100 [00:09<08:13,  5.04s/it]Running generate_until requests:   3%|▎         | 3/100 [00:17<10:14,  6.33s/it]Running generate_until requests:   4%|▍         | 4/100 [00:22<08:45,  5.48s/it]Running generate_until requests:   5%|▌         | 5/100 [00:26<08:17,  5.24s/it]Running generate_until requests:   6%|▌         | 6/100 [00:31<07:38,  4.87s/it]Running generate_until requests:   7%|▋         | 7/100 [00:36<07:47,  5.03s/it]Running generate_until requests:   8%|▊         | 8/100 [00:43<08:55,  5.82s/it]Running generate_until requests:   9%|▉         | 9/100 [00:47<07:52,  5.19s/it]Running generate_until requests:  10%|█         | 10/100 [00:50<06:49,  4.55s/it]Running generate_until requests:  11%|█         | 11/100 [00:55<07:00,  4.73s/it]Running generate_until requests:  12%|█▏        | 12/100 [00:59<06:15,  4.27s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:05<07:07,  4.91s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:09<06:47,  4.74s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:18<08:10,  5.77s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:25<08:37,  6.16s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:27<07:03,  5.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:31<06:37,  4.84s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:37<06:41,  4.95s/it]Running generate_until requests:  20%|██        | 20/100 [01:45<07:57,  5.97s/it]Running generate_until requests:  21%|██        | 21/100 [01:51<07:59,  6.07s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:57<07:34,  5.82s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:01<07:00,  5.46s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:09<07:50,  6.19s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:14<07:25,  5.94s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:17<06:11,  5.02s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:21<05:44,  4.72s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:27<06:04,  5.06s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:34<06:40,  5.64s/it]Running generate_until requests:  30%|███       | 30/100 [02:39<06:10,  5.29s/it]Running generate_until requests:  31%|███       | 31/100 [02:42<05:30,  4.79s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:51<06:36,  5.83s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:53<05:16,  4.73s/it]Running generate_until requests:  34%|███▍      | 34/100 [02:59<05:41,  5.18s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:04<05:32,  5.11s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:06<04:32,  4.25s/it]Running generate_until requests:  37%|███▋      | 37/100 [03:09<03:58,  3.78s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:16<05:03,  4.90s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:20<04:33,  4.48s/it]Running generate_until requests:  40%|████      | 40/100 [03:22<03:52,  3.88s/it]Running generate_until requests:  41%|████      | 41/100 [03:25<03:34,  3.63s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:30<03:42,  3.84s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:34<03:41,  3.88s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:36<03:08,  3.36s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:42<03:51,  4.22s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:46<03:49,  4.25s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:50<03:43,  4.21s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:53<03:15,  3.76s/it]Running generate_until requests:  49%|████▉     | 49/100 [04:01<04:19,  5.09s/it]Running generate_until requests:  50%|█████     | 50/100 [04:08<04:37,  5.56s/it]Running generate_until requests:  51%|█████     | 51/100 [04:11<03:55,  4.81s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:19<04:37,  5.77s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:27<05:05,  6.49s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:30<04:12,  5.49s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:36<04:08,  5.51s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:39<03:26,  4.69s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:43<03:15,  4.55s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:48<03:21,  4.80s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:52<03:08,  4.60s/it]Running generate_until requests:  60%|██████    | 60/100 [04:57<03:03,  4.60s/it]Running generate_until requests:  61%|██████    | 61/100 [05:01<02:52,  4.42s/it]Running generate_until requests:  62%|██████▏   | 62/100 [05:05<02:37,  4.14s/it]Running generate_until requests:  63%|██████▎   | 63/100 [05:08<02:26,  3.96s/it]Running generate_until requests:  64%|██████▍   | 64/100 [05:14<02:41,  4.48s/it]Running generate_until requests:  65%|██████▌   | 65/100 [05:18<02:28,  4.25s/it]Running generate_until requests:  66%|██████▌   | 66/100 [05:23<02:35,  4.58s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:25<02:06,  3.83s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:31<02:20,  4.39s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:35<02:14,  4.35s/it]Running generate_until requests:  70%|███████   | 70/100 [05:41<02:25,  4.86s/it]Running generate_until requests:  71%|███████   | 71/100 [05:49<02:48,  5.83s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:53<02:31,  5.40s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:57<02:11,  4.88s/it]Running generate_until requests:  74%|███████▍  | 74/100 [06:02<02:07,  4.89s/it]Running generate_until requests:  75%|███████▌  | 75/100 [06:05<01:46,  4.27s/it]Running generate_until requests:  76%|███████▌  | 76/100 [06:11<01:54,  4.75s/it]Running generate_until requests:  77%|███████▋  | 77/100 [06:15<01:43,  4.52s/it]Running generate_until requests:  78%|███████▊  | 78/100 [06:21<01:49,  4.99s/it]Running generate_until requests:  79%|███████▉  | 79/100 [06:26<01:46,  5.09s/it]Running generate_until requests:  80%|████████  | 80/100 [06:31<01:40,  5.03s/it]Running generate_until requests:  81%|████████  | 81/100 [06:35<01:28,  4.63s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:38<01:17,  4.29s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:45<01:26,  5.11s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:48<01:09,  4.32s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:55<01:19,  5.33s/it]Running generate_until requests:  86%|████████▌ | 86/100 [06:59<01:05,  4.71s/it]Running generate_until requests:  87%|████████▋ | 87/100 [07:04<01:04,  4.92s/it]Running generate_until requests:  88%|████████▊ | 88/100 [07:10<01:03,  5.28s/it]Running generate_until requests:  89%|████████▉ | 89/100 [07:16<00:58,  5.32s/it]Running generate_until requests:  90%|█████████ | 90/100 [07:18<00:45,  4.54s/it]Running generate_until requests:  91%|█████████ | 91/100 [07:23<00:41,  4.66s/it]Running generate_until requests:  92%|█████████▏| 92/100 [07:27<00:34,  4.30s/it]Running generate_until requests:  93%|█████████▎| 93/100 [07:30<00:27,  4.00s/it]Running generate_until requests:  94%|█████████▍| 94/100 [07:37<00:29,  4.90s/it]Running generate_until requests:  95%|█████████▌| 95/100 [07:44<00:27,  5.41s/it]Running generate_until requests:  96%|█████████▌| 96/100 [07:48<00:19,  4.97s/it]Running generate_until requests:  97%|█████████▋| 97/100 [07:53<00:15,  5.04s/it]Running generate_until requests:  98%|█████████▊| 98/100 [07:56<00:09,  4.63s/it]Running generate_until requests:  99%|█████████▉| 99/100 [08:00<00:04,  4.25s/it]Running generate_until requests: 100%|██████████| 100/100 [08:04<00:00,  4.16s/it]Running generate_until requests: 100%|██████████| 100/100 [08:04<00:00,  4.84s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:01:12:34,610 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:01:12:34,616 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:01:13:17,354 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:01:13:32,190 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:01:13:32,192 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:01:13:32,203 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:01:13:32,204 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:01:13:32,204 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:01:13:32,469 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:01:13:32,656 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:01:13:33,034 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.04s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.19it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.27it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s]
2024-12-27:01:13:41,433 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:01:13:41,436 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 343.69it/s] 70%|███████   | 70/100 [00:00<00:00, 344.05it/s]100%|██████████| 100/100 [00:00<00:00, 344.25it/s]
2024-12-27:01:13:41,731 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:04<07:42,  4.67s/it]Running generate_until requests:   2%|▏         | 2/100 [00:09<08:14,  5.05s/it]Running generate_until requests:   3%|▎         | 3/100 [00:17<10:18,  6.37s/it]Running generate_until requests:   4%|▍         | 4/100 [00:22<08:49,  5.51s/it]Running generate_until requests:   5%|▌         | 5/100 [00:26<08:20,  5.27s/it]Running generate_until requests:   6%|▌         | 6/100 [00:31<07:40,  4.90s/it]Running generate_until requests:   7%|▋         | 7/100 [00:36<07:50,  5.05s/it]Running generate_until requests:   8%|▊         | 8/100 [00:44<08:58,  5.85s/it]Running generate_until requests:   9%|▉         | 9/100 [00:47<07:54,  5.22s/it]Running generate_until requests:  10%|█         | 10/100 [00:51<06:51,  4.58s/it]Running generate_until requests:  11%|█         | 11/100 [00:56<07:03,  4.76s/it]Running generate_until requests:  12%|█▏        | 12/100 [00:59<06:17,  4.29s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:05<07:09,  4.94s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:10<06:49,  4.76s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:18<08:13,  5.80s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:25<08:40,  6.20s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:28<07:05,  5.13s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:32<06:39,  4.87s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:37<06:43,  4.98s/it]Running generate_until requests:  20%|██        | 20/100 [01:46<08:00,  6.00s/it]Running generate_until requests:  21%|██        | 21/100 [01:52<08:02,  6.10s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:57<07:36,  5.86s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:02<07:02,  5.49s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:10<07:52,  6.22s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:15<07:28,  5.98s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:18<06:13,  5.05s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:22<05:46,  4.75s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:28<06:06,  5.09s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:35<06:42,  5.67s/it]Running generate_until requests:  30%|███       | 30/100 [02:40<06:12,  5.32s/it]Running generate_until requests:  31%|███       | 31/100 [02:43<05:32,  4.82s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:51<06:38,  5.87s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:54<05:18,  4.76s/it]Running generate_until requests:  34%|███▍      | 34/100 [03:00<05:43,  5.21s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:05<05:33,  5.14s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:07<04:33,  4.28s/it]Running generate_until requests:  37%|███▋      | 37/100 [03:10<03:59,  3.81s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:17<05:05,  4.93s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:21<04:34,  4.51s/it]Running generate_until requests:  40%|████      | 40/100 [03:23<03:53,  3.90s/it]Running generate_until requests:  41%|████      | 41/100 [03:26<03:35,  3.65s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:31<03:44,  3.87s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:35<03:42,  3.90s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:37<03:09,  3.38s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:43<03:53,  4.24s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:48<03:50,  4.28s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:52<03:44,  4.23s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:54<03:16,  3.79s/it]Running generate_until requests:  49%|████▉     | 49/100 [04:03<04:21,  5.12s/it]Running generate_until requests:  50%|█████     | 50/100 [04:09<04:39,  5.59s/it]Running generate_until requests:  51%|█████     | 51/100 [04:12<03:56,  4.84s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:21<04:38,  5.81s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:29<05:06,  6.53s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:32<04:13,  5.52s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:38<04:09,  5.55s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:40<03:27,  4.72s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:45<03:16,  4.58s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:50<03:22,  4.83s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:54<03:09,  4.62s/it]Running generate_until requests:  60%|██████    | 60/100 [04:59<03:04,  4.62s/it]Running generate_until requests:  61%|██████    | 61/100 [05:03<02:53,  4.44s/it]Running generate_until requests:  62%|██████▏   | 62/100 [05:06<02:38,  4.16s/it]Running generate_until requests:  63%|██████▎   | 63/100 [05:10<02:27,  3.98s/it]Running generate_until requests:  64%|██████▍   | 64/100 [05:16<02:42,  4.50s/it]Running generate_until requests:  65%|██████▌   | 65/100 [05:19<02:29,  4.28s/it]Running generate_until requests:  66%|██████▌   | 66/100 [05:25<02:36,  4.60s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:27<02:07,  3.85s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:33<02:21,  4.42s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:37<02:15,  4.37s/it]Running generate_until requests:  70%|███████   | 70/100 [05:43<02:26,  4.88s/it]Running generate_until requests:  71%|███████   | 71/100 [05:51<02:49,  5.86s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:55<02:32,  5.43s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:59<02:12,  4.91s/it]Running generate_until requests:  74%|███████▍  | 74/100 [06:04<02:07,  4.91s/it]Running generate_until requests:  75%|███████▌  | 75/100 [06:07<01:47,  4.30s/it]Running generate_until requests:  76%|███████▌  | 76/100 [06:13<01:54,  4.78s/it]Running generate_until requests:  77%|███████▋  | 77/100 [06:17<01:44,  4.54s/it]Running generate_until requests:  78%|███████▊  | 78/100 [06:23<01:50,  5.02s/it]Running generate_until requests:  79%|███████▉  | 79/100 [06:28<01:47,  5.12s/it]Running generate_until requests:  80%|████████  | 80/100 [06:33<01:41,  5.06s/it]Running generate_until requests:  81%|████████  | 81/100 [06:37<01:28,  4.66s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:40<01:17,  4.32s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:48<01:27,  5.14s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:50<01:09,  4.34s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:58<01:20,  5.36s/it]Running generate_until requests:  86%|████████▌ | 86/100 [07:01<01:06,  4.73s/it]Running generate_until requests:  87%|████████▋ | 87/100 [07:06<01:04,  4.95s/it]Running generate_until requests:  88%|████████▊ | 88/100 [07:13<01:03,  5.31s/it]Running generate_until requests:  89%|████████▉ | 89/100 [07:18<00:58,  5.35s/it]Running generate_until requests:  90%|█████████ | 90/100 [07:21<00:45,  4.56s/it]Running generate_until requests:  91%|█████████ | 91/100 [07:26<00:42,  4.68s/it]Running generate_until requests:  92%|█████████▏| 92/100 [07:29<00:34,  4.32s/it]Running generate_until requests:  93%|█████████▎| 93/100 [07:33<00:28,  4.02s/it]Running generate_until requests:  94%|█████████▍| 94/100 [07:40<00:29,  4.93s/it]Running generate_until requests:  95%|█████████▌| 95/100 [07:46<00:27,  5.44s/it]Running generate_until requests:  96%|█████████▌| 96/100 [07:50<00:19,  4.99s/it]Running generate_until requests:  97%|█████████▋| 97/100 [07:55<00:15,  5.07s/it]Running generate_until requests:  98%|█████████▊| 98/100 [07:59<00:09,  4.66s/it]Running generate_until requests:  99%|█████████▉| 99/100 [08:02<00:04,  4.28s/it]Running generate_until requests: 100%|██████████| 100/100 [08:06<00:00,  4.19s/it]Running generate_until requests: 100%|██████████| 100/100 [08:06<00:00,  4.87s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:01:21:54,290 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:01:21:54,315 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:01:22:37,017 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:01:22:52,112 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:01:22:52,113 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:01:22:52,123 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:01:22:52,123 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:01:22:52,124 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:01:22:52,425 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:01:22:52,621 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:01:22:52,998 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.08s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.16it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]
2024-12-27:01:23:01,211 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:01:23:01,213 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 33%|███▎      | 33/100 [00:00<00:00, 329.22it/s] 68%|██████▊   | 68/100 [00:00<00:00, 338.49it/s]100%|██████████| 100/100 [00:00<00:00, 337.20it/s]
2024-12-27:01:23:01,515 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:04<07:40,  4.65s/it]Running generate_until requests:   2%|▏         | 2/100 [00:09<08:11,  5.02s/it]Running generate_until requests:   3%|▎         | 3/100 [00:17<10:14,  6.34s/it]Running generate_until requests:   4%|▍         | 4/100 [00:22<08:46,  5.49s/it]Running generate_until requests:   5%|▌         | 5/100 [00:26<08:17,  5.24s/it]Running generate_until requests:   6%|▌         | 6/100 [00:30<07:37,  4.87s/it]Running generate_until requests:   7%|▋         | 7/100 [00:36<07:47,  5.02s/it]Running generate_until requests:   8%|▊         | 8/100 [00:43<08:54,  5.81s/it]Running generate_until requests:   9%|▉         | 9/100 [00:47<07:51,  5.18s/it]Running generate_until requests:  10%|█         | 10/100 [00:50<06:49,  4.55s/it]Running generate_until requests:  11%|█         | 11/100 [00:55<07:00,  4.72s/it]Running generate_until requests:  12%|█▏        | 12/100 [00:59<06:14,  4.26s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:05<07:06,  4.90s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:09<06:46,  4.73s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:17<08:09,  5.76s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:24<08:36,  6.15s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:27<07:02,  5.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:31<06:36,  4.84s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:37<06:40,  4.94s/it]Running generate_until requests:  20%|██        | 20/100 [01:45<07:56,  5.96s/it]Running generate_until requests:  21%|██        | 21/100 [01:51<07:58,  6.06s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:56<07:33,  5.81s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:01<06:59,  5.45s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:09<07:49,  6.18s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:14<07:24,  5.93s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:17<06:10,  5.01s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:21<05:43,  4.71s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:27<06:03,  5.05s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:34<06:39,  5.63s/it]Running generate_until requests:  30%|███       | 30/100 [02:38<06:09,  5.28s/it]Running generate_until requests:  31%|███       | 31/100 [02:42<05:30,  4.78s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:50<06:35,  5.82s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:52<05:16,  4.72s/it]Running generate_until requests:  34%|███▍      | 34/100 [02:59<05:41,  5.17s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:04<05:31,  5.10s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:06<04:31,  4.24s/it]Running generate_until requests:  37%|███▋      | 37/100 [03:09<03:57,  3.78s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:16<05:03,  4.89s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:20<04:32,  4.47s/it]Running generate_until requests:  40%|████      | 40/100 [03:22<03:52,  3.87s/it]Running generate_until requests:  41%|████      | 41/100 [03:25<03:33,  3.63s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:29<03:42,  3.84s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:33<03:40,  3.87s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:35<03:08,  3.36s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:42<03:51,  4.21s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:46<03:49,  4.25s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:50<03:42,  4.20s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:53<03:15,  3.76s/it]Running generate_until requests:  49%|████▉     | 49/100 [04:01<04:19,  5.08s/it]Running generate_until requests:  50%|█████     | 50/100 [04:08<04:37,  5.55s/it]Running generate_until requests:  51%|█████     | 51/100 [04:11<03:55,  4.80s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:19<04:36,  5.76s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:27<05:04,  6.48s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:30<04:11,  5.48s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:36<04:07,  5.50s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:38<03:26,  4.68s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:43<03:15,  4.54s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:48<03:21,  4.79s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:52<03:08,  4.59s/it]Running generate_until requests:  60%|██████    | 60/100 [04:57<03:03,  4.59s/it]Running generate_until requests:  61%|██████    | 61/100 [05:01<02:51,  4.41s/it]Running generate_until requests:  62%|██████▏   | 62/100 [05:04<02:36,  4.13s/it]Running generate_until requests:  63%|██████▎   | 63/100 [05:08<02:26,  3.95s/it]Running generate_until requests:  64%|██████▍   | 64/100 [05:13<02:40,  4.47s/it]Running generate_until requests:  65%|██████▌   | 65/100 [05:17<02:28,  4.24s/it]Running generate_until requests:  66%|██████▌   | 66/100 [05:22<02:35,  4.57s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:24<02:06,  3.82s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:30<02:20,  4.38s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:34<02:14,  4.34s/it]Running generate_until requests:  70%|███████   | 70/100 [05:40<02:25,  4.85s/it]Running generate_until requests:  71%|███████   | 71/100 [05:48<02:48,  5.81s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:53<02:30,  5.39s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:56<02:11,  4.87s/it]Running generate_until requests:  74%|███████▍  | 74/100 [06:01<02:06,  4.88s/it]Running generate_until requests:  75%|███████▌  | 75/100 [06:04<01:46,  4.27s/it]Running generate_until requests:  76%|███████▌  | 76/100 [06:10<01:53,  4.74s/it]Running generate_until requests:  77%|███████▋  | 77/100 [06:14<01:43,  4.51s/it]Running generate_until requests:  78%|███████▊  | 78/100 [06:20<01:49,  4.98s/it]Running generate_until requests:  79%|███████▉  | 79/100 [06:25<01:46,  5.08s/it]Running generate_until requests:  80%|████████  | 80/100 [06:30<01:40,  5.02s/it]Running generate_until requests:  81%|████████  | 81/100 [06:34<01:27,  4.63s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:37<01:17,  4.28s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:45<01:26,  5.10s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:47<01:08,  4.31s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:55<01:19,  5.32s/it]Running generate_until requests:  86%|████████▌ | 86/100 [06:58<01:05,  4.70s/it]Running generate_until requests:  87%|████████▋ | 87/100 [07:03<01:03,  4.91s/it]Running generate_until requests:  88%|████████▊ | 88/100 [07:09<01:03,  5.27s/it]Running generate_until requests:  89%|████████▉ | 89/100 [07:15<00:58,  5.31s/it]Running generate_until requests:  90%|█████████ | 90/100 [07:18<00:45,  4.53s/it]Running generate_until requests:  91%|█████████ | 91/100 [07:22<00:41,  4.65s/it]Running generate_until requests:  92%|█████████▏| 92/100 [07:26<00:34,  4.29s/it]Running generate_until requests:  93%|█████████▎| 93/100 [07:29<00:27,  3.99s/it]Running generate_until requests:  94%|█████████▍| 94/100 [07:36<00:29,  4.89s/it]Running generate_until requests:  95%|█████████▌| 95/100 [07:43<00:27,  5.40s/it]Running generate_until requests:  96%|█████████▌| 96/100 [07:47<00:19,  4.95s/it]Running generate_until requests:  97%|█████████▋| 97/100 [07:52<00:15,  5.03s/it]Running generate_until requests:  98%|█████████▊| 98/100 [07:56<00:09,  4.62s/it]Running generate_until requests:  99%|█████████▉| 99/100 [07:59<00:04,  4.25s/it]Running generate_until requests: 100%|██████████| 100/100 [08:03<00:00,  4.16s/it]Running generate_until requests: 100%|██████████| 100/100 [08:03<00:00,  4.83s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:01:31:10,306 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:01:31:10,312 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:01:31:52,709 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:01:32:07,502 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:01:32:07,504 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:01:32:07,514 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:01:32:07,515 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:01:32:07,515 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:01:32:07,766 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:01:32:07,944 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:01:32:08,686 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.37s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.25s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.04s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.13it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s]
2024-12-27:01:32:17,566 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:01:32:17,569 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 343.45it/s] 70%|███████   | 70/100 [00:00<00:00, 342.14it/s]100%|██████████| 100/100 [00:00<00:00, 343.81it/s]
2024-12-27:01:32:17,864 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:04<07:37,  4.62s/it]Running generate_until requests:   2%|▏         | 2/100 [00:09<08:10,  5.00s/it]Running generate_until requests:   3%|▎         | 3/100 [00:17<10:13,  6.33s/it]Running generate_until requests:   4%|▍         | 4/100 [00:21<08:46,  5.48s/it]Running generate_until requests:   5%|▌         | 5/100 [00:26<08:17,  5.24s/it]Running generate_until requests:   6%|▌         | 6/100 [00:30<07:37,  4.87s/it]Running generate_until requests:   7%|▋         | 7/100 [00:36<07:47,  5.02s/it]Running generate_until requests:   8%|▊         | 8/100 [00:43<08:55,  5.82s/it]Running generate_until requests:   9%|▉         | 9/100 [00:47<07:51,  5.19s/it]Running generate_until requests:  10%|█         | 10/100 [00:50<06:49,  4.55s/it]Running generate_until requests:  11%|█         | 11/100 [00:55<07:00,  4.72s/it]Running generate_until requests:  12%|█▏        | 12/100 [00:59<06:15,  4.26s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:05<07:06,  4.91s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:09<06:46,  4.73s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:17<08:09,  5.76s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:24<08:37,  6.16s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:27<07:02,  5.10s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:31<06:36,  4.84s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:37<06:40,  4.94s/it]Running generate_until requests:  20%|██        | 20/100 [01:45<07:56,  5.96s/it]Running generate_until requests:  21%|██        | 21/100 [01:51<07:58,  6.06s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:56<07:33,  5.81s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:01<06:59,  5.45s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:09<07:49,  6.18s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:14<07:24,  5.93s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:17<06:10,  5.01s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:21<05:43,  4.71s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:27<06:03,  5.06s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:34<06:39,  5.63s/it]Running generate_until requests:  30%|███       | 30/100 [02:38<06:09,  5.28s/it]Running generate_until requests:  31%|███       | 31/100 [02:42<05:30,  4.79s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:50<06:36,  5.83s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:52<05:16,  4.73s/it]Running generate_until requests:  34%|███▍      | 34/100 [02:59<05:41,  5.17s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:04<05:31,  5.10s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:06<04:31,  4.25s/it]Running generate_until requests:  37%|███▋      | 37/100 [03:09<03:58,  3.78s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:16<05:03,  4.90s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:20<04:33,  4.48s/it]Running generate_until requests:  40%|████      | 40/100 [03:22<03:52,  3.87s/it]Running generate_until requests:  41%|████      | 41/100 [03:25<03:34,  3.63s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:29<03:42,  3.84s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:33<03:40,  3.88s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:36<03:08,  3.36s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:42<03:51,  4.21s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:46<03:49,  4.25s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:50<03:42,  4.20s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:53<03:15,  3.76s/it]Running generate_until requests:  49%|████▉     | 49/100 [04:01<04:19,  5.08s/it]Running generate_until requests:  50%|█████     | 50/100 [04:08<04:37,  5.55s/it]Running generate_until requests:  51%|█████     | 51/100 [04:11<03:55,  4.80s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:19<04:36,  5.76s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:27<05:04,  6.48s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:30<04:12,  5.48s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:36<04:07,  5.51s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:38<03:26,  4.68s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:43<03:15,  4.54s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:48<03:21,  4.79s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:52<03:08,  4.59s/it]Running generate_until requests:  60%|██████    | 60/100 [04:57<03:03,  4.59s/it]Running generate_until requests:  61%|██████    | 61/100 [05:01<02:51,  4.41s/it]Running generate_until requests:  62%|██████▏   | 62/100 [05:04<02:36,  4.13s/it]Running generate_until requests:  63%|██████▎   | 63/100 [05:08<02:26,  3.95s/it]Running generate_until requests:  64%|██████▍   | 64/100 [05:13<02:40,  4.47s/it]Running generate_until requests:  65%|██████▌   | 65/100 [05:17<02:28,  4.24s/it]Running generate_until requests:  66%|██████▌   | 66/100 [05:22<02:35,  4.57s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:24<02:06,  3.82s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:30<02:20,  4.38s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:34<02:14,  4.34s/it]Running generate_until requests:  70%|███████   | 70/100 [05:40<02:25,  4.85s/it]Running generate_until requests:  71%|███████   | 71/100 [05:49<02:48,  5.82s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:53<02:30,  5.39s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:57<02:11,  4.87s/it]Running generate_until requests:  74%|███████▍  | 74/100 [06:01<02:06,  4.88s/it]Running generate_until requests:  75%|███████▌  | 75/100 [06:04<01:46,  4.27s/it]Running generate_until requests:  76%|███████▌  | 76/100 [06:10<01:53,  4.74s/it]Running generate_until requests:  77%|███████▋  | 77/100 [06:14<01:43,  4.51s/it]Running generate_until requests:  78%|███████▊  | 78/100 [06:20<01:49,  4.99s/it]Running generate_until requests:  79%|███████▉  | 79/100 [06:26<01:46,  5.08s/it]Running generate_until requests:  80%|████████  | 80/100 [06:30<01:40,  5.02s/it]Running generate_until requests:  81%|████████  | 81/100 [06:34<01:27,  4.63s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:38<01:17,  4.29s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:45<01:26,  5.11s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:47<01:08,  4.31s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:55<01:19,  5.32s/it]Running generate_until requests:  86%|████████▌ | 86/100 [06:58<01:05,  4.70s/it]Running generate_until requests:  87%|████████▋ | 87/100 [07:03<01:03,  4.92s/it]Running generate_until requests:  88%|████████▊ | 88/100 [07:10<01:03,  5.27s/it]Running generate_until requests:  89%|████████▉ | 89/100 [07:15<00:58,  5.31s/it]Running generate_until requests:  90%|█████████ | 90/100 [07:18<00:45,  4.53s/it]Running generate_until requests:  91%|█████████ | 91/100 [07:23<00:41,  4.65s/it]Running generate_until requests:  92%|█████████▏| 92/100 [07:26<00:34,  4.29s/it]Running generate_until requests:  93%|█████████▎| 93/100 [07:29<00:27,  3.99s/it]Running generate_until requests:  94%|█████████▍| 94/100 [07:36<00:29,  4.89s/it]Running generate_until requests:  95%|█████████▌| 95/100 [07:43<00:27,  5.40s/it]Running generate_until requests:  96%|█████████▌| 96/100 [07:47<00:19,  4.96s/it]Running generate_until requests:  97%|█████████▋| 97/100 [07:52<00:15,  5.03s/it]Running generate_until requests:  98%|█████████▊| 98/100 [07:56<00:09,  4.62s/it]Running generate_until requests:  99%|█████████▉| 99/100 [07:59<00:04,  4.25s/it]Running generate_until requests: 100%|██████████| 100/100 [08:03<00:00,  4.16s/it]Running generate_until requests: 100%|██████████| 100/100 [08:03<00:00,  4.84s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:01:40:27,100 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:01:40:27,106 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:01:41:10,002 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:01:41:24,799 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:01:41:24,801 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:01:41:24,813 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:01:41:24,813 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:01:41:24,814 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:01:41:25,068 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:01:41:25,276 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:01:41:25,655 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.07s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.15it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s]
2024-12-27:01:41:34,280 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:01:41:34,284 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 346.11it/s] 70%|███████   | 70/100 [00:00<00:00, 344.28it/s]100%|██████████| 100/100 [00:00<00:00, 346.05it/s]
2024-12-27:01:41:34,578 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:04<07:44,  4.69s/it]Running generate_until requests:   2%|▏         | 2/100 [00:09<08:15,  5.05s/it]Running generate_until requests:   3%|▎         | 3/100 [00:17<10:18,  6.38s/it]Running generate_until requests:   4%|▍         | 4/100 [00:22<08:50,  5.52s/it]Running generate_until requests:   5%|▌         | 5/100 [00:27<08:22,  5.29s/it]Running generate_until requests:   6%|▌         | 6/100 [00:31<07:41,  4.91s/it]Running generate_until requests:   7%|▋         | 7/100 [00:36<07:50,  5.06s/it]Running generate_until requests:   8%|▊         | 8/100 [00:44<08:58,  5.86s/it]Running generate_until requests:   9%|▉         | 9/100 [00:47<07:55,  5.22s/it]Running generate_until requests:  10%|█         | 10/100 [00:51<06:52,  4.58s/it]Running generate_until requests:  11%|█         | 11/100 [00:56<07:03,  4.76s/it]Running generate_until requests:  12%|█▏        | 12/100 [00:59<06:17,  4.29s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:05<07:09,  4.94s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:10<06:49,  4.76s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:18<08:13,  5.80s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:25<08:40,  6.20s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:28<07:06,  5.13s/it]Running generate_until requests:  18%|█▊        | 18/100 [01:32<06:39,  4.87s/it]Running generate_until requests:  19%|█▉        | 19/100 [01:37<06:43,  4.98s/it]Running generate_until requests:  20%|██        | 20/100 [01:46<08:00,  6.00s/it]Running generate_until requests:  21%|██        | 21/100 [01:52<08:02,  6.10s/it]Running generate_until requests:  22%|██▏       | 22/100 [01:57<07:36,  5.86s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:02<07:02,  5.49s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:10<07:52,  6.22s/it]Running generate_until requests:  25%|██▌       | 25/100 [02:15<07:28,  5.98s/it]Running generate_until requests:  26%|██▌       | 26/100 [02:18<06:13,  5.05s/it]Running generate_until requests:  27%|██▋       | 27/100 [02:22<05:46,  4.74s/it]Running generate_until requests:  28%|██▊       | 28/100 [02:28<06:06,  5.09s/it]Running generate_until requests:  29%|██▉       | 29/100 [02:35<06:42,  5.67s/it]Running generate_until requests:  30%|███       | 30/100 [02:40<06:12,  5.32s/it]Running generate_until requests:  31%|███       | 31/100 [02:43<05:32,  4.82s/it]Running generate_until requests:  32%|███▏      | 32/100 [02:52<06:38,  5.86s/it]Running generate_until requests:  33%|███▎      | 33/100 [02:54<05:18,  4.76s/it]Running generate_until requests:  34%|███▍      | 34/100 [03:00<05:43,  5.21s/it]Running generate_until requests:  35%|███▌      | 35/100 [03:05<05:33,  5.14s/it]Running generate_until requests:  36%|███▌      | 36/100 [03:07<04:33,  4.27s/it]Running generate_until requests:  37%|███▋      | 37/100 [03:10<03:59,  3.80s/it]Running generate_until requests:  38%|███▊      | 38/100 [03:17<05:05,  4.93s/it]Running generate_until requests:  39%|███▉      | 39/100 [03:21<04:34,  4.51s/it]Running generate_until requests:  40%|████      | 40/100 [03:23<03:53,  3.90s/it]Running generate_until requests:  41%|████      | 41/100 [03:27<03:35,  3.65s/it]Running generate_until requests:  42%|████▏     | 42/100 [03:31<03:44,  3.87s/it]Running generate_until requests:  43%|████▎     | 43/100 [03:35<03:42,  3.90s/it]Running generate_until requests:  44%|████▍     | 44/100 [03:37<03:09,  3.38s/it]Running generate_until requests:  45%|████▌     | 45/100 [03:43<03:53,  4.24s/it]Running generate_until requests:  46%|████▌     | 46/100 [03:48<03:50,  4.28s/it]Running generate_until requests:  47%|████▋     | 47/100 [03:52<03:44,  4.23s/it]Running generate_until requests:  48%|████▊     | 48/100 [03:55<03:16,  3.78s/it]Running generate_until requests:  49%|████▉     | 49/100 [04:03<04:21,  5.12s/it]Running generate_until requests:  50%|█████     | 50/100 [04:09<04:39,  5.59s/it]Running generate_until requests:  51%|█████     | 51/100 [04:13<03:56,  4.83s/it]Running generate_until requests:  52%|█████▏    | 52/100 [04:21<04:38,  5.80s/it]Running generate_until requests:  53%|█████▎    | 53/100 [04:29<05:06,  6.53s/it]Running generate_until requests:  54%|█████▍    | 54/100 [04:32<04:13,  5.52s/it]Running generate_until requests:  55%|█████▌    | 55/100 [04:38<04:09,  5.54s/it]Running generate_until requests:  56%|█████▌    | 56/100 [04:40<03:27,  4.72s/it]Running generate_until requests:  57%|█████▋    | 57/100 [04:45<03:16,  4.58s/it]Running generate_until requests:  58%|█████▊    | 58/100 [04:50<03:22,  4.83s/it]Running generate_until requests:  59%|█████▉    | 59/100 [04:54<03:09,  4.62s/it]Running generate_until requests:  60%|██████    | 60/100 [04:59<03:04,  4.62s/it]Running generate_until requests:  61%|██████    | 61/100 [05:03<02:53,  4.44s/it]Running generate_until requests:  62%|██████▏   | 62/100 [05:06<02:38,  4.16s/it]Running generate_until requests:  63%|██████▎   | 63/100 [05:10<02:27,  3.98s/it]Running generate_until requests:  64%|██████▍   | 64/100 [05:16<02:42,  4.50s/it]Running generate_until requests:  65%|██████▌   | 65/100 [05:19<02:29,  4.28s/it]Running generate_until requests:  66%|██████▌   | 66/100 [05:25<02:36,  4.60s/it]Running generate_until requests:  67%|██████▋   | 67/100 [05:27<02:07,  3.85s/it]Running generate_until requests:  68%|██████▊   | 68/100 [05:33<02:21,  4.42s/it]Running generate_until requests:  69%|██████▉   | 69/100 [05:37<02:15,  4.37s/it]Running generate_until requests:  70%|███████   | 70/100 [05:43<02:26,  4.88s/it]Running generate_until requests:  71%|███████   | 71/100 [05:51<02:49,  5.86s/it]Running generate_until requests:  72%|███████▏  | 72/100 [05:55<02:32,  5.43s/it]Running generate_until requests:  73%|███████▎  | 73/100 [05:59<02:12,  4.91s/it]Running generate_until requests:  74%|███████▍  | 74/100 [06:04<02:07,  4.92s/it]Running generate_until requests:  75%|███████▌  | 75/100 [06:07<01:47,  4.30s/it]Running generate_until requests:  76%|███████▌  | 76/100 [06:13<01:54,  4.78s/it]Running generate_until requests:  77%|███████▋  | 77/100 [06:17<01:44,  4.54s/it]Running generate_until requests:  78%|███████▊  | 78/100 [06:23<01:50,  5.02s/it]Running generate_until requests:  79%|███████▉  | 79/100 [06:28<01:47,  5.12s/it]Running generate_until requests:  80%|████████  | 80/100 [06:33<01:41,  5.06s/it]Running generate_until requests:  81%|████████  | 81/100 [06:37<01:28,  4.66s/it]Running generate_until requests:  82%|████████▏ | 82/100 [06:40<01:17,  4.32s/it]Running generate_until requests:  83%|████████▎ | 83/100 [06:48<01:27,  5.14s/it]Running generate_until requests:  84%|████████▍ | 84/100 [06:50<01:09,  4.34s/it]Running generate_until requests:  85%|████████▌ | 85/100 [06:58<01:20,  5.36s/it]Running generate_until requests:  86%|████████▌ | 86/100 [07:01<01:06,  4.73s/it]Running generate_until requests:  87%|████████▋ | 87/100 [07:07<01:04,  4.95s/it]Running generate_until requests:  88%|████████▊ | 88/100 [07:13<01:03,  5.31s/it]Running generate_until requests:  89%|████████▉ | 89/100 [07:18<00:58,  5.35s/it]Running generate_until requests:  90%|█████████ | 90/100 [07:21<00:45,  4.56s/it]Running generate_until requests:  91%|█████████ | 91/100 [07:26<00:42,  4.68s/it]Running generate_until requests:  92%|█████████▏| 92/100 [07:29<00:34,  4.32s/it]Running generate_until requests:  93%|█████████▎| 93/100 [07:33<00:28,  4.02s/it]Running generate_until requests:  94%|█████████▍| 94/100 [07:40<00:29,  4.93s/it]Running generate_until requests:  95%|█████████▌| 95/100 [07:46<00:27,  5.44s/it]Running generate_until requests:  96%|█████████▌| 96/100 [07:50<00:19,  4.99s/it]Running generate_until requests:  97%|█████████▋| 97/100 [07:55<00:15,  5.07s/it]Running generate_until requests:  98%|█████████▊| 98/100 [07:59<00:09,  4.66s/it]Running generate_until requests:  99%|█████████▉| 99/100 [08:03<00:04,  4.28s/it]Running generate_until requests: 100%|██████████| 100/100 [08:07<00:00,  4.19s/it]Running generate_until requests: 100%|██████████| 100/100 [08:07<00:00,  4.87s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:01:49:47,270 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:01:49:47,292 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:01:51:40,286 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:01:51:55,273 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:01:51:55,274 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:01:51:55,284 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:01:51:55,284 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:01:51:55,284 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:01:51:55,531 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:01:51:55,732 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:01:51:56,113 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.05s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.16it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s]
2024-12-27:01:52:04,558 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:01:52:04,562 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.60it/s] 70%|███████   | 70/100 [00:00<00:00, 347.81it/s]100%|██████████| 100/100 [00:00<00:00, 349.50it/s]
2024-12-27:01:52:04,853 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:06<10:29,  6.36s/it]Running generate_until requests:   2%|▏         | 2/100 [00:13<10:50,  6.64s/it]Running generate_until requests:   3%|▎         | 3/100 [00:24<14:17,  8.85s/it]Running generate_until requests:   4%|▍         | 4/100 [00:31<12:52,  8.05s/it]Running generate_until requests:   5%|▌         | 5/100 [00:38<12:14,  7.73s/it]Running generate_until requests:   6%|▌         | 6/100 [00:44<10:58,  7.01s/it]Running generate_until requests:   7%|▋         | 7/100 [00:51<11:08,  7.19s/it]Running generate_until requests:   8%|▊         | 8/100 [00:59<11:23,  7.43s/it]Running generate_until requests:   9%|▉         | 9/100 [01:05<10:35,  6.99s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<09:17,  6.19s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:31,  6.42s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:20<08:10,  5.58s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:28<09:09,  6.32s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:33<08:11,  5.72s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:44<10:32,  7.44s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:53<10:54,  7.79s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:56<08:58,  6.49s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:02<08:34,  6.27s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:11<09:33,  7.08s/it]Running generate_until requests:  20%|██        | 20/100 [02:22<11:06,  8.33s/it]Running generate_until requests:  21%|██        | 21/100 [02:30<10:53,  8.28s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:37<10:17,  7.92s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:44<09:31,  7.42s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:54<10:41,  8.45s/it]Running generate_until requests:  25%|██▌       | 25/100 [03:02<10:06,  8.08s/it]Running generate_until requests:  26%|██▌       | 26/100 [03:06<08:25,  6.83s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:11<07:48,  6.42s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:19<08:13,  6.86s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:29<09:16,  7.83s/it]Running generate_until requests:  30%|███       | 30/100 [03:34<08:13,  7.05s/it]Running generate_until requests:  31%|███       | 31/100 [03:39<07:23,  6.42s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:50<08:50,  7.80s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:54<07:15,  6.50s/it]Running generate_until requests:  34%|███▍      | 34/100 [04:02<07:39,  6.97s/it]Running generate_until requests:  35%|███▌      | 35/100 [04:08<07:24,  6.84s/it]Running generate_until requests:  36%|███▌      | 36/100 [04:12<06:10,  5.79s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:15<05:24,  5.16s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:25<06:42,  6.49s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:30<06:11,  6.08s/it]Running generate_until requests:  40%|████      | 40/100 [04:33<05:13,  5.22s/it]Running generate_until requests:  41%|████      | 41/100 [04:37<04:40,  4.76s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:43<05:06,  5.29s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:49<05:03,  5.33s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:52<04:27,  4.78s/it]Running generate_until requests:  45%|████▌     | 45/100 [05:00<05:15,  5.73s/it]Running generate_until requests:  46%|████▌     | 46/100 [05:05<04:57,  5.52s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:11<04:51,  5.50s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:15<04:18,  4.96s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:23<05:03,  5.95s/it]Running generate_until requests:  50%|█████     | 50/100 [05:29<04:58,  5.98s/it]Running generate_until requests:  51%|█████     | 51/100 [05:33<04:25,  5.42s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:44<05:36,  7.02s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:54<06:22,  8.13s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:59<05:21,  6.98s/it]Running generate_until requests:  55%|█████▌    | 55/100 [06:05<05:00,  6.68s/it]Running generate_until requests:  56%|█████▌    | 56/100 [06:08<04:14,  5.79s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:14<04:05,  5.71s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:21<04:16,  6.12s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:26<04:01,  5.89s/it]Running generate_until requests:  60%|██████    | 60/100 [06:32<03:56,  5.92s/it]Running generate_until requests:  61%|██████    | 61/100 [06:38<03:43,  5.72s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:42<03:25,  5.40s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:47<03:12,  5.19s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:52<03:09,  5.26s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:57<03:00,  5.17s/it]Running generate_until requests:  66%|██████▌   | 66/100 [07:04<03:13,  5.68s/it]Running generate_until requests:  67%|██████▋   | 67/100 [07:07<02:39,  4.84s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:14<02:55,  5.48s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:18<02:38,  5.12s/it]Running generate_until requests:  70%|███████   | 70/100 [07:26<02:58,  5.94s/it]Running generate_until requests:  71%|███████   | 71/100 [07:34<03:09,  6.54s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:40<02:59,  6.43s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:45<02:42,  6.01s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:50<02:29,  5.73s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:55<02:12,  5.28s/it]Running generate_until requests:  76%|███████▌  | 76/100 [08:03<02:25,  6.06s/it]Running generate_until requests:  77%|███████▋  | 77/100 [08:08<02:12,  5.74s/it]Running generate_until requests:  78%|███████▊  | 78/100 [08:15<02:17,  6.26s/it]Running generate_until requests:  79%|███████▉  | 79/100 [08:22<02:17,  6.53s/it]Running generate_until requests:  80%|████████  | 80/100 [08:29<02:09,  6.50s/it]Running generate_until requests:  81%|████████  | 81/100 [08:33<01:50,  5.82s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:40<01:49,  6.11s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:46<01:47,  6.34s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:51<01:32,  5.78s/it]Running generate_until requests:  85%|████████▌ | 85/100 [09:01<01:45,  7.02s/it]Running generate_until requests:  86%|████████▌ | 86/100 [09:05<01:26,  6.20s/it]Running generate_until requests:  87%|████████▋ | 87/100 [09:11<01:17,  5.97s/it]Running generate_until requests:  88%|████████▊ | 88/100 [09:18<01:18,  6.53s/it]Running generate_until requests:  89%|████████▉ | 89/100 [09:26<01:13,  6.70s/it]Running generate_until requests:  90%|█████████ | 90/100 [09:29<00:57,  5.70s/it]Running generate_until requests:  91%|█████████ | 91/100 [09:33<00:48,  5.37s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:39<00:42,  5.34s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:43<00:35,  5.01s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:52<00:37,  6.28s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:57<00:28,  5.68s/it]Running generate_until requests:  96%|█████████▌| 96/100 [10:01<00:21,  5.45s/it]Running generate_until requests:  97%|█████████▋| 97/100 [10:08<00:17,  5.80s/it]Running generate_until requests:  98%|█████████▊| 98/100 [10:13<00:10,  5.47s/it]Running generate_until requests:  99%|█████████▉| 99/100 [10:17<00:05,  5.12s/it]Running generate_until requests: 100%|██████████| 100/100 [10:21<00:00,  4.91s/it]Running generate_until requests: 100%|██████████| 100/100 [10:21<00:00,  6.22s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:02:02:32,684 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:02:02:32,760 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:02:03:16,066 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:02:03:31,224 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:02:03:31,226 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:02:03:31,237 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:02:03:31,238 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:02:03:31,238 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:02:03:31,508 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:02:03:31,702 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:02:03:32,106 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.32s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.12s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
2024-12-27:02:03:41,394 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:02:03:41,397 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 340.73it/s] 70%|███████   | 70/100 [00:00<00:00, 344.07it/s]100%|██████████| 100/100 [00:00<00:00, 344.72it/s]
2024-12-27:02:03:41,692 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:06<10:37,  6.44s/it]Running generate_until requests:   2%|▏         | 2/100 [00:13<10:56,  6.70s/it]Running generate_until requests:   3%|▎         | 3/100 [00:24<14:22,  8.89s/it]Running generate_until requests:   4%|▍         | 4/100 [00:31<12:57,  8.10s/it]Running generate_until requests:   5%|▌         | 5/100 [00:38<12:19,  7.78s/it]Running generate_until requests:   6%|▌         | 6/100 [00:44<11:03,  7.06s/it]Running generate_until requests:   7%|▋         | 7/100 [00:52<11:13,  7.24s/it]Running generate_until requests:   8%|▊         | 8/100 [01:00<11:28,  7.49s/it]Running generate_until requests:   9%|▉         | 9/100 [01:06<10:40,  7.04s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<09:21,  6.24s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:36,  6.48s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:21<08:14,  5.62s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:29<09:14,  6.37s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:33<08:16,  5.77s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:45<10:37,  7.50s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:54<10:59,  7.85s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:57<09:02,  6.54s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:03<08:38,  6.32s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:12<09:38,  7.14s/it]Running generate_until requests:  20%|██        | 20/100 [02:23<11:12,  8.41s/it]Running generate_until requests:  21%|██        | 21/100 [02:31<10:59,  8.35s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:39<10:23,  7.99s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:45<09:36,  7.49s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:56<10:47,  8.52s/it]Running generate_until requests:  25%|██▌       | 25/100 [03:03<10:11,  8.15s/it]Running generate_until requests:  26%|██▌       | 26/100 [03:07<08:29,  6.89s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:13<07:52,  6.48s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:21<08:18,  6.92s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:31<09:21,  7.90s/it]Running generate_until requests:  30%|███       | 30/100 [03:36<08:18,  7.12s/it]Running generate_until requests:  31%|███       | 31/100 [03:41<07:27,  6.48s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:52<08:55,  7.87s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:56<07:19,  6.56s/it]Running generate_until requests:  34%|███▍      | 34/100 [04:04<07:44,  7.03s/it]Running generate_until requests:  35%|███▌      | 35/100 [04:10<07:28,  6.90s/it]Running generate_until requests:  36%|███▌      | 36/100 [04:14<06:13,  5.84s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:17<05:27,  5.20s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:27<06:46,  6.55s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:32<06:14,  6.14s/it]Running generate_until requests:  40%|████      | 40/100 [04:36<05:16,  5.27s/it]Running generate_until requests:  41%|████      | 41/100 [04:39<04:43,  4.80s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:46<05:09,  5.34s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:51<05:06,  5.37s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:55<04:30,  4.82s/it]Running generate_until requests:  45%|████▌     | 45/100 [05:03<05:18,  5.78s/it]Running generate_until requests:  46%|████▌     | 46/100 [05:08<05:00,  5.57s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:14<04:54,  5.55s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:17<04:20,  5.01s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:26<05:06,  6.01s/it]Running generate_until requests:  50%|█████     | 50/100 [05:32<05:01,  6.03s/it]Running generate_until requests:  51%|█████     | 51/100 [05:36<04:28,  5.47s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:47<05:40,  7.08s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:58<06:25,  8.21s/it]Running generate_until requests:  54%|█████▍    | 54/100 [06:02<05:24,  7.05s/it]Running generate_until requests:  55%|█████▌    | 55/100 [06:08<05:03,  6.74s/it]Running generate_until requests:  56%|█████▌    | 56/100 [06:12<04:17,  5.84s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:17<04:07,  5.76s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:24<04:19,  6.18s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:30<04:04,  5.96s/it]Running generate_until requests:  60%|██████    | 60/100 [06:36<03:59,  5.99s/it]Running generate_until requests:  61%|██████    | 61/100 [06:41<03:45,  5.79s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:46<03:27,  5.45s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:51<03:14,  5.24s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:56<03:11,  5.32s/it]Running generate_until requests:  65%|██████▌   | 65/100 [07:01<03:02,  5.22s/it]Running generate_until requests:  66%|██████▌   | 66/100 [07:08<03:15,  5.74s/it]Running generate_until requests:  67%|██████▋   | 67/100 [07:11<02:41,  4.88s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:18<02:57,  5.54s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:22<02:40,  5.17s/it]Running generate_until requests:  70%|███████   | 70/100 [07:30<02:59,  6.00s/it]Running generate_until requests:  71%|███████   | 71/100 [07:38<03:11,  6.60s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:44<03:01,  6.49s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:50<02:43,  6.07s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:55<02:30,  5.79s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:59<02:13,  5.33s/it]Running generate_until requests:  76%|███████▌  | 76/100 [08:07<02:26,  6.12s/it]Running generate_until requests:  77%|███████▋  | 77/100 [08:12<02:13,  5.80s/it]Running generate_until requests:  78%|███████▊  | 78/100 [08:20<02:18,  6.32s/it]Running generate_until requests:  79%|███████▉  | 79/100 [08:27<02:18,  6.60s/it]Running generate_until requests:  80%|████████  | 80/100 [08:33<02:11,  6.56s/it]Running generate_until requests:  81%|████████  | 81/100 [08:38<01:51,  5.88s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:44<01:51,  6.17s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:51<01:48,  6.41s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:56<01:33,  5.83s/it]Running generate_until requests:  85%|████████▌ | 85/100 [09:06<01:46,  7.09s/it]Running generate_until requests:  86%|████████▌ | 86/100 [09:10<01:27,  6.26s/it]Running generate_until requests:  87%|████████▋ | 87/100 [09:16<01:18,  6.04s/it]Running generate_until requests:  88%|████████▊ | 88/100 [09:24<01:19,  6.60s/it]Running generate_until requests:  89%|████████▉ | 89/100 [09:31<01:14,  6.77s/it]Running generate_until requests:  90%|█████████ | 90/100 [09:34<00:57,  5.76s/it]Running generate_until requests:  91%|█████████ | 91/100 [09:39<00:48,  5.42s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:44<00:43,  5.40s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:48<00:35,  5.06s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:58<00:38,  6.34s/it]Running generate_until requests:  95%|█████████▌| 95/100 [10:02<00:28,  5.73s/it]Running generate_until requests:  96%|█████████▌| 96/100 [10:07<00:22,  5.51s/it]Running generate_until requests:  97%|█████████▋| 97/100 [10:14<00:17,  5.85s/it]Running generate_until requests:  98%|█████████▊| 98/100 [10:18<00:11,  5.52s/it]Running generate_until requests:  99%|█████████▉| 99/100 [10:23<00:05,  5.17s/it]Running generate_until requests: 100%|██████████| 100/100 [10:27<00:00,  4.96s/it]Running generate_until requests: 100%|██████████| 100/100 [10:27<00:00,  6.28s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:02:14:15,082 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:02:14:15,090 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:02:14:58,013 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:02:15:12,709 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:02:15:12,711 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:02:15:12,722 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:02:15:12,723 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:02:15:12,723 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:02:15:12,976 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:02:15:13,172 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:02:15:13,545 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.05s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.18it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.28it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]
2024-12-27:02:15:21,968 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:02:15:21,970 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 349.20it/s] 70%|███████   | 70/100 [00:00<00:00, 340.69it/s]100%|██████████| 100/100 [00:00<00:00, 343.89it/s]
2024-12-27:02:15:22,266 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:06<10:30,  6.36s/it]Running generate_until requests:   2%|▏         | 2/100 [00:13<10:50,  6.64s/it]Running generate_until requests:   3%|▎         | 3/100 [00:24<14:18,  8.85s/it]Running generate_until requests:   4%|▍         | 4/100 [00:31<12:53,  8.05s/it]Running generate_until requests:   5%|▌         | 5/100 [00:38<12:15,  7.74s/it]Running generate_until requests:   6%|▌         | 6/100 [00:44<10:59,  7.01s/it]Running generate_until requests:   7%|▋         | 7/100 [00:51<11:09,  7.20s/it]Running generate_until requests:   8%|▊         | 8/100 [00:59<11:24,  7.44s/it]Running generate_until requests:   9%|▉         | 9/100 [01:05<10:36,  6.99s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<09:17,  6.20s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:32,  6.43s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:20<08:11,  5.58s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:28<09:10,  6.33s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:33<08:12,  5.72s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:44<10:32,  7.45s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:53<10:54,  7.79s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:56<08:58,  6.49s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:02<08:34,  6.27s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:11<09:33,  7.09s/it]Running generate_until requests:  20%|██        | 20/100 [02:22<11:06,  8.34s/it]Running generate_until requests:  21%|██        | 21/100 [02:30<10:54,  8.28s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:37<10:18,  7.93s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:44<09:31,  7.42s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:55<10:42,  8.45s/it]Running generate_until requests:  25%|██▌       | 25/100 [03:02<10:06,  8.09s/it]Running generate_until requests:  26%|██▌       | 26/100 [03:06<08:25,  6.83s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:11<07:48,  6.42s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:19<08:14,  6.86s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:29<09:16,  7.84s/it]Running generate_until requests:  30%|███       | 30/100 [03:34<08:13,  7.06s/it]Running generate_until requests:  31%|███       | 31/100 [03:39<07:23,  6.43s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:50<08:50,  7.80s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:54<07:15,  6.50s/it]Running generate_until requests:  34%|███▍      | 34/100 [04:02<07:40,  6.97s/it]Running generate_until requests:  35%|███▌      | 35/100 [04:08<07:24,  6.84s/it]Running generate_until requests:  36%|███▌      | 36/100 [04:12<06:10,  5.79s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:15<05:25,  5.16s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:25<06:42,  6.50s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:30<06:11,  6.09s/it]Running generate_until requests:  40%|████      | 40/100 [04:33<05:13,  5.22s/it]Running generate_until requests:  41%|████      | 41/100 [04:37<04:40,  4.76s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:44<05:07,  5.30s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:49<05:03,  5.33s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:53<04:28,  4.79s/it]Running generate_until requests:  45%|████▌     | 45/100 [05:01<05:15,  5.74s/it]Running generate_until requests:  46%|████▌     | 46/100 [05:06<04:58,  5.52s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:11<04:52,  5.51s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:15<04:18,  4.97s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:23<05:04,  5.96s/it]Running generate_until requests:  50%|█████     | 50/100 [05:29<04:59,  5.99s/it]Running generate_until requests:  51%|█████     | 51/100 [05:33<04:26,  5.43s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:44<05:37,  7.02s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:55<06:22,  8.14s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:59<05:21,  6.99s/it]Running generate_until requests:  55%|█████▌    | 55/100 [06:05<05:00,  6.68s/it]Running generate_until requests:  56%|█████▌    | 56/100 [06:09<04:14,  5.79s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:14<04:05,  5.71s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:21<04:17,  6.12s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:27<04:01,  5.89s/it]Running generate_until requests:  60%|██████    | 60/100 [06:33<03:57,  5.93s/it]Running generate_until requests:  61%|██████    | 61/100 [06:38<03:43,  5.73s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:43<03:25,  5.40s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:47<03:12,  5.19s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:53<03:09,  5.27s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:58<03:00,  5.17s/it]Running generate_until requests:  66%|██████▌   | 66/100 [07:05<03:13,  5.68s/it]Running generate_until requests:  67%|██████▋   | 67/100 [07:07<02:39,  4.84s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:14<02:55,  5.48s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:19<02:38,  5.13s/it]Running generate_until requests:  70%|███████   | 70/100 [07:27<02:58,  5.94s/it]Running generate_until requests:  71%|███████   | 71/100 [07:34<03:09,  6.54s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:41<03:00,  6.43s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:46<02:42,  6.02s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:51<02:29,  5.74s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:55<02:12,  5.29s/it]Running generate_until requests:  76%|███████▌  | 76/100 [08:03<02:25,  6.07s/it]Running generate_until requests:  77%|███████▋  | 77/100 [08:08<02:12,  5.75s/it]Running generate_until requests:  78%|███████▊  | 78/100 [08:15<02:17,  6.26s/it]Running generate_until requests:  79%|███████▉  | 79/100 [08:23<02:17,  6.53s/it]Running generate_until requests:  80%|████████  | 80/100 [08:29<02:10,  6.50s/it]Running generate_until requests:  81%|████████  | 81/100 [08:33<01:50,  5.83s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:40<01:50,  6.11s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:47<01:47,  6.35s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:51<01:32,  5.78s/it]Running generate_until requests:  85%|████████▌ | 85/100 [09:01<01:45,  7.03s/it]Running generate_until requests:  86%|████████▌ | 86/100 [09:06<01:26,  6.21s/it]Running generate_until requests:  87%|████████▋ | 87/100 [09:11<01:17,  5.97s/it]Running generate_until requests:  88%|████████▊ | 88/100 [09:19<01:18,  6.53s/it]Running generate_until requests:  89%|████████▉ | 89/100 [09:26<01:13,  6.71s/it]Running generate_until requests:  90%|█████████ | 90/100 [09:29<00:57,  5.70s/it]Running generate_until requests:  91%|█████████ | 91/100 [09:34<00:48,  5.37s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:39<00:42,  5.35s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:43<00:35,  5.01s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:53<00:37,  6.28s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:57<00:28,  5.68s/it]Running generate_until requests:  96%|█████████▌| 96/100 [10:02<00:21,  5.46s/it]Running generate_until requests:  97%|█████████▋| 97/100 [10:08<00:17,  5.80s/it]Running generate_until requests:  98%|█████████▊| 98/100 [10:13<00:10,  5.47s/it]Running generate_until requests:  99%|█████████▉| 99/100 [10:18<00:05,  5.12s/it]Running generate_until requests: 100%|██████████| 100/100 [10:22<00:00,  4.92s/it]Running generate_until requests: 100%|██████████| 100/100 [10:22<00:00,  6.22s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:02:25:50,407 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:02:25:50,413 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:02:26:33,322 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:02:26:48,347 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:02:26:48,349 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:02:26:48,360 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:02:26:48,361 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:02:26:48,361 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:02:26:48,650 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:02:26:48,865 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:02:26:49,264 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.30s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.08s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.03s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.01s/it]
2024-12-27:02:26:58,517 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:02:26:58,521 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 347.17it/s] 70%|███████   | 70/100 [00:00<00:00, 348.55it/s]100%|██████████| 100/100 [00:00<00:00, 349.72it/s]
2024-12-27:02:26:58,812 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:06<10:37,  6.44s/it]Running generate_until requests:   2%|▏         | 2/100 [00:13<10:56,  6.70s/it]Running generate_until requests:   3%|▎         | 3/100 [00:24<14:25,  8.92s/it]Running generate_until requests:   4%|▍         | 4/100 [00:31<12:59,  8.11s/it]Running generate_until requests:   5%|▌         | 5/100 [00:38<12:20,  7.79s/it]Running generate_until requests:   6%|▌         | 6/100 [00:44<11:03,  7.06s/it]Running generate_until requests:   7%|▋         | 7/100 [00:52<11:13,  7.25s/it]Running generate_until requests:   8%|▊         | 8/100 [01:00<11:28,  7.49s/it]Running generate_until requests:   9%|▉         | 9/100 [01:06<10:40,  7.04s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<09:21,  6.24s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:36,  6.47s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:21<08:14,  5.62s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:29<09:14,  6.37s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:33<08:15,  5.76s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:45<10:37,  7.50s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:54<10:59,  7.85s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:57<09:02,  6.54s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:03<08:38,  6.32s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:12<09:38,  7.14s/it]Running generate_until requests:  20%|██        | 20/100 [02:23<11:12,  8.40s/it]Running generate_until requests:  21%|██        | 21/100 [02:32<10:59,  8.35s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:39<10:23,  7.99s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:45<09:36,  7.48s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:56<10:47,  8.52s/it]Running generate_until requests:  25%|██▌       | 25/100 [03:03<10:11,  8.15s/it]Running generate_until requests:  26%|██▌       | 26/100 [03:07<08:29,  6.89s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:13<07:52,  6.48s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:21<08:18,  6.92s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:31<09:21,  7.90s/it]Running generate_until requests:  30%|███       | 30/100 [03:36<08:17,  7.11s/it]Running generate_until requests:  31%|███       | 31/100 [03:41<07:27,  6.48s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:52<08:54,  7.86s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:56<07:19,  6.55s/it]Running generate_until requests:  34%|███▍      | 34/100 [04:04<07:43,  7.03s/it]Running generate_until requests:  35%|███▌      | 35/100 [04:10<07:28,  6.90s/it]Running generate_until requests:  36%|███▌      | 36/100 [04:14<06:13,  5.84s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:17<05:27,  5.20s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:27<06:45,  6.55s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:32<06:14,  6.14s/it]Running generate_until requests:  40%|████      | 40/100 [04:36<05:15,  5.26s/it]Running generate_until requests:  41%|████      | 41/100 [04:39<04:43,  4.80s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:46<05:09,  5.34s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:51<05:06,  5.37s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:55<04:30,  4.82s/it]Running generate_until requests:  45%|████▌     | 45/100 [05:03<05:17,  5.78s/it]Running generate_until requests:  46%|████▌     | 46/100 [05:08<05:00,  5.56s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:13<04:54,  5.55s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:17<04:20,  5.01s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:26<05:06,  6.01s/it]Running generate_until requests:  50%|█████     | 50/100 [05:32<05:01,  6.03s/it]Running generate_until requests:  51%|█████     | 51/100 [05:36<04:28,  5.47s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:47<05:39,  7.08s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:57<06:26,  8.21s/it]Running generate_until requests:  54%|█████▍    | 54/100 [06:02<05:24,  7.06s/it]Running generate_until requests:  55%|█████▌    | 55/100 [06:08<05:03,  6.75s/it]Running generate_until requests:  56%|█████▌    | 56/100 [06:12<04:17,  5.85s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:17<04:07,  5.76s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:24<04:19,  6.18s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:30<04:03,  5.94s/it]Running generate_until requests:  60%|██████    | 60/100 [06:36<03:59,  5.98s/it]Running generate_until requests:  61%|██████    | 61/100 [06:41<03:45,  5.78s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:46<03:26,  5.45s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:51<03:13,  5.24s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:56<03:11,  5.31s/it]Running generate_until requests:  65%|██████▌   | 65/100 [07:01<03:02,  5.21s/it]Running generate_until requests:  66%|██████▌   | 66/100 [07:08<03:14,  5.73s/it]Running generate_until requests:  67%|██████▋   | 67/100 [07:11<02:41,  4.88s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:18<02:57,  5.53s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:22<02:40,  5.17s/it]Running generate_until requests:  70%|███████   | 70/100 [07:30<02:59,  6.00s/it]Running generate_until requests:  71%|███████   | 71/100 [07:38<03:11,  6.60s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:44<03:01,  6.49s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:49<02:43,  6.07s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:55<02:30,  5.78s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:59<02:13,  5.33s/it]Running generate_until requests:  76%|███████▌  | 76/100 [08:07<02:26,  6.12s/it]Running generate_until requests:  77%|███████▋  | 77/100 [08:12<02:13,  5.80s/it]Running generate_until requests:  78%|███████▊  | 78/100 [08:19<02:18,  6.31s/it]Running generate_until requests:  79%|███████▉  | 79/100 [08:27<02:18,  6.59s/it]Running generate_until requests:  80%|████████  | 80/100 [08:33<02:11,  6.56s/it]Running generate_until requests:  81%|████████  | 81/100 [08:37<01:51,  5.88s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:44<01:51,  6.17s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:51<01:48,  6.40s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:56<01:33,  5.83s/it]Running generate_until requests:  85%|████████▌ | 85/100 [09:06<01:46,  7.09s/it]Running generate_until requests:  86%|████████▌ | 86/100 [09:10<01:27,  6.26s/it]Running generate_until requests:  87%|████████▋ | 87/100 [09:15<01:18,  6.03s/it]Running generate_until requests:  88%|████████▊ | 88/100 [09:23<01:19,  6.59s/it]Running generate_until requests:  89%|████████▉ | 89/100 [09:31<01:14,  6.76s/it]Running generate_until requests:  90%|█████████ | 90/100 [09:34<00:57,  5.75s/it]Running generate_until requests:  91%|█████████ | 91/100 [09:39<00:48,  5.42s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:44<00:43,  5.39s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:48<00:35,  5.06s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:58<00:38,  6.34s/it]Running generate_until requests:  95%|█████████▌| 95/100 [10:02<00:28,  5.74s/it]Running generate_until requests:  96%|█████████▌| 96/100 [10:07<00:22,  5.51s/it]Running generate_until requests:  97%|█████████▋| 97/100 [10:13<00:17,  5.85s/it]Running generate_until requests:  98%|█████████▊| 98/100 [10:18<00:11,  5.52s/it]Running generate_until requests:  99%|█████████▉| 99/100 [10:23<00:05,  5.17s/it]Running generate_until requests: 100%|██████████| 100/100 [10:27<00:00,  4.96s/it]Running generate_until requests: 100%|██████████| 100/100 [10:27<00:00,  6.28s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:02:37:32,004 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:02:37:32,023 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:02:38:14,856 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:02:38:30,077 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:02:38:30,079 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:02:38:30,089 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:02:38:30,089 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:02:38:30,090 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:02:38:30,342 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:02:38:30,540 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:02:38:30,917 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.03s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.18it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.35it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s]
2024-12-27:02:38:40,318 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:02:38:40,321 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 348.16it/s] 70%|███████   | 70/100 [00:00<00:00, 348.16it/s]100%|██████████| 100/100 [00:00<00:00, 348.19it/s]
2024-12-27:02:38:40,613 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:06<10:27,  6.34s/it]Running generate_until requests:   2%|▏         | 2/100 [00:13<10:50,  6.63s/it]Running generate_until requests:   3%|▎         | 3/100 [00:24<14:18,  8.85s/it]Running generate_until requests:   4%|▍         | 4/100 [00:31<12:53,  8.06s/it]Running generate_until requests:   5%|▌         | 5/100 [00:38<12:15,  7.74s/it]Running generate_until requests:   6%|▌         | 6/100 [00:44<10:59,  7.02s/it]Running generate_until requests:   7%|▋         | 7/100 [00:51<11:09,  7.20s/it]Running generate_until requests:   8%|▊         | 8/100 [00:59<11:24,  7.44s/it]Running generate_until requests:   9%|▉         | 9/100 [01:05<10:36,  7.00s/it]Running generate_until requests:  10%|█         | 10/100 [01:10<09:18,  6.21s/it]Running generate_until requests:  11%|█         | 11/100 [01:17<09:32,  6.43s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:20<08:11,  5.59s/it]Running generate_until requests:  13%|█▎        | 13/100 [01:28<09:11,  6.33s/it]Running generate_until requests:  14%|█▍        | 14/100 [01:33<08:12,  5.73s/it]Running generate_until requests:  15%|█▌        | 15/100 [01:44<10:33,  7.46s/it]Running generate_until requests:  16%|█▌        | 16/100 [01:53<10:55,  7.80s/it]Running generate_until requests:  17%|█▋        | 17/100 [01:56<08:59,  6.50s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:02<08:35,  6.28s/it]Running generate_until requests:  19%|█▉        | 19/100 [02:11<09:34,  7.10s/it]Running generate_until requests:  20%|██        | 20/100 [02:22<11:07,  8.35s/it]Running generate_until requests:  21%|██        | 21/100 [02:31<10:55,  8.29s/it]Running generate_until requests:  22%|██▏       | 22/100 [02:38<10:19,  7.94s/it]Running generate_until requests:  23%|██▎       | 23/100 [02:44<09:32,  7.43s/it]Running generate_until requests:  24%|██▍       | 24/100 [02:55<10:43,  8.46s/it]Running generate_until requests:  25%|██▌       | 25/100 [03:02<10:07,  8.10s/it]Running generate_until requests:  26%|██▌       | 26/100 [03:06<08:26,  6.84s/it]Running generate_until requests:  27%|██▋       | 27/100 [03:11<07:49,  6.43s/it]Running generate_until requests:  28%|██▊       | 28/100 [03:19<08:14,  6.87s/it]Running generate_until requests:  29%|██▉       | 29/100 [03:29<09:17,  7.85s/it]Running generate_until requests:  30%|███       | 30/100 [03:35<08:14,  7.07s/it]Running generate_until requests:  31%|███       | 31/100 [03:40<07:24,  6.44s/it]Running generate_until requests:  32%|███▏      | 32/100 [03:51<08:51,  7.81s/it]Running generate_until requests:  33%|███▎      | 33/100 [03:54<07:16,  6.51s/it]Running generate_until requests:  34%|███▍      | 34/100 [04:02<07:40,  6.98s/it]Running generate_until requests:  35%|███▌      | 35/100 [04:09<07:25,  6.85s/it]Running generate_until requests:  36%|███▌      | 36/100 [04:12<06:11,  5.80s/it]Running generate_until requests:  37%|███▋      | 37/100 [04:16<05:25,  5.17s/it]Running generate_until requests:  38%|███▊      | 38/100 [04:25<06:43,  6.51s/it]Running generate_until requests:  39%|███▉      | 39/100 [04:31<06:12,  6.10s/it]Running generate_until requests:  40%|████      | 40/100 [04:34<05:13,  5.23s/it]Running generate_until requests:  41%|████      | 41/100 [04:37<04:41,  4.77s/it]Running generate_until requests:  42%|████▏     | 42/100 [04:44<05:07,  5.30s/it]Running generate_until requests:  43%|████▎     | 43/100 [04:49<05:04,  5.34s/it]Running generate_until requests:  44%|████▍     | 44/100 [04:53<04:28,  4.79s/it]Running generate_until requests:  45%|████▌     | 45/100 [05:01<05:15,  5.74s/it]Running generate_until requests:  46%|████▌     | 46/100 [05:06<04:58,  5.53s/it]Running generate_until requests:  47%|████▋     | 47/100 [05:11<04:52,  5.52s/it]Running generate_until requests:  48%|████▊     | 48/100 [05:15<04:18,  4.98s/it]Running generate_until requests:  49%|████▉     | 49/100 [05:23<05:04,  5.97s/it]Running generate_until requests:  50%|█████     | 50/100 [05:29<04:59,  5.99s/it]Running generate_until requests:  51%|█████     | 51/100 [05:34<04:26,  5.44s/it]Running generate_until requests:  52%|█████▏    | 52/100 [05:44<05:37,  7.03s/it]Running generate_until requests:  53%|█████▎    | 53/100 [05:55<06:22,  8.15s/it]Running generate_until requests:  54%|█████▍    | 54/100 [05:59<05:21,  7.00s/it]Running generate_until requests:  55%|█████▌    | 55/100 [06:05<05:01,  6.69s/it]Running generate_until requests:  56%|█████▌    | 56/100 [06:09<04:15,  5.80s/it]Running generate_until requests:  57%|█████▋    | 57/100 [06:15<04:05,  5.72s/it]Running generate_until requests:  58%|█████▊    | 58/100 [06:22<04:17,  6.13s/it]Running generate_until requests:  59%|█████▉    | 59/100 [06:27<04:01,  5.90s/it]Running generate_until requests:  60%|██████    | 60/100 [06:33<03:57,  5.94s/it]Running generate_until requests:  61%|██████    | 61/100 [06:38<03:43,  5.74s/it]Running generate_until requests:  62%|██████▏   | 62/100 [06:43<03:25,  5.41s/it]Running generate_until requests:  63%|██████▎   | 63/100 [06:48<03:12,  5.20s/it]Running generate_until requests:  64%|██████▍   | 64/100 [06:53<03:09,  5.28s/it]Running generate_until requests:  65%|██████▌   | 65/100 [06:58<03:01,  5.18s/it]Running generate_until requests:  66%|██████▌   | 66/100 [07:05<03:13,  5.69s/it]Running generate_until requests:  67%|██████▋   | 67/100 [07:08<02:39,  4.85s/it]Running generate_until requests:  68%|██████▊   | 68/100 [07:15<02:55,  5.49s/it]Running generate_until requests:  69%|██████▉   | 69/100 [07:19<02:39,  5.13s/it]Running generate_until requests:  70%|███████   | 70/100 [07:27<02:58,  5.95s/it]Running generate_until requests:  71%|███████   | 71/100 [07:35<03:09,  6.55s/it]Running generate_until requests:  72%|███████▏  | 72/100 [07:41<03:00,  6.44s/it]Running generate_until requests:  73%|███████▎  | 73/100 [07:46<02:42,  6.03s/it]Running generate_until requests:  74%|███████▍  | 74/100 [07:51<02:29,  5.74s/it]Running generate_until requests:  75%|███████▌  | 75/100 [07:56<02:12,  5.29s/it]Running generate_until requests:  76%|███████▌  | 76/100 [08:04<02:25,  6.08s/it]Running generate_until requests:  77%|███████▋  | 77/100 [08:09<02:12,  5.76s/it]Running generate_until requests:  78%|███████▊  | 78/100 [08:16<02:17,  6.27s/it]Running generate_until requests:  79%|███████▉  | 79/100 [08:23<02:17,  6.55s/it]Running generate_until requests:  80%|████████  | 80/100 [08:30<02:10,  6.51s/it]Running generate_until requests:  81%|████████  | 81/100 [08:34<01:50,  5.84s/it]Running generate_until requests:  82%|████████▏ | 82/100 [08:41<01:50,  6.12s/it]Running generate_until requests:  83%|████████▎ | 83/100 [08:48<01:48,  6.36s/it]Running generate_until requests:  84%|████████▍ | 84/100 [08:52<01:32,  5.79s/it]Running generate_until requests:  85%|████████▌ | 85/100 [09:02<01:45,  7.04s/it]Running generate_until requests:  86%|████████▌ | 86/100 [09:06<01:27,  6.22s/it]Running generate_until requests:  87%|████████▋ | 87/100 [09:12<01:17,  5.98s/it]Running generate_until requests:  88%|████████▊ | 88/100 [09:20<01:18,  6.54s/it]Running generate_until requests:  89%|████████▉ | 89/100 [09:27<01:13,  6.72s/it]Running generate_until requests:  90%|█████████ | 90/100 [09:30<00:57,  5.71s/it]Running generate_until requests:  91%|█████████ | 91/100 [09:35<00:48,  5.38s/it]Running generate_until requests:  92%|█████████▏| 92/100 [09:40<00:42,  5.36s/it]Running generate_until requests:  93%|█████████▎| 93/100 [09:44<00:35,  5.02s/it]Running generate_until requests:  94%|█████████▍| 94/100 [09:54<00:37,  6.30s/it]Running generate_until requests:  95%|█████████▌| 95/100 [09:58<00:28,  5.70s/it]Running generate_until requests:  96%|█████████▌| 96/100 [10:03<00:21,  5.47s/it]Running generate_until requests:  97%|█████████▋| 97/100 [10:09<00:17,  5.82s/it]Running generate_until requests:  98%|█████████▊| 98/100 [10:14<00:10,  5.48s/it]Running generate_until requests:  99%|█████████▉| 99/100 [10:18<00:05,  5.14s/it]Running generate_until requests: 100%|██████████| 100/100 [10:23<00:00,  4.93s/it]Running generate_until requests: 100%|██████████| 100/100 [10:23<00:00,  6.23s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:02:49:09,432 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:02:49:09,488 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:02:51:02,626 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:02:51:17,744 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:02:51:17,746 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:02:51:17,757 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:02:51:17,758 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:02:51:17,759 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:02:51:18,028 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:02:51:18,265 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:02:51:18,637 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.03s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.16it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s]
2024-12-27:02:51:27,080 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:02:51:27,082 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 344.42it/s] 70%|███████   | 70/100 [00:00<00:00, 347.17it/s]100%|██████████| 100/100 [00:00<00:00, 347.66it/s]
2024-12-27:02:51:27,375 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:08<14:37,  8.87s/it]Running generate_until requests:   2%|▏         | 2/100 [00:18<15:33,  9.53s/it]Running generate_until requests:   3%|▎         | 3/100 [00:34<20:17, 12.55s/it]Running generate_until requests:   4%|▍         | 4/100 [00:45<18:32, 11.58s/it]Running generate_until requests:   5%|▌         | 5/100 [00:55<17:38, 11.14s/it]Running generate_until requests:   6%|▌         | 6/100 [01:03<15:51, 10.12s/it]Running generate_until requests:   7%|▋         | 7/100 [01:14<16:03, 10.36s/it]Running generate_until requests:   8%|▊         | 8/100 [01:27<16:57, 11.06s/it]Running generate_until requests:   9%|▉         | 9/100 [01:35<15:39, 10.33s/it]Running generate_until requests:  10%|█         | 10/100 [01:40<13:08,  8.76s/it]Running generate_until requests:  11%|█         | 11/100 [01:50<13:33,  9.14s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:56<11:43,  8.00s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:07<13:08,  9.07s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:14<11:48,  8.24s/it]Running generate_until requests:  15%|█▌        | 15/100 [02:30<15:04, 10.65s/it]Running generate_until requests:  16%|█▌        | 16/100 [02:42<15:35, 11.13s/it]Running generate_until requests:  17%|█▋        | 17/100 [02:47<12:53,  9.32s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:56<12:21,  9.04s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:08<13:41, 10.14s/it]Running generate_until requests:  20%|██        | 20/100 [03:24<15:49, 11.87s/it]Running generate_until requests:  21%|██        | 21/100 [03:37<15:47, 11.99s/it]Running generate_until requests:  22%|██▏       | 22/100 [03:48<15:28, 11.90s/it]Running generate_until requests:  23%|██▎       | 23/100 [03:57<14:07, 11.00s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:13<15:40, 12.38s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:23<14:45, 11.81s/it]Running generate_until requests:  26%|██▌       | 26/100 [04:28<11:55,  9.67s/it]Running generate_until requests:  27%|██▋       | 27/100 [04:36<11:05,  9.12s/it]Running generate_until requests:  28%|██▊       | 28/100 [04:47<11:38,  9.70s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:01<13:06, 11.07s/it]Running generate_until requests:  30%|███       | 30/100 [05:09<11:39, 10.00s/it]Running generate_until requests:  31%|███       | 31/100 [05:16<10:30,  9.13s/it]Running generate_until requests:  32%|███▏      | 32/100 [05:31<12:29, 11.02s/it]Running generate_until requests:  33%|███▎      | 33/100 [05:36<10:18,  9.23s/it]Running generate_until requests:  34%|███▍      | 34/100 [05:47<10:50,  9.85s/it]Running generate_until requests:  35%|███▌      | 35/100 [05:57<10:28,  9.67s/it]Running generate_until requests:  36%|███▌      | 36/100 [06:02<08:46,  8.23s/it]Running generate_until requests:  37%|███▋      | 37/100 [06:07<07:43,  7.36s/it]Running generate_until requests:  38%|███▊      | 38/100 [06:22<10:04,  9.75s/it]Running generate_until requests:  39%|███▉      | 39/100 [06:29<09:00,  8.85s/it]Running generate_until requests:  40%|████      | 40/100 [06:34<07:35,  7.60s/it]Running generate_until requests:  41%|████      | 41/100 [06:39<06:47,  6.91s/it]Running generate_until requests:  42%|████▏     | 42/100 [06:46<06:37,  6.86s/it]Running generate_until requests:  43%|████▎     | 43/100 [06:53<06:44,  7.10s/it]Running generate_until requests:  44%|████▍     | 44/100 [06:58<06:03,  6.49s/it]Running generate_until requests:  45%|████▌     | 45/100 [07:10<07:15,  7.92s/it]Running generate_until requests:  46%|████▌     | 46/100 [07:17<06:55,  7.69s/it]Running generate_until requests:  47%|████▋     | 47/100 [07:25<06:47,  7.69s/it]Running generate_until requests:  48%|████▊     | 48/100 [07:30<06:02,  6.98s/it]Running generate_until requests:  49%|████▉     | 49/100 [07:44<07:40,  9.03s/it]Running generate_until requests:  50%|█████     | 50/100 [07:56<08:19,  9.98s/it]Running generate_until requests:  51%|█████     | 51/100 [08:02<07:08,  8.75s/it]Running generate_until requests:  52%|█████▏    | 52/100 [08:17<08:28, 10.60s/it]Running generate_until requests:  53%|█████▎    | 53/100 [08:32<09:18, 11.88s/it]Running generate_until requests:  54%|█████▍    | 54/100 [08:38<07:46, 10.14s/it]Running generate_until requests:  55%|█████▌    | 55/100 [08:46<07:11,  9.59s/it]Running generate_until requests:  56%|█████▌    | 56/100 [08:52<06:19,  8.63s/it]Running generate_until requests:  57%|█████▋    | 57/100 [09:01<06:16,  8.76s/it]Running generate_until requests:  58%|█████▊    | 58/100 [09:11<06:23,  9.14s/it]Running generate_until requests:  59%|█████▉    | 59/100 [09:19<05:54,  8.65s/it]Running generate_until requests:  60%|██████    | 60/100 [09:25<05:16,  7.91s/it]Running generate_until requests:  61%|██████    | 61/100 [09:33<05:02,  7.76s/it]Running generate_until requests:  62%|██████▏   | 62/100 [09:39<04:41,  7.40s/it]Running generate_until requests:  63%|██████▎   | 63/100 [09:46<04:25,  7.17s/it]Running generate_until requests:  64%|██████▍   | 64/100 [09:53<04:23,  7.31s/it]Running generate_until requests:  65%|██████▌   | 65/100 [10:00<04:12,  7.20s/it]Running generate_until requests:  66%|██████▌   | 66/100 [10:10<04:28,  7.90s/it]Running generate_until requests:  67%|██████▋   | 67/100 [10:14<03:43,  6.77s/it]Running generate_until requests:  68%|██████▊   | 68/100 [10:25<04:13,  7.93s/it]Running generate_until requests:  69%|██████▉   | 69/100 [10:31<03:48,  7.38s/it]Running generate_until requests:  70%|███████   | 70/100 [10:41<04:05,  8.17s/it]Running generate_until requests:  71%|███████   | 71/100 [10:52<04:22,  9.04s/it]Running generate_until requests:  72%|███████▏  | 72/100 [11:03<04:27,  9.54s/it]Running generate_until requests:  73%|███████▎  | 73/100 [11:10<04:00,  8.90s/it]Running generate_until requests:  74%|███████▍  | 74/100 [11:24<04:33, 10.53s/it]Running generate_until requests:  75%|███████▌  | 75/100 [11:30<03:49,  9.17s/it]Running generate_until requests:  76%|███████▌  | 76/100 [11:40<03:42,  9.29s/it]Running generate_until requests:  77%|███████▋  | 77/100 [11:47<03:17,  8.60s/it]Running generate_until requests:  78%|███████▊  | 78/100 [11:57<03:20,  9.11s/it]Running generate_until requests:  79%|███████▉  | 79/100 [12:07<03:13,  9.21s/it]Running generate_until requests:  80%|████████  | 80/100 [12:15<03:02,  9.10s/it]Running generate_until requests:  81%|████████  | 81/100 [12:21<02:34,  8.15s/it]Running generate_until requests:  82%|████████▏ | 82/100 [12:27<02:12,  7.34s/it]Running generate_until requests:  83%|████████▎ | 83/100 [12:36<02:15,  7.98s/it]Running generate_until requests:  84%|████████▍ | 84/100 [12:42<01:59,  7.44s/it]Running generate_until requests:  85%|████████▌ | 85/100 [12:56<02:18,  9.26s/it]Running generate_until requests:  86%|████████▌ | 86/100 [13:02<01:55,  8.25s/it]Running generate_until requests:  87%|████████▋ | 87/100 [13:09<01:44,  8.01s/it]Running generate_until requests:  88%|████████▊ | 88/100 [13:20<01:45,  8.83s/it]Running generate_until requests:  89%|████████▉ | 89/100 [13:29<01:37,  8.83s/it]Running generate_until requests:  90%|█████████ | 90/100 [13:34<01:15,  7.58s/it]Running generate_until requests:  91%|█████████ | 91/100 [13:40<01:04,  7.20s/it]Running generate_until requests:  92%|█████████▏| 92/100 [13:47<00:57,  7.22s/it]Running generate_until requests:  93%|█████████▎| 93/100 [13:53<00:47,  6.82s/it]Running generate_until requests:  94%|█████████▍| 94/100 [14:06<00:51,  8.58s/it]Running generate_until requests:  95%|█████████▌| 95/100 [14:12<00:39,  7.84s/it]Running generate_until requests:  96%|█████████▌| 96/100 [14:19<00:30,  7.52s/it]Running generate_until requests:  97%|█████████▋| 97/100 [14:25<00:21,  7.33s/it]Running generate_until requests:  98%|█████████▊| 98/100 [14:32<00:14,  7.05s/it]Running generate_until requests:  99%|█████████▉| 99/100 [14:38<00:06,  6.71s/it]Running generate_until requests: 100%|██████████| 100/100 [14:45<00:00,  6.72s/it]Running generate_until requests: 100%|██████████| 100/100 [14:45<00:00,  8.85s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:03:06:18,301 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:03:06:18,343 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:03:07:01,229 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:03:07:16,229 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:03:07:16,231 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:03:07:16,242 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:03:07:16,243 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:03:07:16,243 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:03:07:16,504 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:03:07:16,723 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:03:07:17,099 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.06s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.12it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.23it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s]
2024-12-27:03:07:25,485 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:03:07:25,487 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 347.37it/s] 70%|███████   | 70/100 [00:00<00:00, 346.97it/s]100%|██████████| 100/100 [00:00<00:00, 345.91it/s]
2024-12-27:03:07:25,781 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:08<14:35,  8.85s/it]Running generate_until requests:   2%|▏         | 2/100 [00:18<15:31,  9.50s/it]Running generate_until requests:   3%|▎         | 3/100 [00:34<20:11, 12.49s/it]Running generate_until requests:   4%|▍         | 4/100 [00:44<18:27, 11.54s/it]Running generate_until requests:   5%|▌         | 5/100 [00:55<17:34, 11.10s/it]Running generate_until requests:   6%|▌         | 6/100 [01:03<15:48, 10.09s/it]Running generate_until requests:   7%|▋         | 7/100 [01:14<16:01, 10.34s/it]Running generate_until requests:   8%|▊         | 8/100 [01:26<16:55, 11.04s/it]Running generate_until requests:   9%|▉         | 9/100 [01:35<15:37, 10.30s/it]Running generate_until requests:  10%|█         | 10/100 [01:40<13:06,  8.74s/it]Running generate_until requests:  11%|█         | 11/100 [01:50<13:31,  9.12s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:56<11:42,  7.98s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:07<13:07,  9.05s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:13<11:47,  8.22s/it]Running generate_until requests:  15%|█▌        | 15/100 [02:30<15:07, 10.68s/it]Running generate_until requests:  16%|█▌        | 16/100 [02:42<15:36, 11.15s/it]Running generate_until requests:  17%|█▋        | 17/100 [02:47<12:54,  9.33s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:55<12:21,  9.04s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:08<13:41, 10.14s/it]Running generate_until requests:  20%|██        | 20/100 [03:24<15:48, 11.86s/it]Running generate_until requests:  21%|██        | 21/100 [03:36<15:45, 11.97s/it]Running generate_until requests:  22%|██▏       | 22/100 [03:48<15:26, 11.88s/it]Running generate_until requests:  23%|██▎       | 23/100 [03:57<14:05, 10.98s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:12<15:38, 12.35s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:23<14:43, 11.79s/it]Running generate_until requests:  26%|██▌       | 26/100 [04:28<11:54,  9.65s/it]Running generate_until requests:  27%|██▋       | 27/100 [04:35<11:04,  9.10s/it]Running generate_until requests:  28%|██▊       | 28/100 [04:46<11:36,  9.67s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:01<13:04, 11.05s/it]Running generate_until requests:  30%|███       | 30/100 [05:08<11:38,  9.98s/it]Running generate_until requests:  31%|███       | 31/100 [05:15<10:28,  9.11s/it]Running generate_until requests:  32%|███▏      | 32/100 [05:31<12:28, 11.00s/it]Running generate_until requests:  33%|███▎      | 33/100 [05:36<10:17,  9.21s/it]Running generate_until requests:  34%|███▍      | 34/100 [05:47<10:48,  9.83s/it]Running generate_until requests:  35%|███▌      | 35/100 [05:56<10:27,  9.65s/it]Running generate_until requests:  36%|███▌      | 36/100 [06:01<08:45,  8.21s/it]Running generate_until requests:  37%|███▋      | 37/100 [06:06<07:42,  7.35s/it]Running generate_until requests:  38%|███▊      | 38/100 [06:22<10:03,  9.73s/it]Running generate_until requests:  39%|███▉      | 39/100 [06:28<08:58,  8.83s/it]Running generate_until requests:  40%|████      | 40/100 [06:33<07:34,  7.58s/it]Running generate_until requests:  41%|████      | 41/100 [06:38<06:47,  6.90s/it]Running generate_until requests:  42%|████▏     | 42/100 [06:45<06:36,  6.84s/it]Running generate_until requests:  43%|████▎     | 43/100 [06:53<06:43,  7.08s/it]Running generate_until requests:  44%|████▍     | 44/100 [06:58<06:02,  6.48s/it]Running generate_until requests:  45%|████▌     | 45/100 [07:09<07:14,  7.91s/it]Running generate_until requests:  46%|████▌     | 46/100 [07:16<06:54,  7.67s/it]Running generate_until requests:  47%|████▋     | 47/100 [07:24<06:46,  7.67s/it]Running generate_until requests:  48%|████▊     | 48/100 [07:29<06:02,  6.97s/it]Running generate_until requests:  49%|████▉     | 49/100 [07:43<07:39,  9.01s/it]Running generate_until requests:  50%|█████     | 50/100 [07:55<08:18,  9.96s/it]Running generate_until requests:  51%|█████     | 51/100 [08:01<07:07,  8.73s/it]Running generate_until requests:  52%|█████▏    | 52/100 [08:16<08:27, 10.58s/it]Running generate_until requests:  53%|█████▎    | 53/100 [08:31<09:17, 11.85s/it]Running generate_until requests:  54%|█████▍    | 54/100 [08:37<07:45, 10.12s/it]Running generate_until requests:  55%|█████▌    | 55/100 [08:45<07:10,  9.56s/it]Running generate_until requests:  56%|█████▌    | 56/100 [08:51<06:18,  8.61s/it]Running generate_until requests:  57%|█████▋    | 57/100 [09:00<06:15,  8.74s/it]Running generate_until requests:  58%|█████▊    | 58/100 [09:10<06:23,  9.12s/it]Running generate_until requests:  59%|█████▉    | 59/100 [09:18<05:54,  8.64s/it]Running generate_until requests:  60%|██████    | 60/100 [09:24<05:15,  7.90s/it]Running generate_until requests:  61%|██████    | 61/100 [09:31<05:02,  7.75s/it]Running generate_until requests:  62%|██████▏   | 62/100 [09:38<04:40,  7.38s/it]Running generate_until requests:  63%|██████▎   | 63/100 [09:45<04:24,  7.16s/it]Running generate_until requests:  64%|██████▍   | 64/100 [09:52<04:22,  7.30s/it]Running generate_until requests:  65%|██████▌   | 65/100 [09:59<04:11,  7.19s/it]Running generate_until requests:  66%|██████▌   | 66/100 [10:09<04:27,  7.88s/it]Running generate_until requests:  67%|██████▋   | 67/100 [10:13<03:42,  6.75s/it]Running generate_until requests:  68%|██████▊   | 68/100 [10:23<04:13,  7.91s/it]Running generate_until requests:  69%|██████▉   | 69/100 [10:29<03:48,  7.36s/it]Running generate_until requests:  70%|███████   | 70/100 [10:39<04:04,  8.15s/it]Running generate_until requests:  71%|███████   | 71/100 [10:51<04:21,  9.02s/it]Running generate_until requests:  72%|███████▏  | 72/100 [11:01<04:26,  9.52s/it]Running generate_until requests:  73%|███████▎  | 73/100 [11:09<03:59,  8.88s/it]Running generate_until requests:  74%|███████▍  | 74/100 [11:23<04:33, 10.50s/it]Running generate_until requests:  75%|███████▌  | 75/100 [11:29<03:48,  9.14s/it]Running generate_until requests:  76%|███████▌  | 76/100 [11:38<03:42,  9.26s/it]Running generate_until requests:  77%|███████▋  | 77/100 [11:45<03:17,  8.58s/it]Running generate_until requests:  78%|███████▊  | 78/100 [11:56<03:19,  9.09s/it]Running generate_until requests:  79%|███████▉  | 79/100 [12:05<03:13,  9.19s/it]Running generate_until requests:  80%|████████  | 80/100 [12:14<03:01,  9.08s/it]Running generate_until requests:  81%|████████  | 81/100 [12:20<02:34,  8.13s/it]Running generate_until requests:  82%|████████▏ | 82/100 [12:25<02:11,  7.33s/it]Running generate_until requests:  83%|████████▎ | 83/100 [12:35<02:15,  7.96s/it]Running generate_until requests:  84%|████████▍ | 84/100 [12:41<01:58,  7.43s/it]Running generate_until requests:  85%|████████▌ | 85/100 [12:54<02:18,  9.24s/it]Running generate_until requests:  86%|████████▌ | 86/100 [13:00<01:55,  8.23s/it]Running generate_until requests:  87%|████████▋ | 87/100 [13:08<01:43,  7.99s/it]Running generate_until requests:  88%|████████▊ | 88/100 [13:18<01:45,  8.81s/it]Running generate_until requests:  89%|████████▉ | 89/100 [13:27<01:36,  8.81s/it]Running generate_until requests:  90%|█████████ | 90/100 [13:32<01:15,  7.56s/it]Running generate_until requests:  91%|█████████ | 91/100 [13:38<01:04,  7.19s/it]Running generate_until requests:  92%|█████████▏| 92/100 [13:45<00:57,  7.21s/it]Running generate_until requests:  93%|█████████▎| 93/100 [13:51<00:47,  6.80s/it]Running generate_until requests:  94%|█████████▍| 94/100 [14:04<00:51,  8.56s/it]Running generate_until requests:  95%|█████████▌| 95/100 [14:10<00:39,  7.83s/it]Running generate_until requests:  96%|█████████▌| 96/100 [14:17<00:30,  7.50s/it]Running generate_until requests:  97%|█████████▋| 97/100 [14:24<00:21,  7.31s/it]Running generate_until requests:  98%|█████████▊| 98/100 [14:30<00:14,  7.03s/it]Running generate_until requests:  99%|█████████▉| 99/100 [14:36<00:06,  6.69s/it]Running generate_until requests: 100%|██████████| 100/100 [14:43<00:00,  6.71s/it]Running generate_until requests: 100%|██████████| 100/100 [14:43<00:00,  8.83s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:03:22:14,579 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:03:22:14,618 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:03:22:57,734 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:03:23:12,740 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:03:23:12,742 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:03:23:12,753 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:03:23:12,754 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:03:23:12,754 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:03:23:13,029 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:03:23:13,247 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:03:23:13,623 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.05s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.14it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.20it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.23it/s]
2024-12-27:03:23:22,343 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:03:23:22,346 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 345.17it/s] 70%|███████   | 70/100 [00:00<00:00, 344.97it/s]100%|██████████| 100/100 [00:00<00:00, 346.11it/s]
2024-12-27:03:23:22,640 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:08<14:36,  8.85s/it]Running generate_until requests:   2%|▏         | 2/100 [00:18<15:30,  9.50s/it]Running generate_until requests:   3%|▎         | 3/100 [00:34<20:10, 12.47s/it]Running generate_until requests:   4%|▍         | 4/100 [00:44<18:26, 11.53s/it]Running generate_until requests:   5%|▌         | 5/100 [00:55<17:33, 11.09s/it]Running generate_until requests:   6%|▌         | 6/100 [01:03<15:47, 10.08s/it]Running generate_until requests:   7%|▋         | 7/100 [01:14<16:00, 10.32s/it]Running generate_until requests:   8%|▊         | 8/100 [01:26<16:53, 11.02s/it]Running generate_until requests:   9%|▉         | 9/100 [01:35<15:35, 10.29s/it]Running generate_until requests:  10%|█         | 10/100 [01:40<13:05,  8.73s/it]Running generate_until requests:  11%|█         | 11/100 [01:50<13:30,  9.10s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:55<11:41,  7.97s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:07<13:05,  9.03s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:13<11:46,  8.21s/it]Running generate_until requests:  15%|█▌        | 15/100 [02:29<15:01, 10.61s/it]Running generate_until requests:  16%|█▌        | 16/100 [02:42<15:31, 11.09s/it]Running generate_until requests:  17%|█▋        | 17/100 [02:47<12:51,  9.29s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:55<12:21,  9.04s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:08<13:40, 10.13s/it]Running generate_until requests:  20%|██        | 20/100 [03:24<15:47, 11.84s/it]Running generate_until requests:  21%|██        | 21/100 [03:36<15:44, 11.96s/it]Running generate_until requests:  22%|██▏       | 22/100 [03:48<15:25, 11.87s/it]Running generate_until requests:  23%|██▎       | 23/100 [03:56<14:04, 10.96s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:12<15:37, 12.34s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:22<14:42, 11.77s/it]Running generate_until requests:  26%|██▌       | 26/100 [04:27<11:53,  9.64s/it]Running generate_until requests:  27%|██▋       | 27/100 [04:35<11:03,  9.09s/it]Running generate_until requests:  28%|██▊       | 28/100 [04:46<11:36,  9.67s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:00<13:04, 11.05s/it]Running generate_until requests:  30%|███       | 30/100 [05:08<11:37,  9.97s/it]Running generate_until requests:  31%|███       | 31/100 [05:15<10:28,  9.10s/it]Running generate_until requests:  32%|███▏      | 32/100 [05:30<12:26, 10.98s/it]Running generate_until requests:  33%|███▎      | 33/100 [05:35<10:16,  9.20s/it]Running generate_until requests:  34%|███▍      | 34/100 [05:46<10:47,  9.81s/it]Running generate_until requests:  35%|███▌      | 35/100 [05:56<10:26,  9.63s/it]Running generate_until requests:  36%|███▌      | 36/100 [06:00<08:44,  8.20s/it]Running generate_until requests:  37%|███▋      | 37/100 [06:06<07:42,  7.34s/it]Running generate_until requests:  38%|███▊      | 38/100 [06:21<10:02,  9.71s/it]Running generate_until requests:  39%|███▉      | 39/100 [06:28<08:57,  8.82s/it]Running generate_until requests:  40%|████      | 40/100 [06:32<07:34,  7.57s/it]Running generate_until requests:  41%|████      | 41/100 [06:38<06:46,  6.89s/it]Running generate_until requests:  42%|████▏     | 42/100 [06:44<06:36,  6.83s/it]Running generate_until requests:  43%|████▎     | 43/100 [06:52<06:43,  7.07s/it]Running generate_until requests:  44%|████▍     | 44/100 [06:57<06:02,  6.47s/it]Running generate_until requests:  45%|████▌     | 45/100 [07:08<07:14,  7.89s/it]Running generate_until requests:  46%|████▌     | 46/100 [07:15<06:53,  7.66s/it]Running generate_until requests:  47%|████▋     | 47/100 [07:23<06:45,  7.66s/it]Running generate_until requests:  48%|████▊     | 48/100 [07:28<06:01,  6.95s/it]Running generate_until requests:  49%|████▉     | 49/100 [07:42<07:38,  8.99s/it]Running generate_until requests:  50%|█████     | 50/100 [07:54<08:17,  9.94s/it]Running generate_until requests:  51%|█████     | 51/100 [08:00<07:06,  8.71s/it]Running generate_until requests:  52%|█████▏    | 52/100 [08:15<08:26, 10.56s/it]Running generate_until requests:  53%|█████▎    | 53/100 [08:30<09:15, 11.83s/it]Running generate_until requests:  54%|█████▍    | 54/100 [08:36<07:44, 10.10s/it]Running generate_until requests:  55%|█████▌    | 55/100 [08:44<07:09,  9.55s/it]Running generate_until requests:  56%|█████▌    | 56/100 [08:50<06:18,  8.59s/it]Running generate_until requests:  57%|█████▋    | 57/100 [08:59<06:15,  8.73s/it]Running generate_until requests:  58%|█████▊    | 58/100 [09:09<06:22,  9.10s/it]Running generate_until requests:  59%|█████▉    | 59/100 [09:17<05:53,  8.62s/it]Running generate_until requests:  60%|██████    | 60/100 [09:23<05:15,  7.88s/it]Running generate_until requests:  61%|██████    | 61/100 [09:30<05:01,  7.73s/it]Running generate_until requests:  62%|██████▏   | 62/100 [09:37<04:40,  7.37s/it]Running generate_until requests:  63%|██████▎   | 63/100 [09:44<04:24,  7.15s/it]Running generate_until requests:  64%|██████▍   | 64/100 [09:51<04:22,  7.28s/it]Running generate_until requests:  65%|██████▌   | 65/100 [09:58<04:11,  7.17s/it]Running generate_until requests:  66%|██████▌   | 66/100 [10:08<04:27,  7.87s/it]Running generate_until requests:  67%|██████▋   | 67/100 [10:12<03:42,  6.74s/it]Running generate_until requests:  68%|██████▊   | 68/100 [10:22<04:12,  7.90s/it]Running generate_until requests:  69%|██████▉   | 69/100 [10:28<03:47,  7.35s/it]Running generate_until requests:  70%|███████   | 70/100 [10:38<04:04,  8.14s/it]Running generate_until requests:  71%|███████   | 71/100 [10:49<04:21,  9.00s/it]Running generate_until requests:  72%|███████▏  | 72/100 [11:00<04:26,  9.50s/it]Running generate_until requests:  73%|███████▎  | 73/100 [11:07<03:59,  8.86s/it]Running generate_until requests:  74%|███████▍  | 74/100 [11:22<04:32, 10.48s/it]Running generate_until requests:  75%|███████▌  | 75/100 [11:28<03:48,  9.12s/it]Running generate_until requests:  76%|███████▌  | 76/100 [11:37<03:41,  9.25s/it]Running generate_until requests:  77%|███████▋  | 77/100 [11:44<03:16,  8.56s/it]Running generate_until requests:  78%|███████▊  | 78/100 [11:54<03:19,  9.07s/it]Running generate_until requests:  79%|███████▉  | 79/100 [12:04<03:12,  9.17s/it]Running generate_until requests:  80%|████████  | 80/100 [12:13<03:01,  9.06s/it]Running generate_until requests:  81%|████████  | 81/100 [12:19<02:34,  8.12s/it]Running generate_until requests:  82%|████████▏ | 82/100 [12:24<02:11,  7.31s/it]Running generate_until requests:  83%|████████▎ | 83/100 [12:33<02:15,  7.94s/it]Running generate_until requests:  84%|████████▍ | 84/100 [12:40<01:58,  7.41s/it]Running generate_until requests:  85%|████████▌ | 85/100 [12:53<02:18,  9.22s/it]Running generate_until requests:  86%|████████▌ | 86/100 [12:59<01:54,  8.21s/it]Running generate_until requests:  87%|████████▋ | 87/100 [13:06<01:43,  7.98s/it]Running generate_until requests:  88%|████████▊ | 88/100 [13:17<01:45,  8.79s/it]Running generate_until requests:  89%|████████▉ | 89/100 [13:26<01:36,  8.79s/it]Running generate_until requests:  90%|█████████ | 90/100 [13:30<01:15,  7.55s/it]Running generate_until requests:  91%|█████████ | 91/100 [13:37<01:04,  7.17s/it]Running generate_until requests:  92%|█████████▏| 92/100 [13:44<00:57,  7.19s/it]Running generate_until requests:  93%|█████████▎| 93/100 [13:50<00:47,  6.79s/it]Running generate_until requests:  94%|█████████▍| 94/100 [14:02<00:51,  8.55s/it]Running generate_until requests:  95%|█████████▌| 95/100 [14:09<00:39,  7.81s/it]Running generate_until requests:  96%|█████████▌| 96/100 [14:15<00:29,  7.49s/it]Running generate_until requests:  97%|█████████▋| 97/100 [14:22<00:21,  7.30s/it]Running generate_until requests:  98%|█████████▊| 98/100 [14:28<00:14,  7.02s/it]Running generate_until requests:  99%|█████████▉| 99/100 [14:34<00:06,  6.68s/it]Running generate_until requests: 100%|██████████| 100/100 [14:41<00:00,  6.69s/it]Running generate_until requests: 100%|██████████| 100/100 [14:41<00:00,  8.82s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:03:38:10,446 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:03:38:10,452 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:03:38:53,811 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:03:39:08,953 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:03:39:08,955 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:03:39:08,965 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:03:39:08,966 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:03:39:08,966 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:03:39:09,529 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:03:39:09,740 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:03:39:10,132 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.67s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.23s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.01it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.08s/it]
2024-12-27:03:39:19,798 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:03:39:19,802 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 35%|███▌      | 35/100 [00:00<00:00, 344.03it/s] 71%|███████   | 71/100 [00:00<00:00, 347.96it/s]100%|██████████| 100/100 [00:00<00:00, 348.98it/s]
2024-12-27:03:39:20,094 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:08<14:44,  8.94s/it]Running generate_until requests:   2%|▏         | 2/100 [00:18<15:36,  9.56s/it]Running generate_until requests:   3%|▎         | 3/100 [00:35<20:16, 12.54s/it]Running generate_until requests:   4%|▍         | 4/100 [00:45<18:31, 11.58s/it]Running generate_until requests:   5%|▌         | 5/100 [00:55<17:38, 11.14s/it]Running generate_until requests:   6%|▌         | 6/100 [01:03<15:51, 10.12s/it]Running generate_until requests:   7%|▋         | 7/100 [01:14<16:04, 10.37s/it]Running generate_until requests:   8%|▊         | 8/100 [01:27<16:58, 11.07s/it]Running generate_until requests:   9%|▉         | 9/100 [01:35<15:40, 10.33s/it]Running generate_until requests:  10%|█         | 10/100 [01:41<13:09,  8.77s/it]Running generate_until requests:  11%|█         | 11/100 [01:51<13:33,  9.14s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:56<11:44,  8.01s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:07<13:09,  9.07s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:14<11:49,  8.25s/it]Running generate_until requests:  15%|█▌        | 15/100 [02:30<15:05, 10.66s/it]Running generate_until requests:  16%|█▌        | 16/100 [02:42<15:35, 11.14s/it]Running generate_until requests:  17%|█▋        | 17/100 [02:47<12:54,  9.33s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:56<12:21,  9.05s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:09<13:42, 10.15s/it]Running generate_until requests:  20%|██        | 20/100 [03:24<15:50, 11.88s/it]Running generate_until requests:  21%|██        | 21/100 [03:37<15:49, 12.01s/it]Running generate_until requests:  22%|██▏       | 22/100 [03:49<15:30, 11.92s/it]Running generate_until requests:  23%|██▎       | 23/100 [03:57<14:08, 11.02s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:13<15:41, 12.39s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:24<14:46, 11.82s/it]Running generate_until requests:  26%|██▌       | 26/100 [04:28<11:56,  9.68s/it]Running generate_until requests:  27%|██▋       | 27/100 [04:36<11:06,  9.12s/it]Running generate_until requests:  28%|██▊       | 28/100 [04:47<11:38,  9.70s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:01<13:07, 11.09s/it]Running generate_until requests:  30%|███       | 30/100 [05:09<11:40, 10.01s/it]Running generate_until requests:  31%|███       | 31/100 [05:16<10:30,  9.14s/it]Running generate_until requests:  32%|███▏      | 32/100 [05:31<12:30, 11.03s/it]Running generate_until requests:  33%|███▎      | 33/100 [05:37<10:18,  9.24s/it]Running generate_until requests:  34%|███▍      | 34/100 [05:48<10:50,  9.86s/it]Running generate_until requests:  35%|███▌      | 35/100 [05:57<10:29,  9.68s/it]Running generate_until requests:  36%|███▌      | 36/100 [06:02<08:46,  8.23s/it]Running generate_until requests:  37%|███▋      | 37/100 [06:07<07:44,  7.37s/it]Running generate_until requests:  38%|███▊      | 38/100 [06:23<10:05,  9.76s/it]Running generate_until requests:  39%|███▉      | 39/100 [06:29<09:00,  8.86s/it]Running generate_until requests:  40%|████      | 40/100 [06:34<07:36,  7.61s/it]Running generate_until requests:  41%|████      | 41/100 [06:39<06:48,  6.92s/it]Running generate_until requests:  42%|████▏     | 42/100 [06:46<06:38,  6.86s/it]Running generate_until requests:  43%|████▎     | 43/100 [06:54<06:44,  7.10s/it]Running generate_until requests:  44%|████▍     | 44/100 [06:59<06:04,  6.50s/it]Running generate_until requests:  45%|████▌     | 45/100 [07:10<07:16,  7.93s/it]Running generate_until requests:  46%|████▌     | 46/100 [07:17<06:55,  7.69s/it]Running generate_until requests:  47%|████▋     | 47/100 [07:25<06:47,  7.69s/it]Running generate_until requests:  48%|████▊     | 48/100 [07:30<06:03,  6.99s/it]Running generate_until requests:  49%|████▉     | 49/100 [07:44<07:40,  9.03s/it]Running generate_until requests:  50%|█████     | 50/100 [07:56<08:19,  9.99s/it]Running generate_until requests:  51%|█████     | 51/100 [08:02<07:09,  8.76s/it]Running generate_until requests:  52%|█████▏    | 52/100 [08:17<08:29, 10.61s/it]Running generate_until requests:  53%|█████▎    | 53/100 [08:32<09:18, 11.89s/it]Running generate_until requests:  54%|█████▍    | 54/100 [08:38<07:46, 10.15s/it]Running generate_until requests:  55%|█████▌    | 55/100 [08:46<07:11,  9.60s/it]Running generate_until requests:  56%|█████▌    | 56/100 [08:53<06:20,  8.64s/it]Running generate_until requests:  57%|█████▋    | 57/100 [09:02<06:17,  8.77s/it]Running generate_until requests:  58%|█████▊    | 58/100 [09:12<06:24,  9.15s/it]Running generate_until requests:  59%|█████▉    | 59/100 [09:19<05:55,  8.66s/it]Running generate_until requests:  60%|██████    | 60/100 [09:26<05:16,  7.92s/it]Running generate_until requests:  61%|██████    | 61/100 [09:33<05:03,  7.77s/it]Running generate_until requests:  62%|██████▏   | 62/100 [09:40<04:41,  7.41s/it]Running generate_until requests:  63%|██████▎   | 63/100 [09:46<04:25,  7.18s/it]Running generate_until requests:  64%|██████▍   | 64/100 [09:54<04:23,  7.32s/it]Running generate_until requests:  65%|██████▌   | 65/100 [10:01<04:12,  7.21s/it]Running generate_until requests:  66%|██████▌   | 66/100 [10:10<04:28,  7.91s/it]Running generate_until requests:  67%|██████▋   | 67/100 [10:15<03:43,  6.77s/it]Running generate_until requests:  68%|██████▊   | 68/100 [10:25<04:13,  7.94s/it]Running generate_until requests:  69%|██████▉   | 69/100 [10:31<03:49,  7.39s/it]Running generate_until requests:  70%|███████   | 70/100 [10:41<04:05,  8.18s/it]Running generate_until requests:  71%|███████   | 71/100 [10:52<04:22,  9.05s/it]Running generate_until requests:  72%|███████▏  | 72/100 [11:03<04:27,  9.55s/it]Running generate_until requests:  73%|███████▎  | 73/100 [11:11<04:00,  8.91s/it]Running generate_until requests:  74%|███████▍  | 74/100 [11:25<04:34, 10.54s/it]Running generate_until requests:  75%|███████▌  | 75/100 [11:31<03:49,  9.17s/it]Running generate_until requests:  76%|███████▌  | 76/100 [11:40<03:43,  9.29s/it]Running generate_until requests:  77%|███████▋  | 77/100 [11:47<03:17,  8.61s/it]Running generate_until requests:  78%|███████▊  | 78/100 [11:58<03:20,  9.12s/it]Running generate_until requests:  79%|███████▉  | 79/100 [12:07<03:13,  9.22s/it]Running generate_until requests:  80%|████████  | 80/100 [12:16<03:02,  9.11s/it]Running generate_until requests:  81%|████████  | 81/100 [12:22<02:35,  8.16s/it]Running generate_until requests:  82%|████████▏ | 82/100 [12:27<02:12,  7.35s/it]Running generate_until requests:  83%|████████▎ | 83/100 [12:37<02:15,  7.99s/it]Running generate_until requests:  84%|████████▍ | 84/100 [12:43<01:59,  7.45s/it]Running generate_until requests:  85%|████████▌ | 85/100 [12:57<02:19,  9.27s/it]Running generate_until requests:  86%|████████▌ | 86/100 [13:03<01:55,  8.25s/it]Running generate_until requests:  87%|████████▋ | 87/100 [13:10<01:44,  8.02s/it]Running generate_until requests:  88%|████████▊ | 88/100 [13:21<01:46,  8.84s/it]Running generate_until requests:  89%|████████▉ | 89/100 [13:30<01:37,  8.84s/it]Running generate_until requests:  90%|█████████ | 90/100 [13:34<01:15,  7.59s/it]Running generate_until requests:  91%|█████████ | 91/100 [13:41<01:05,  7.22s/it]Running generate_until requests:  92%|█████████▏| 92/100 [13:48<00:57,  7.24s/it]Running generate_until requests:  93%|█████████▎| 93/100 [13:54<00:47,  6.83s/it]Running generate_until requests:  94%|█████████▍| 94/100 [14:07<00:51,  8.60s/it]Running generate_until requests:  95%|█████████▌| 95/100 [14:13<00:39,  7.86s/it]Running generate_until requests:  96%|█████████▌| 96/100 [14:19<00:30,  7.53s/it]Running generate_until requests:  97%|█████████▋| 97/100 [14:26<00:22,  7.34s/it]Running generate_until requests:  98%|█████████▊| 98/100 [14:33<00:14,  7.06s/it]Running generate_until requests:  99%|█████████▉| 99/100 [14:39<00:06,  6.72s/it]Running generate_until requests: 100%|██████████| 100/100 [14:45<00:00,  6.73s/it]Running generate_until requests: 100%|██████████| 100/100 [14:45<00:00,  8.86s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:03:54:12,111 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:03:54:12,135 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
2024-12-27:03:54:55,572 INFO     [__main__.py:279] Verbosity set to INFO
2024-12-27:03:55:10,888 WARNING  [__main__.py:312]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-12-27:03:55:10,890 INFO     [__main__.py:376] Selected Tasks: ['gsm8k']
2024-12-27:03:55:10,900 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-12-27:03:55:10,900 WARNING  [evaluator.py:175] generation_kwargs specified through cli, these settings will update set parameters in yaml tasks. Ensure 'do_sample=True' for non-greedy decoding!
2024-12-27:03:55:10,901 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-7B-Instruct', 'dtype': 'bfloat16', 'device': 'cuda', 'parallelize': False}
2024-12-27:03:55:11,578 INFO     [huggingface.py:129] Using device 'cuda'
2024-12-27:03:55:11,797 INFO     [huggingface.py:481] Using model type 'default'
2024-12-27:03:55:12,200 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.24s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.04s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s]
2024-12-27:03:55:21,275 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-12-27:03:55:21,278 INFO     [task.py:415] Building contexts for gsm8k on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 33%|███▎      | 33/100 [00:00<00:00, 327.01it/s] 68%|██████▊   | 68/100 [00:00<00:00, 336.62it/s]100%|██████████| 100/100 [00:00<00:00, 335.98it/s]
2024-12-27:03:55:21,581 INFO     [evaluator.py:489] Running generate_until requests
Running generate_until requests:   0%|          | 0/100 [00:00<?, ?it/s]/home/alireza/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:612: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
Running generate_until requests:   1%|          | 1/100 [00:08<14:44,  8.93s/it]Running generate_until requests:   2%|▏         | 2/100 [00:18<15:35,  9.54s/it]Running generate_until requests:   3%|▎         | 3/100 [00:35<20:17, 12.55s/it]Running generate_until requests:   4%|▍         | 4/100 [00:45<18:31, 11.58s/it]Running generate_until requests:   5%|▌         | 5/100 [00:55<17:37, 11.13s/it]Running generate_until requests:   6%|▌         | 6/100 [01:03<15:50, 10.11s/it]Running generate_until requests:   7%|▋         | 7/100 [01:14<16:02, 10.35s/it]Running generate_until requests:   8%|▊         | 8/100 [01:26<16:56, 11.05s/it]Running generate_until requests:   9%|▉         | 9/100 [01:35<15:38, 10.31s/it]Running generate_until requests:  10%|█         | 10/100 [01:40<13:07,  8.75s/it]Running generate_until requests:  11%|█         | 11/100 [01:50<13:32,  9.13s/it]Running generate_until requests:  12%|█▏        | 12/100 [01:56<11:43,  7.99s/it]Running generate_until requests:  13%|█▎        | 13/100 [02:07<13:07,  9.05s/it]Running generate_until requests:  14%|█▍        | 14/100 [02:14<11:47,  8.23s/it]Running generate_until requests:  15%|█▌        | 15/100 [02:30<15:03, 10.63s/it]Running generate_until requests:  16%|█▌        | 16/100 [02:42<15:33, 11.12s/it]Running generate_until requests:  17%|█▋        | 17/100 [02:47<12:52,  9.31s/it]Running generate_until requests:  18%|█▊        | 18/100 [02:56<12:20,  9.03s/it]Running generate_until requests:  19%|█▉        | 19/100 [03:08<13:40, 10.13s/it]Running generate_until requests:  20%|██        | 20/100 [03:24<15:48, 11.85s/it]Running generate_until requests:  21%|██        | 21/100 [03:36<15:45, 11.97s/it]Running generate_until requests:  22%|██▏       | 22/100 [03:48<15:27, 11.88s/it]Running generate_until requests:  23%|██▎       | 23/100 [03:57<14:09, 11.04s/it]Running generate_until requests:  24%|██▍       | 24/100 [04:13<15:42, 12.40s/it]Running generate_until requests:  25%|██▌       | 25/100 [04:23<14:46, 11.82s/it]Running generate_until requests:  26%|██▌       | 26/100 [04:28<11:56,  9.68s/it]Running generate_until requests:  27%|██▋       | 27/100 [04:36<11:05,  9.11s/it]Running generate_until requests:  28%|██▊       | 28/100 [04:47<11:37,  9.69s/it]Running generate_until requests:  29%|██▉       | 29/100 [05:01<13:05, 11.06s/it]Running generate_until requests:  30%|███       | 30/100 [05:08<11:39,  9.99s/it]Running generate_until requests:  31%|███       | 31/100 [05:15<10:29,  9.12s/it]Running generate_until requests:  32%|███▏      | 32/100 [05:31<12:28, 11.01s/it]Running generate_until requests:  33%|███▎      | 33/100 [05:36<10:17,  9.22s/it]Running generate_until requests:  34%|███▍      | 34/100 [05:47<10:49,  9.84s/it]Running generate_until requests:  35%|███▌      | 35/100 [05:56<10:27,  9.65s/it]Running generate_until requests:  36%|███▌      | 36/100 [06:01<08:45,  8.21s/it]Running generate_until requests:  37%|███▋      | 37/100 [06:07<07:43,  7.35s/it]Running generate_until requests:  38%|███▊      | 38/100 [06:22<10:03,  9.74s/it]Running generate_until requests:  39%|███▉      | 39/100 [06:29<08:59,  8.84s/it]Running generate_until requests:  40%|████      | 40/100 [06:33<07:35,  7.59s/it]Running generate_until requests:  41%|████      | 41/100 [06:39<06:47,  6.90s/it]Running generate_until requests:  42%|████▏     | 42/100 [06:45<06:37,  6.85s/it]Running generate_until requests:  43%|████▎     | 43/100 [06:53<06:43,  7.09s/it]Running generate_until requests:  44%|████▍     | 44/100 [06:58<06:03,  6.49s/it]Running generate_until requests:  45%|████▌     | 45/100 [07:09<07:15,  7.91s/it]Running generate_until requests:  46%|████▌     | 46/100 [07:16<06:54,  7.67s/it]Running generate_until requests:  47%|████▋     | 47/100 [07:24<06:46,  7.68s/it]Running generate_until requests:  48%|████▊     | 48/100 [07:29<06:02,  6.97s/it]Running generate_until requests:  49%|████▉     | 49/100 [07:43<07:40,  9.03s/it]Running generate_until requests:  50%|█████     | 50/100 [07:55<08:18,  9.98s/it]Running generate_until requests:  51%|█████     | 51/100 [08:01<07:08,  8.74s/it]Running generate_until requests:  52%|█████▏    | 52/100 [08:16<08:28, 10.59s/it]Running generate_until requests:  53%|█████▎    | 53/100 [08:31<09:17, 11.86s/it]Running generate_until requests:  54%|█████▍    | 54/100 [08:37<07:45, 10.13s/it]Running generate_until requests:  55%|█████▌    | 55/100 [08:45<07:10,  9.57s/it]Running generate_until requests:  56%|█████▌    | 56/100 [08:52<06:19,  8.62s/it]Running generate_until requests:  57%|█████▋    | 57/100 [09:01<06:16,  8.75s/it]Running generate_until requests:  58%|█████▊    | 58/100 [09:11<06:23,  9.13s/it]Running generate_until requests:  59%|█████▉    | 59/100 [09:18<05:54,  8.64s/it]Running generate_until requests:  60%|██████    | 60/100 [09:25<05:16,  7.90s/it]Running generate_until requests:  61%|██████    | 61/100 [09:32<05:02,  7.75s/it]Running generate_until requests:  62%|██████▏   | 62/100 [09:39<04:40,  7.39s/it]Running generate_until requests:  63%|██████▎   | 63/100 [09:45<04:25,  7.16s/it]Running generate_until requests:  64%|██████▍   | 64/100 [09:53<04:22,  7.30s/it]Running generate_until requests:  65%|██████▌   | 65/100 [10:00<04:11,  7.19s/it]Running generate_until requests:  66%|██████▌   | 66/100 [10:09<04:28,  7.88s/it]Running generate_until requests:  67%|██████▋   | 67/100 [10:13<03:43,  6.76s/it]Running generate_until requests:  68%|██████▊   | 68/100 [10:24<04:13,  7.92s/it]Running generate_until requests:  69%|██████▉   | 69/100 [10:30<03:48,  7.37s/it]Running generate_until requests:  70%|███████   | 70/100 [10:40<04:04,  8.16s/it]Running generate_until requests:  71%|███████   | 71/100 [10:51<04:21,  9.02s/it]Running generate_until requests:  72%|███████▏  | 72/100 [11:02<04:26,  9.53s/it]Running generate_until requests:  73%|███████▎  | 73/100 [11:09<03:59,  8.88s/it]Running generate_until requests:  74%|███████▍  | 74/100 [11:24<04:33, 10.51s/it]Running generate_until requests:  75%|███████▌  | 75/100 [11:29<03:48,  9.15s/it]Running generate_until requests:  76%|███████▌  | 76/100 [11:39<03:42,  9.27s/it]Running generate_until requests:  77%|███████▋  | 77/100 [11:46<03:17,  8.58s/it]Running generate_until requests:  78%|███████▊  | 78/100 [11:56<03:20,  9.09s/it]Running generate_until requests:  79%|███████▉  | 79/100 [12:06<03:13,  9.20s/it]Running generate_until requests:  80%|████████  | 80/100 [12:15<03:01,  9.08s/it]Running generate_until requests:  81%|████████  | 81/100 [12:20<02:34,  8.14s/it]Running generate_until requests:  82%|████████▏ | 82/100 [12:26<02:11,  7.33s/it]Running generate_until requests:  83%|████████▎ | 83/100 [12:35<02:15,  7.97s/it]Running generate_until requests:  84%|████████▍ | 84/100 [12:42<01:58,  7.43s/it]Running generate_until requests:  85%|████████▌ | 85/100 [12:55<02:18,  9.24s/it]Running generate_until requests:  86%|████████▌ | 86/100 [13:01<01:55,  8.23s/it]Running generate_until requests:  87%|████████▋ | 87/100 [13:08<01:43,  8.00s/it]Running generate_until requests:  88%|████████▊ | 88/100 [13:19<01:45,  8.81s/it]Running generate_until requests:  89%|████████▉ | 89/100 [13:28<01:36,  8.81s/it]Running generate_until requests:  90%|█████████ | 90/100 [13:33<01:15,  7.57s/it]Running generate_until requests:  91%|█████████ | 91/100 [13:39<01:04,  7.19s/it]Running generate_until requests:  92%|█████████▏| 92/100 [13:46<00:57,  7.21s/it]Running generate_until requests:  93%|█████████▎| 93/100 [13:52<00:47,  6.80s/it]Running generate_until requests:  94%|█████████▍| 94/100 [14:05<00:51,  8.57s/it]Running generate_until requests:  95%|█████████▌| 95/100 [14:11<00:39,  7.83s/it]Running generate_until requests:  96%|█████████▌| 96/100 [14:18<00:30,  7.51s/it]Running generate_until requests:  97%|█████████▋| 97/100 [14:24<00:21,  7.32s/it]Running generate_until requests:  98%|█████████▊| 98/100 [14:31<00:14,  7.04s/it]Running generate_until requests:  99%|█████████▉| 99/100 [14:37<00:06,  6.70s/it]Running generate_until requests: 100%|██████████| 100/100 [14:43<00:00,  6.71s/it]Running generate_until requests: 100%|██████████| 100/100 [14:43<00:00,  8.84s/it]
fatal: not a git repository (or any parent up to mount point /global)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2024-12-27:04:10:12,105 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-12-27:04:10:12,111 INFO     [evaluation_tracker.py:287] Saving per-sample results for: gsm8k
